<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: A two-dimensional Biharmonic problem with the Bell triangular finite element</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">A two-dimensional Biharmonic problem with the Bell triangular finite element </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this document, we demonstrate how to solve a two-dimensional Biharmonic equation using triangular finite elements within <code>oomph-lib</code>.</p>
<p>First, let consider the Biharmonic equation which is mathematically expressed as follow</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial^4 u}{\partial x_1^4} + 2\frac{\partial^4 u}{\partial x_1^2\partial x_2^2} + \frac{\partial^4 u}{\partial x_2^4} = f(x_1,x_2), \ \ \ \mathbf{x} = (x_1,x_2) \in \Re^2. \ \ \ \ (1) \]" src="form_0.png"/>
</p>
<p>In this study, we consider the homogeneous Biharmonic equation with the exact solution </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ u(x_1,x_2) = \cos(x_1)e^{x_2}. \]" src="form_1.png"/>
</p>
<p>The problem will be implemented in the rectangular domain <img class="formulaInl" alt="$ \Omega = \{(x_1,x_2) | 0 \leq x_1 \leq 2, 0\leq x_2 \leq 1 \} $" src="form_2.png"/>, and we apply Dirichlet boundary conditions such that the exact solution is satisfied.</p>
<p>In order to formulate the finite element implementation of the Biharmonic equation, the weak formulation must be derived. The reader is referred to <a href="../../../intro/html/index.html">another document</a> for detailed descriptions of weak formulations.</p>
<p>After introducing the weight or test function <img class="formulaInl" alt="$ \phi(x_i) $" src="form_3.png"/> and changing the differential equation (1) into the integral form, we have </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ 0 = r = \int_{\Omega}{\left( \frac{\partial^4 u}{\partial x_1^4} + 2\frac{\partial^4 u}{\partial x_1^2\partial x_2^2} + \frac{\partial^4 u}{\partial x_2^4} - f(x_i)\right) \phi(x_i) d\Omega.} \ \ \ (2) \]" src="form_4.png"/>
</p>
<p>Integrating by parts twice and using of the divergence theorem give</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ 0 = r = \int_{\Omega}{\left( \frac{\partial^2 u}{\partial x_1^2}\frac{\partial^2 \phi}{\partial x_1^2} + 2\frac{\partial^2 u}{\partial x_1^2}\frac{\partial^2 \phi}{\partial x_2^2} + \frac{\partial^2 u}{\partial x_2^2}\frac{\partial^2 \phi}{\partial x_2^2} - f(x_i)\phi(x_i)\right) d \Omega} \]" src="form_5.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ + \int_{\partial \Omega} \nabla^3_n u \phi(x_i) d\partial \Omega - \int_{\partial \Omega} \nabla^2 u \frac{\partial \phi}{\partial n}(x_i) d\partial \Omega, \ \ \ \ \ (3) \]" src="form_6.png"/>
</p>
<p>where <img class="formulaInl" alt="$ \partial \Omega $" src="form_7.png"/> denotes the domain boundary and <img class="formulaInl" alt="$ \partial/\partial n $" src="form_8.png"/> the outward normal derivative. Since the test functions satisfy homogeneous boundary conditions, <img class="formulaInl" alt="$ \left. \phi \right|_{\partial \Omega} = 0 = \left. \frac{\partial \phi}{\partial n}\right|_{\partial \Omega}, $" src="form_9.png"/> the integrals for the last two terms of equation (3) vanish.</p>
<p>Therefore, an alternative version of the weak form of (1) is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ 0 = r = \int_{\Omega}{\left( \frac{\partial^2 u}{\partial x_1^2}\frac{\partial^2 \phi}{\partial x_1^2} + 2\frac{\partial^2 u}{\partial x_1^2}\frac{\partial^2 \phi}{\partial x_2^2} + \frac{\partial^2 u}{\partial x_2^2}\frac{\partial^2 \phi}{\partial x_2^2} - f(x_i)\phi(x_i)\right) d \Omega.} \ \ \ \ \ (4) \]" src="form_10.png"/>
</p>
<p>It is noteworthy that the Galerkin method is employed in this study so that the choice of function spaces for the solution, <img class="formulaInl" alt="$u(x_i)$" src="form_11.png"/>, and the test function, <img class="formulaInl" alt="$\phi(x_i)$" src="form_12.png"/>, is the same. Therefore, both the solution and the test function can be approximated by the same set of shape function, <img class="formulaInl" alt="$\psi_l$" src="form_13.png"/> as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ u(x_i) = \sum_{l=1}^{N} U_{l}\psi_l(x_i), \ \ \ \ (5) \]" src="form_14.png"/>
</p>
<p> and, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \phi(x_i) = \sum_{k=1}^{N} \Phi_{k}\psi_k(x_i), \ \ \ \ (6) \]" src="form_15.png"/>
</p>
<p> where <img class="formulaInl" alt="$ N $" src="form_16.png"/> is the dimension of discrete approximating to function space.</p>
<p>Substituting the derivatives of (6) into (4), we have</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ 0 = r = \int_{\Omega}{\left( \frac{\partial^2 u}{\partial x_1^2}\sum_{k=1}^{N} \Phi_{k}\frac{\partial^2 \psi_{k}}{\partial x_1^2} + 2\frac{\partial^2 u}{\partial x_1^2}\sum_{k=1}^{N} \Phi_{k}\frac{\partial^2 \psi_{k}}{\partial x_2^2} + \frac{\partial^2 u}{\partial x_2^2}\sum_{k=1}^{N} \Phi_{k}\frac{\partial^2 \psi_{k}}{\partial x_2^2} - f(x_i)\sum_{k=1}^{N} \Phi_{k}\psi_{k}(x_i)\right) d \Omega,} \]" src="form_17.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ 0 = r = \sum_{k=1}^{N}{\Phi_{k} r_{k}(U_1,U_2,...,U_N)}, \ \ \ \ (7) \]" src="form_18.png"/>
</p>
<p>where</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ r_{k}(U_1,U_2,...,U_N) = \int_{\Omega}{\left( \frac{\partial^2 u}{\partial x_1^2}\frac{\partial^2 \psi_{k}}{\partial x_1^2} + 2\frac{\partial^2 u}{\partial x_1^2}\frac{\partial^2 \psi_{k}}{\partial x_2^2} + \frac{\partial^2 u}{\partial x_2^2}\frac{\partial^2 \psi_{k}}{\partial x_2^2} - f(x_i)\psi_{k}(x_i)\right) d \Omega.} \ \ \ \ (8) \]" src="form_19.png"/>
</p>
<p>We have that (7) must hold for any value of the coefficients <img class="formulaInl" alt="$ \Phi_k $" src="form_20.png"/>, so the coefficients <img class="formulaInl" alt="$ U_j $" src="form_21.png"/> must satisfy the equations</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ r_k(U_1, U_2,...,U_N) = 0, \mbox{ \ \ \ \ for } k=1,2,...,N. \]" src="form_22.png"/>
</p>
<p> <br  />
</p>
<p>After substituting the derivatives of (5) into (8), the weak form of (1) can be expressed as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ 0 = r_{k} = \int_{\Omega}\left( \sum_{l=1}^{N}{U_l\frac{\partial^2 \psi_l}{\partial x_1^2}}\frac{\partial^2\psi_k}{\partial x_1^2} + 2\sum_{l=1}^{N}{U_l\frac{\partial^2 \psi_l}{\partial x^2_1}}\frac{\partial^2\psi_k}{\partial x^2_2} + \sum_{k=1}^{N}{U_l\frac{\partial^2 \psi_l}{\partial x_2^2}}\frac{\partial^2\psi_k}{\partial x_2^2} - f(x_i)\psi_k \right) dx_1dx_2. \ \ (9) \]" src="form_23.png"/>
</p>
<p>Since we solve the Biharmonic equation with the Dirichlet boundary conditions in this study, the boundary terms in (9) vanish. This is a consequence of every test functions have to satisfy the homogeneous conditions at boundaries. Now, it can be seen that the weak formulation of the equation contains the second-order derivatives of the approximation, <img class="formulaInl" alt="$ \psi(x_i) $" src="form_24.png"/> of the solution. Hence, in order to make the integral exists, the approximation and its first-order derivative are required to be continuous. Therefore, the <img class="formulaInl" alt="$ C^1 $" src="form_25.png"/>-interpolations are required.</p>
<p>Hence, the <code>BellElement</code> is introduced in this document to provide the continuously differentiable shape functions to interpolate the solution of a Biharmonic equation. This kind of element arises in order to satisfy <img class="formulaInl" alt="$ C^1 $" src="form_25.png"/> continuity of the solutions of a fourth-order problem.</p>
<p>Specifically, we shall provide</p>
<ul>
<li>a general descriptions of the Bell triangular finite element</li>
</ul>
<ul>
<li>numerical results of solving the Biharmonic equation with the <code>BellElement</code> </li>
</ul>
<p>and</p><ul>
<li>how to implement the <code>BellElement</code> in <code>oomph-lib</code> using the Biharmonic equation as a case study.</li>
</ul>
<hr  />
<p> <br  />
 </p><hr  />
<h1><a class="anchor" id="overview"></a>
Overview of the BellElement</h1>
<p>The constructed <code>BellElement</code> provides a discretisation of the variational principle (9) with two-dimensional, three-node triangular finite elements. In this element, the subparametric idea is employed. This means that the degree of geometric shape functions (shape function approximated a geometry) is defined to be lower than the degree of polynomials for parametric shape functions (shape function approximated a variable). In this study, a geometry is approximated by the linear Lagrange polynomials while the Bell shape functions are employed to interpolate variables.</p>
<p>The two-dimensional linear Lagrange shape functions defined over a triangle are parametrised by the local coordinates <img class="formulaInl" alt="$ s_1,s_2 \in [0,1]$" src="form_26.png"/> and are defined as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \psi_{1}(s_1,s_2) = s_1, \ \ \ \psi_{2}(s_1,s_2) = s_2, \ \ \ \psi_{3}(s_1,s_2) = 1-s_1-s_2. \ \ \ \ \ (10)\]" src="form_27.png"/>
</p>
<p>Therefore, a position <img class="formulaInl" alt="$ {\bf x} = (x_1,x_2) \in \Re^2 $" src="form_28.png"/> is approximated by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_i(s_1,s_2) = \sum_{j=1}^{3} X_{ij} \ \psi_{j}(s_1,s_2) \mbox{\ \ \ for $i=1,2$}, \ \ \ \ \ \ \ \ (11) \]" src="form_29.png"/>
</p>
<p> where <img class="formulaInl" alt="$ X_{ij} $" src="form_30.png"/> are the nodal positions in the direction <img class="formulaInl" alt="$ i^{th} $" src="form_31.png"/> at node <img class="formulaInl" alt="$ j $" src="form_32.png"/>.</p>
<p>Similar to a geometric approximation, a variable can be approximated as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_i(x_1,x_2) = \sum_{l=1}^{3} \sum_{k=1}^{6}U_{ilk} \ \varphi_{lk}(\lambda_1,\lambda_2,\lambda_3), \]" src="form_33.png"/>
</p>
<p> where <img class="formulaInl" alt="$ x_1,x_2 \in \Omega $" src="form_34.png"/> are the element's 2D global coordinates. The function <img class="formulaInl" alt="$ \varphi_{lk}$" src="form_35.png"/> are the two-dimensional Bell shape functions parametrised by area coordinates <img class="formulaInl" alt="$ \lambda_1, \lambda_2, \lambda_3$" src="form_36.png"/> which we will describe in the next two subsections.</p>
<hr  />
<h2><a class="anchor" id="area_coor"></a>
Area coordinates</h2>
<p>The area coordinate system or Barycentric coordinates are defined on a triangle which is expressed in terms of its three vertices. We consider a triangle defined by three vertices <img class="formulaInl" alt="$ {\bf x}_{1}, {\bf x}_{2}, {\bf x}_{3}$" src="form_37.png"/> as</p>
<div class="image">
<img src="triangle.gif" alt=""/>
<div class="caption">
The geometry of a triangle which has three nodes. </div></div>
 <p>The barycentric coordinates of point <img class="formulaInl" alt="$ {\bf p} = (x,y)$" src="form_38.png"/> in the triangle are simply defined to be ratios of triangular areas as, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \lambda_1 = \frac{A_1}{A}, \ \ \ \lambda_2 = \frac{A_2}{A}, \ \ \ \lambda_3 = \frac{A_3}{A}. \ \ \ \ (12) \]" src="form_39.png"/>
</p>
<p>Area <img class="formulaInl" alt="$ A $" src="form_40.png"/> is the total area of the triangle and can be computed as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \frac{1}{2}\left(\left(x_2y_3-x_3y_2\right) + \left(x_3y_1-x_1y_3\right) + \left(x_1y_2-x_2y_1\right)\right).\]" src="form_41.png"/>
</p>
<p>Also, <img class="formulaInl" alt="$ A_j, j=1,2,3 $" src="form_42.png"/> are the sub-area of the triangle described in the figure. They can be computed as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_1 = \frac{1}{2}\left(\left(x_2y_3-x_3y_2\right) + \left(x_3y-xy_3\right) + \left(xy_2-x_2y\right)\right),\]" src="form_43.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_2 = \frac{1}{2}\left(\left(xy_3-x_3y\right) + \left(x_3y_1-x_1y_3\right) + \left(x_1y-xy_1\right)\right),\]" src="form_44.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_3 = \frac{1}{2}\left(\left(x_2y-xy_2\right) + \left(xy_1-x_1y\right) + \left(x_1y_2-x_2y_1\right)\right),\]" src="form_45.png"/>
</p>
<p>where <img class="formulaInl" alt="$ x_i,y_i $" src="form_46.png"/> denotes the <img class="formulaInl" alt="$ x- $" src="form_47.png"/> and <img class="formulaInl" alt="$ y- $" src="form_48.png"/> coordinates of the point <img class="formulaInl" alt="$ \mathbf{x}_i;i =1,2,3. $" src="form_49.png"/> These ratios of areas form dimensionless coordinates in the plane defined by points <img class="formulaInl" alt="$ {\bf x}_{1}, {\bf x}_{2}, {\bf x}_{3}. $" src="form_50.png"/></p>
<p>A barycentric combination of three points takes the form: <img class="formulaInl" alt="$ {\bf p} = \lambda_1{\bf x}_{1} + \lambda_2{\bf x}_{2} + \lambda_3{\bf x}_{3}$" src="form_51.png"/> where <img class="formulaInl" alt="$ \lambda_1+\lambda_2+\lambda_3 = 1.$" src="form_52.png"/> The third area coordinate <img class="formulaInl" alt="$ \lambda_3 $" src="form_53.png"/> can be expressed as <img class="formulaInl" alt="$ \lambda_3 = 1-\lambda_1-\lambda_2. $" src="form_54.png"/></p>
<p>The three vertices have the barycentric coordinates as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf x}_{1} = \left(1,0,0\right), \ \ \ {\bf x}_{2} = \left(0,1,0\right), \ \ \ {\bf x}_{3} = \left(0,0,1\right). \]" src="form_55.png"/>
</p>
<hr  />
<h2><a class="anchor" id="bell_shape"></a>
The Bell shape functions</h2>
<p>The shape functions of the Bell element are defined over a triangle and derived from the quintic polynomials with 18 degrees of freedom. The element comprises three nodes with six degrees of freedom at each corner node including the value, and all first and second derivatives; <img class="formulaInl" alt="$ u, u_{x}, u_{y}, u_{xx}, u_{yy}, u_{xy}. $" src="form_56.png"/> The graphical description of the Bell element is illustrated below.</p>
<div class="image">
<img src="bell_element.gif" alt=""/>
<div class="caption">
(Left)The Bell element with 18 degrees of freedom; 6 dofs at vertices. (Right) The description of all parameters utilised within the derivation of the Bell shape functions. </div></div>
 <p>The shape functions of the Bell element are parametrised by area coordinates, <img class="formulaInl" alt="$\lambda_j$" src="form_57.png"/>. The subscripts <img class="formulaInl" alt="$ik$" src="form_58.png"/> of the shape functions <img class="formulaInl" alt="$\psi_{ik}$" src="form_59.png"/> mean that they are evaluated at node <img class="formulaInl" alt="$i$" src="form_60.png"/> with <img class="formulaInl" alt="$k^{th}$" src="form_61.png"/> degree of freedom where <img class="formulaInl" alt="$k=1$" src="form_62.png"/> denotes degree of freedom that corresponds to the unknown value, <img class="formulaInl" alt="$k=2,3$" src="form_63.png"/> correspond to the first derivatives with respect to the first and second global coordinates, <img class="formulaInl" alt="$k=4,5$" src="form_64.png"/> correspond to the second derivatives with respect to the first and second global coordinates, and <img class="formulaInl" alt="$k=6$" src="form_65.png"/> corresponds to the mixed derivative.</p>
<p>Unlike the Lagrangian interpolation functions, the Bell shape functions are derived by interpolating nodal derivatives as well as nodal displacements. Also, they have to satisfy the properties that <img class="formulaInl" alt="$\psi_{i1} = 1$" src="form_66.png"/> at node <img class="formulaInl" alt="$i$" src="form_60.png"/> and <img class="formulaInl" alt="$\psi_{i1} = 0$" src="form_67.png"/> at other nodes. Furthermore, all of the first and the second derivatives of <img class="formulaInl" alt="$\psi_{i1} = 0$" src="form_67.png"/> at all nodes. Also, <img class="formulaInl" alt="$\partial_{x}\psi_{i2} = 1$" src="form_68.png"/> at node <img class="formulaInl" alt="$i$" src="form_60.png"/> and <img class="formulaInl" alt="$\partial_{x}\psi_{i2} = 0$" src="form_69.png"/> at other nodes. Similarly for the first derivative with respect to <img class="formulaInl" alt="$y$" src="form_70.png"/>, we have that <img class="formulaInl" alt="$\partial_{y}\psi_{i3} = 1$" src="form_71.png"/> at node <img class="formulaInl" alt="$i$" src="form_60.png"/> and <img class="formulaInl" alt="$\partial_{y}\psi_{i3} = 0$" src="form_72.png"/> at other nodes. These shape functions associated with the first derivatives are zero at all nodes for <img class="formulaInl" alt="$\psi_{im}$" src="form_73.png"/>, <img class="formulaInl" alt="$\partial_{xx}\psi_{im}$" src="form_74.png"/>, <img class="formulaInl" alt="$\partial_{yy}\psi_{im}$" src="form_75.png"/>, <img class="formulaInl" alt="$\partial_{xy}\psi_{im}, \forall m=2,3$" src="form_76.png"/>. Moreover, <img class="formulaInl" alt="$\partial_{xx}\psi_{i4}(\mathbf{x}_{k}) = \delta_{ik}$" src="form_77.png"/>, <img class="formulaInl" alt="$\partial_{yy}\psi_{i5}(\mathbf{x}_{k}) = \delta_{ik}$" src="form_78.png"/>, and <img class="formulaInl" alt="$\partial_{xy}\psi_{i6}(\mathbf{x}_{k}) = \delta_{ik}$" src="form_79.png"/>. Furthermore, these shape functions associated with the second derivatives are zero at all nodes for <img class="formulaInl" alt="$\psi_{im}$" src="form_73.png"/>, <img class="formulaInl" alt="$\partial_{x}\psi_{im}$" src="form_80.png"/>, and <img class="formulaInl" alt="$\partial_{y}\psi_{im}, \forall m=4,5,6$" src="form_81.png"/>.</p>
<p>The Bell shape functions are mathematically expressed as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \psi_{11}(\lambda_1,\lambda_2,\lambda_3) = \lambda_1^5 + 5\lambda_1^4\left( \lambda_2+\lambda_3\right) + 10\lambda_1^3\left( \lambda_2+\lambda_3\right)^2 + 30\lambda_1^2\lambda_2\lambda_3\left( l_3\lambda_2 + l^{\prime}_2\lambda_3\right), \]" src="form_82.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \psi_{12}(\lambda_1,\lambda_2,\lambda_3) = 3b_1\lambda_1^2\lambda_2\lambda_3\left( \lambda_2-\lambda_3\right) + \lambda_1^3\left(b_3\lambda_2 -b_2\lambda_3 \right)\left( \lambda_1+4\lambda_2+4\lambda_3\right) \]" src="form_83.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ + 15\lambda_1^2\lambda_2\lambda_3\left( b_3l_3\lambda_2-b_2l^{\prime}_2\lambda_3\right), \]" src="form_84.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \psi_{13}(\lambda_1,\lambda_2,\lambda_3) = -3c_1\lambda_1^2\lambda_2\lambda_3\left( \lambda_2-\lambda_3\right) - \lambda_1^3\left(c_3\lambda_2 -c_2\lambda_3 \right)\left( \lambda_1+4\lambda_2+4\lambda_3\right) \]" src="form_85.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ - 15\lambda_1^2\lambda_2\lambda_3\left( c_3l_3\lambda_2-c_2l^{\prime}_2\lambda_3\right), \]" src="form_86.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \psi_{14}(\lambda_1,\lambda_2,\lambda_3) = 1/2\lambda_1^3\left( b_3^2\lambda_2^2+b_2^2\lambda_3^2\right) + \lambda_1^2\lambda_2\lambda_3\left(-b_2b_3\lambda_1 + b_3b_1\lambda_2 + b_1b_2\lambda_3 \right) \]" src="form_87.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ + 5/2\lambda_1^2\lambda_2\lambda_3\left( b_3^2l_3\lambda_2+b_2^2l^{\prime}_2\lambda_3\right), \]" src="form_88.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \psi_{15}(\lambda_1,\lambda_2,\lambda_3) = 1/2\lambda_1^3\left( c_3^2\lambda_2^2+c_2^2\lambda_3^2\right) + \lambda_1^2\lambda_2\lambda_3\left(-c_2c_3\lambda_1 + c_3c_1\lambda_2 + c_1c_2\lambda_3 \right) \]" src="form_89.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ + 5/2\lambda_1^2\lambda_2\lambda_3\left( c_3^2l_3\lambda_2+c_2^2l^{\prime}_2\lambda_3\right), \]" src="form_90.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \psi_{16}(\lambda_1,\lambda_2,\lambda_3) = b_1c_1\lambda_1^2\lambda_2\lambda_3\left( \lambda_1+\lambda_2+\lambda_3\right) + b_2c_2\lambda_1^2\lambda_3\left( \lambda_2\lambda_3 - \lambda_3\lambda_1 - \lambda_1\lambda_2 - \lambda_2^2\right) \]" src="form_91.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ + b_3c_3\lambda_1^2\lambda_2\left( \lambda_2\lambda_3 - \lambda_3\lambda_1 - \lambda_1\lambda_2 - \lambda_3^2\right) - 5\lambda_1^2\lambda_2\lambda_3\left( b_2c_2l^{\prime}_2\lambda_3 + b_3c_3l_3\lambda_2\right). \ \ \ \ (13)\]" src="form_92.png"/>
</p>
<p>These are shape functions associated with the first node with its 6 degrees of freedom. The shape functions at another two nodes can be obtained by performing a cyclic permutation of the Barycentric coordinates in (13). The parameters <img class="formulaInl" alt="$ b_i, c_i \forall i = 1,2,3, $" src="form_93.png"/> appearing in the equations can be obtained from</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ b_1 = x_3 - x_2, \ \ \ b_2 = x_1-x_3, \ \ \ b_3 = x_2 - x_1, \]" src="form_94.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ c_1 = y_2 - y_3, \ \ \ c_2 = y_3-y_1, \ \ \ c_3 = y_1 - y_2, \]" src="form_95.png"/>
</p>
<p> where <img class="formulaInl" alt="$x_i,y_i; i=1,2,3,$" src="form_96.png"/> are components of a vertex <img class="formulaInl" alt="$\mathbf{x}_i. $" src="form_97.png"/></p>
<p>Note that all the first and second derivatives can be obtained by the help of the chain rule as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial \psi_{ij}}{\partial x_{\alpha}} = \frac{\partial \psi_{ij}}{\partial \lambda_{k}}\frac{\partial \lambda_{k}}{\partial x_{\alpha}}, \]" src="form_98.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial^2 \psi_{ij}}{\partial x_{\alpha}\partial x_{\beta}} = \frac{\partial^2 \psi_{ij}}{\partial \lambda_{m}\partial \lambda_{n}}\frac{\partial \lambda_{m}}{\partial x_{\alpha}}\frac{\partial \lambda_{n}}{\partial x_{\beta}} + \frac{\partial^2 \lambda_{k}}{\partial x_{\alpha}\partial x_{\beta}}\frac{\partial \psi_{ij}}{\partial \lambda_{k}}, \]" src="form_99.png"/>
</p>
<p>and the derivatives of area coordinates with respect to global coordinates can be obtained from considering (12) with the substitutions of <img class="formulaInl" alt="$ b_i, c_i; i=1,2,3. $" src="form_100.png"/> They are expressed as follows:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial \lambda_{1}}{\partial x} = \frac{c_1}{2A}, \ \ \ \frac{\partial \lambda_{2}}{\partial x} = \frac{c_2}{2A}, \ \ \ \frac{\partial \lambda_{3}}{\partial x} = \frac{c_3}{2A}, \]" src="form_101.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial \lambda_{1}}{\partial y} = \frac{b_1}{2A}, \ \ \ \frac{\partial \lambda_{2}}{\partial y} = \frac{b_2}{2A}, \ \ \ \frac{\partial \lambda_{3}}{\partial y} = \frac{b_3}{2A}. \]" src="form_102.png"/>
</p>
<p>Here are graphical Bell shape functions at the first node, <img class="formulaInl" alt="$ \psi_{1j}, j=1,...,6,$" src="form_103.png"/> evaluated at <img class="formulaInl" alt="$ {\bf x}_1 $" src="form_104.png"/>. The figures show that the Bell shape function at the first node have to satisfy the properties that <img class="formulaInl" alt="$\psi_{11} = 1$" src="form_105.png"/> at node <img class="formulaInl" alt="$1$" src="form_106.png"/> and <img class="formulaInl" alt="$\psi_{11} = 0$" src="form_107.png"/> at other nodes. Furthermore, all of the Bell shape functions corresponded to all first and second derivatives <img class="formulaInl" alt="$ \psi_{1j} = 0, j=2,...,6 $" src="form_108.png"/> at all nodes.</p>
<div class="image">
<img src="shapes.gif" alt=""/>
<div class="caption">
The Bell shape functions that correspond to the 6 degrees of freedom defined previously at the first node. Here the shape functions are evaluated at x1 which show the appreciation of the crucial properties in the Bell shape functions. </div></div>
 <p>Note that the Bell shape functions and also the first and second derivatives are differentiated with respect to global coordinates. Therefore, the Jacobian of mapping between global to local coordinates is no longer needed to derive the derivatives of the shape functions for this type of element.</p>
<hr  />
<h2><a class="anchor" id="interface"></a>
The interface of accessible functions to the shape functions in the BellElement</h2>
<p>Since the <code>BellElement</code> is constructed with the subparametric idea, there are two sets of approximating functions defined in the element. The linear Lagrange polynomials defined in (10) will be inherited from <code>TElementShape&lt;2,2&gt;</code> in order to approximate the geometry. These functions can be accessible by</p>
<center> <table class="doxtable">
<tr>
<td><center> <code>BellElement&lt;&gt;::shape(s,psi)</code>. </center>   </td></tr>
</table>
</center><p>In order to approximate variables in the <code>BellElement</code>, the Bell shape functions defined in (13) will be overloaded from <code>BellElementShape::Bshape(...)</code>. This function will compute the basis functions at local coordinate <img class="formulaInl" alt="$ s $" src="form_109.png"/> and it provides <img class="formulaInl" alt="$ C^1 $" src="form_25.png"/>-continuity.</p>
<p>As the global coordinates are required in the derivation of the shape functions of the <code>BellElementShape&lt;&gt;</code>, the physical coordinates of vertices have to be passed as an argument when shape functions are overloaded. The interface of the Bell shape functions obtained from <code>BellElementShape&lt;&gt;</code> at local coordinate <img class="formulaInl" alt="$ s $" src="form_109.png"/> is <code>BellElementShape&lt;&gt;::Bshape(s,psi,position)</code>. Similarly, the first and the second-order derivatives can be obtained at local coordinate <img class="formulaInl" alt="$ s $" src="form_109.png"/> as <code>BellElementShape&lt;&gt;::dBshape(s,psi,dpsi,position)</code> and <code>BellElementShape&lt;&gt;::d2Bshape(s,psi,dpsi,d2psi,position)</code>, respectively.</p>
<p>Note that the vector <code>position</code> is the collection of coordinates on vertices of Bell triangles. The order of nodal positions defined in the vector <code>position</code> is correspond with the order of those on physical elements. Also, the vertex nodes 0,1, and 2 situate anticlockwise.</p>
<p>Now, to obtained the basis functions that employed to approximate variables in <code>BellElement</code>, they can be accessible via</p>
<center> <table class="doxtable">
<tr>
<td><center> <code>BellElement&lt;&gt;::basis(s,psi)</code>, </center>   </td></tr>
</table>
</center><p>and, the first and second-order derivatives of the Bell shape functions can be accessible via</p>
<center> <table class="doxtable">
<tr>
<td><center> <code>BellElement&lt;&gt;::dbasis(s,psi,dpsi)</code> <code>BellElement&lt;&gt;::d2basis(s,psi,dpsi,d2psi)</code>, </center>   </td></tr>
</table>
</center><p> respectively.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="reslt"></a>
Results</h1>
<p>Before the numerical results obtained from solving the 2D Biharmonic equation with the Bell finite element will be illustrated, the boundary conditions have to be specified. Since the Bell finite element is employed, the boundary specifications have to correspond with degrees of freedom defined for the <code>BellElement</code> in the previous section.</p>
<p>Since we consider the Biharmonic equation with the Dirichlet boundary conditions, we have that the physical conditions that allow to be pinned on boundaries are the value and the normal derivatives. However, there is no normal derivative defined as a degree of freedom to be specified for the Bell shape function. Therefore, the first-order derivatives have to be imposed instead and the boundary specification can be worked out from the normal derivative on that boundary.</p>
<p>Furthermore, the values of the unknown and the first-order derivatives that have to be specified on the boundaries of the domain for the Bell element can be obtained from</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ u(x_1,x_2) = \cos(x_1)e^{x_2} , \ \ \ u_{x_1}(x_1,x_2) = -\sin(x_1)e^{x_2}, \ \ \ u_{x_2}(x_1,x_2) = \cos(x_1)e^{x_2}. \ \ \ (14) \]" src="form_110.png"/>
</p>
<p>For the rest of degrees of freedom associated with the second-order derivatives, they are derived conditions that can be taken care by the natural boundary conditions. In this study, we set them to be pinned in order to reduce the number of degrees of freedom in the problem. The values of the second-order derivatives that have to be specified on the boundaries of the domain for the Bell element can be worked out from (14) and are expressed as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_{x_1x_1}(x_1,x_2) = -\cos(x_1)e^{x_2} , \ \ \ u_{x_1x_2}(x_1,x_2) = -\sin(x_1)e^{x_2}, \ \ \ u_{x_2x_2}(x_1,x_2) = \cos(x_1)e^{x_2}. \]" src="form_111.png"/>
</p>
<p>The following is a table illustrating the performance with the associated computational time of the Bell triangular elements. The accuracy of the solutions will base on the <img class="formulaInl" alt="$L^2$" src="form_112.png"/>-norm error which is mathematically described as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ |u_{exact}-u_{FE}| = \left( \int_{\Omega} | u_{exact} - u_{FE}|^2 d\Omega \right)^{1/2}, \]" src="form_113.png"/>
</p>
<p> where <img class="formulaInl" alt="$u_{exact},u_{FE}$" src="form_114.png"/> denote the exact and the finite element solutions, respectively.</p>
<p><b>Table 1:</b> <img class="formulaInl" alt="$L^2$" src="form_112.png"/>-norm error of the solution obtained from the Biharmonic implementation using the Bell element with various numbers of elements.</p>
<center> <table class="doxtable">
<tr>
<td>Element size (h)  </td><td>Number of elements  </td><td>Number of dofs  </td><td>Error  </td><td>Time (sec)   </td></tr>
<tr>
<td>0.5  </td><td>16  </td><td>18  </td><td><img class="formulaInl" alt="$ 3.45428 \times 10^{-5} $" src="form_115.png"/>  </td><td>0.18   </td></tr>
<tr>
<td>0.2  </td><td>100  </td><td>216  </td><td><img class="formulaInl" alt="$ 7.78578 \times 10^{-7} $" src="form_116.png"/>  </td><td>1.19   </td></tr>
<tr>
<td>0.1429  </td><td>196  </td><td>468  </td><td><img class="formulaInl" alt="$ 1.89314 \times 10^{-7} $" src="form_117.png"/>  </td><td>3.74   </td></tr>
<tr>
<td>0.1  </td><td>400  </td><td>1026  </td><td><img class="formulaInl" alt="$ 4.29805 \times 10^{-8} $" src="form_118.png"/>  </td><td>4.77   </td></tr>
<tr>
<td>0.005  </td><td>1600  </td><td>4446  </td><td><img class="formulaInl" alt="$ 2.52419 \times 10^{-9} $" src="form_119.png"/>  </td><td>19.67   </td></tr>
<tr>
<td>0.01  </td><td>40000  </td><td>118206  </td><td><img class="formulaInl" alt="$ 3.86145 \times 10^{-12} $" src="form_120.png"/>  </td><td>1197.06     </td></tr>
</table>
<br  />
 </center><p>The figures below illustrate, respectively, the finite element solution and absolute error obtained from solving the Biharmonic equation with the <code>BellElement</code> on structured meshes. This implementation employs 16 triangular elements in the mesh with the number of degrees of freedom equals to 18.</p>
<div class="image">
<img src="Biharmonic_Bell_Soln.gif" alt=""/>
<div class="caption">
The finite element solution of the Biharmonic equation obtained from the BellElement. </div></div>
 <div class="image">
<img src="Biharmonic_Bell_Err.gif" alt=""/>
<div class="caption">
Absolute error between the exact and the finite element solutions of the Biharmonic equation obtained from the BellElement. </div></div>
 <p>Next, plotting the logarithm of <img class="formulaInl" alt="$ L^2 $" src="form_121.png"/>-error with that of the element size shows that the obtained rate of convergence of the Bell element is quartic (see figure 1.4).</p>
<div class="image">
<img src="Bell_Err_log.gif" alt=""/>
<div class="caption">
A log-plot between error and the element size from solving the Biharmonic equation with the BellElement in a rectangular domain. </div></div>
 <hr  />
<p> <br  />
 </p><hr  />
<h1><a class="anchor" id="impl"></a>
Implementation in oomph-lib</h1>
<hr  />
<h2><a class="anchor" id="global"></a>
Global parameters and functions</h2>
<p>The namespace <code><a class="el" href="namespacePhysical__Variables.html" title="Namespace for the solution of 2D Biharmonic equation.">Physical_Variables</a></code> is where the source function and the exact solution are defined. The source function can be specified via <code><a class="el" href="namespacePhysical__Variables.html#ae11027d76c5f512b7db6a1b6d17dc792" title="Source function required to make the solution above an exact solution.">Physical_Variables::source_function()</a></code> while the exact solutions are defined via <code><a class="el" href="namespacePhysical__Variables.html#af90d0c580c57b1152fd1cc7046055031" title="Exact solution as a Vector.">Physical_Variables::get_exact_u()</a></code>. Note that the six exact solutions correspond to the six degrees of freedom defined on each node.</p>
 <div class="fragment"><div class="line"><span class="comment">//==start_of_namespace================================================</span></div>
<div class="line"><span class="comment">/// Namespace for the solution of 2D Biharmonic equation</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespacePhysical__Variables.html">Physical_Variables</a></div>
<div class="line">{</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// number of elements in the x direction</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespacePhysical__Variables.html#ae766d6695cfb9a8d87be9767b38245ff">n_x</a> = 4;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// number of elements in the y direction</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespacePhysical__Variables.html#a35801b250816fa72ce9023f8738515fa">n_y</a> = 2;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// length in the x direction</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespacePhysical__Variables.html#af92161eeeab3e15a31698af80f8d09db">l_x</a> = 2.0;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// length in the y direction</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespacePhysical__Variables.html#a9f73110ebbfe999c6f09ac797793a537">l_y</a> = 1.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Exact solution as a Vector</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespacePhysical__Variables.html#af90d0c580c57b1152fd1cc7046055031">get_exact_u</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; x, Vector&lt;double&gt;&amp; <a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>)</div>
<div class="line"> {</div>
<div class="line">  <a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>[0] = cos(x[0])*exp(x[1]);</div>
<div class="line">  <a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>[1] = -sin(x[0])*exp(x[1]);</div>
<div class="line">  <a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>[2] = cos(x[0])*exp(x[1]);</div>
<div class="line">  <a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>[3] = -cos(x[0])*exp(x[1]);</div>
<div class="line">  <a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>[4] = cos(x[0])*exp(x[1]);</div>
<div class="line">  <a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>[5] = -sin(x[0])*exp(x[1]);</div>
<div class="line"> }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Source function required to make the solution above an exact solution </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespacePhysical__Variables.html#ae11027d76c5f512b7db6a1b6d17dc792">source_function</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; x, <span class="keywordtype">double</span>&amp; source)</div>
<div class="line"> {</div>
<div class="line">  source = 0.0;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of namespace</span></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="main"></a>
The driver code</h2>
<p>The driver code is very simple and short. It is where the problem is defined. In this study, the problem is constructed using the structured mesh with triangular elements in 2D. A number of nodes in an element has to be specific as a template parameter in the problem set up. This is crucial in order to take care of element nodes which we will describe in <a href="../../../shell/linear_shell/html/index.html">another tutorial</a>. Following the usual self-test, we call the function <code>BiharmonicProblem::newton_solve()</code> to compute the solution of the problem. <code>BiharmonicProblem::doc_solution()</code> will output the solution afterwards.</p>
 <div class="fragment"><div class="line"><span class="comment">//======start_of_main==================================================</span></div>
<div class="line"><span class="comment">/// Driver for 2D Biharmonic problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//=====================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="structured__2d__biharmonic__bellelement_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set up the problem: </span></div>
<div class="line"> <span class="comment">// Solve a 2D Biharmonic problem </span></div>
<div class="line"> <a class="code" href="classMyBiharmonicBellProblem.html">MyBiharmonicBellProblem&lt;BiharmonicBellElement&lt;2,2&gt;</a>,2,2&gt; <span class="comment">//Element type as template parameter</span></div>
<div class="line">  problem(<a class="code" href="namespacePhysical__Variables.html#ae11027d76c5f512b7db6a1b6d17dc792">Physical_Variables::source_function</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Check whether the problem can be solved</span></div>
<div class="line"> cout &lt;&lt; <span class="stringliteral">&quot;\n\n\nProblem self-test &quot;</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (problem.self_test()==0)  </div>
<div class="line">  {</div>
<div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;passed: Problem can be solved.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> <span class="keywordflow">else</span> </div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;failed!&quot;</span>,<span class="stringliteral">&quot;main()&quot;</span>,OOMPH_EXCEPTION_LOCATION);</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line"> <span class="comment">// Set up doc info</span></div>
<div class="line"> DocInfo doc_info;</div>
<div class="line"> doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"> doc_info.number()=0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solve the problem</span></div>
<div class="line"> problem.newton_solve();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Output the solution</span></div>
<div class="line"> problem.doc_solution(doc_info);</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of main</span></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="problem"></a>
The problem class</h2>
<p>The problem class has four member functions, illustrated as follows:</p>
<ul>
<li>The problem constructor</li>
<li><code>action_before_newton_solve()</code> : Update the problem specifications before solve. Boundary conditions maybe set here.</li>
<li><code>action_after_newton_solve()</code> : Update the problem specifications after solve.</li>
<li><code>doc_solution()</code> : Pass the number of the case considered, so that output files can be distinguished.</li>
</ul>
<p>From the above mentioned functions, only the problem constructor is non-trivial.</p>
<p>In the present problem, the function <code>Problem::actions_after_newton_solve()</code> is not required, so it remains empty. Also, the class includes a private data member which store a pointer to a source function.</p>
 <div class="fragment"><div class="line"><span class="comment">//==start_of_problem_class============================================</span></div>
<div class="line"><span class="comment">/// 2D Biharmonic problem.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt; </div>
<div class="line"><span class="keyword">class </span><a class="code" href="classMyBiharmonicBellProblem.html">MyBiharmonicBellProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: Pass number of elements and pointer to source function</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classMyBiharmonicBellProblem.html#a61b5ab7db1511188dd7ca00e01179dda">MyBiharmonicBellProblem</a>(<span class="keyword">typename</span> MyBiharmonicEquations&lt;DIM,NNODE_1D&gt;::SourceFctPt source_fct_pt);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classMyBiharmonicBellProblem.html#aa81548287a36375d4e3841cf3d71489b">~MyBiharmonicBellProblem</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="keyword">delete</span> mesh_pt();</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update the problem specs before solve: (Re)set boundary conditions</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classMyBiharmonicBellProblem.html#acdbf06c4f8cf70ee89cd8f1002da98e8">actions_before_newton_solve</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update the problem specs after solve (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classMyBiharmonicBellProblem.html#afbe1effa8e47ff655f99d8ec869eaa2f">actions_after_newton_solve</a>(){}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// \short Doc the solution, pass the number of the case considered,</span></div>
<div class="line"><span class="comment"> /// so that output files can be distinguished.</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classMyBiharmonicBellProblem.html#ae361099fb498e9965ea37a648ce71032">doc_solution</a>(DocInfo&amp; doc_info);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to source function</span></div>
<div class="line"><span class="comment"></span> <span class="keyword">typename</span> MyBiharmonicEquations&lt;DIM,NNODE_1D&gt;::SourceFctPt <a class="code" href="classMyBiharmonicBellProblem.html#ac67539e5f625b52f2da8055599e2c72d">Source_fct_pt</a>;</div>
<div class="line"> </div>
<div class="line">}; <span class="comment">// end of problem class</span></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="constructor"></a>
The Problem constructor</h2>
<p>The problem constructor starts by overloading the function <code>Problem::mesh_pt()</code> and set to the specific mesh used in this problem. In this tutorial, we implement the problem with 2D triangular structured mesh which is internally created by <code>SimpleRectangularTriMesh&lt;&gt;</code>. The generated output will be used to build <code>oomph-lib</code> mesh.</p>
 <div class="fragment"><div class="line"><span class="comment">//=====start_of_constructor===============================================</span></div>
<div class="line"><span class="comment">/// \short Constructor for 2D Biharmonic problem.</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// Discretise the 2D domain with n_element elements of type ELEMENT.</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// Specify function pointer to source function. </span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><a class="code" href="classMyBiharmonicBellProblem.html#a61b5ab7db1511188dd7ca00e01179dda">MyBiharmonicBellProblem&lt;ELEMENT,DIM,NNODE_1D&gt;::MyBiharmonicBellProblem</a></div>
<div class="line">(<span class="keyword">typename</span> MyBiharmonicEquations&lt;DIM,NNODE_1D&gt;::SourceFctPt source_fct_pt) : </div>
<div class="line"> Source_fct_pt(source_fct_pt)</div>
<div class="line">{ </div>
<div class="line"> <span class="comment">// Build mesh and store pointer in Problem</span></div>
<div class="line"> Problem::mesh_pt() = <span class="keyword">new</span> SimpleRectangularTriMesh&lt;ELEMENT&gt;</div>
<div class="line">(<a class="code" href="namespacePhysical__Variables.html#ae766d6695cfb9a8d87be9767b38245ff">Physical_Variables::n_x</a>,<a class="code" href="namespacePhysical__Variables.html#a35801b250816fa72ce9023f8738515fa">Physical_Variables::n_y</a>,<a class="code" href="namespacePhysical__Variables.html#af92161eeeab3e15a31698af80f8d09db">Physical_Variables::l_x</a>,<a class="code" href="namespacePhysical__Variables.html#a9f73110ebbfe999c6f09ac797793a537">Physical_Variables::l_y</a>);</div>
</div><!-- fragment --><p>Next, the boundary conditions of the problem will be taken care. We pin the nodal values on all boundaries and apply the Dirichlet boundary conditions. Note that the boundary identities are labelled anticlockwise where the first boundary is associated with the side <img class="formulaInl" alt="$ (x,y) = (0,y). $" src="form_122.png"/></p>
<div class="fragment"><div class="line"> <span class="comment">// start_of_boundary_conditions</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_bound = mesh_pt()-&gt;nboundary();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>=0;<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>&lt;n_bound;<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> n_node = mesh_pt()-&gt;nboundary_node(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line">    {</div>
<div class="line">     mesh_pt()-&gt;boundary_node_pt(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>,n)-&gt;pin(0); </div>
<div class="line">     mesh_pt()-&gt;boundary_node_pt(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>,n)-&gt;pin(1); </div>
<div class="line">     mesh_pt()-&gt;boundary_node_pt(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>,n)-&gt;pin(2);</div>
<div class="line"> </div>
<div class="line">     mesh_pt()-&gt;boundary_node_pt(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>,n)-&gt;pin(3);</div>
<div class="line">     mesh_pt()-&gt;boundary_node_pt(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>,n)-&gt;pin(4);</div>
<div class="line">     mesh_pt()-&gt;boundary_node_pt(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>,n)-&gt;pin(5);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> <span class="comment">// end of boundary conditionss </span></div>
</div><!-- fragment --><p>We then loop over the elements and set the pointer to the physical parameters, the function pointer to the source function which is the function on the right-hand side of the Biharmonic equation.</p>
<div class="fragment"><div class="line"> <span class="comment">// Loop over elements and set pointers to Physical parameters</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>=0;<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>&lt;n_element;<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line">   ELEMENT *elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set the source function pointer and all physical variables</span></div>
<div class="line">   elem_pt-&gt;source_fct_pt() = Source_fct_pt;</div>
<div class="line">  }</div>
<div class="line"> <span class="comment">// end of pointers set up</span></div>
</div><!-- fragment --><p>We finish the constructor by assigning the equation numbering scheme. </p><div class="fragment"><div class="line"> <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"> assign_eqn_numbers();</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of constructor</span></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="actionbefore"></a>
Action before newton solve</h2>
<p>In the <code>action_before_newton_solve()</code>, the problem specifications will be updated before performing the newton solve. The boundary values will be (re)set from the exact solutions.</p>
 <div class="fragment"><div class="line"><span class="comment">//===start_of_actions_before_newton_solve========================================</span></div>
<div class="line"><span class="comment">/// \short Update the problem specs before solve: (Re)set boundary values</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// from the exact solution. </span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classMyBiharmonicBellProblem.html#acdbf06c4f8cf70ee89cd8f1002da98e8">MyBiharmonicBellProblem&lt;ELEMENT,DIM,NNODE_1D&gt;::actions_before_newton_solve</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// How many boundaries are there?</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_bound = mesh_pt()-&gt;nboundary();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Loop over the boundaries</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>=0;<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>&lt;n_bound;<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// How many nodes are there on this boundary?</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n_node = mesh_pt()-&gt;nboundary_node(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Loop over the nodes on boundary</span></div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// Get pointer to node</span></div>
<div class="line">     Node* nod_pt=mesh_pt()-&gt;boundary_node_pt(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>,n);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// Extract nodal coordinates from node:</span></div>
<div class="line">     Vector&lt;double&gt; x(2);</div>
<div class="line">     x[0]=nod_pt-&gt;x(0);</div>
<div class="line">     x[1]=nod_pt-&gt;x(1);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// Compute the value of the exact solution at the nodal point</span></div>
<div class="line">     Vector&lt;double&gt; <a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>(6);</div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>=0;<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>&lt;6;<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++)</div>
<div class="line">      {</div>
<div class="line">       <a class="code" href="namespacePhysical__Variables.html#af90d0c580c57b1152fd1cc7046055031">Physical_Variables::get_exact_u</a>(x,<a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Assign the value to the one (and only) nodal value at this node</span></div>
<div class="line">       nod_pt-&gt;set_value(<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>,<a class="code" href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a>[<a class="code" href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// end of actions before solve</span></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="doc"></a>
Post-processing</h2>
<p>The post-processing routine writes the computed results to an output file.</p>
 <div class="fragment"><div class="line"><span class="comment">//===start_of_doc=========================================================</span></div>
<div class="line"><span class="comment">/// Doc the solution in tecplot format. Label files with label.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keywordtype">unsigned</span> DIM, <span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classMyBiharmonicBellProblem.html#ae361099fb498e9965ea37a648ce71032">MyBiharmonicBellProblem&lt;ELEMENT,DIM,NNODE_1D&gt;::doc_solution</a>(DocInfo&amp; doc_info)</div>
<div class="line">{ </div>
<div class="line"> </div>
<div class="line"> ofstream some_file;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of plot points</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"> npts=10; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output solution with specified number of plot points per element</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> some_file.precision(20);</div>
<div class="line"> mesh_pt()-&gt;output(some_file,npts);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output exact solution </span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/exact_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());some_file.open(filename);</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> mesh_pt()-&gt;output_fct(some_file,npts,<a class="code" href="namespacePhysical__Variables.html#af90d0c580c57b1152fd1cc7046055031">Physical_Variables::get_exact_u</a>); </div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc pointwise error and compute norm of error and of the solution</span></div>
<div class="line"> <span class="keywordtype">double</span> error,norm;</div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/error%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> mesh_pt()-&gt;compute_error(some_file,<a class="code" href="namespacePhysical__Variables.html#af90d0c580c57b1152fd1cc7046055031">Physical_Variables::get_exact_u</a>,</div>
<div class="line">                          error,norm); </div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc error norm:</span></div>
<div class="line"> cout &lt;&lt; <span class="stringliteral">&quot;\nNorm of error    : &quot;</span> &lt;&lt; sqrt(error) &lt;&lt; std::endl; </div>
<div class="line"> cout &lt;&lt; <span class="stringliteral">&quot;Norm of solution : &quot;</span> &lt;&lt; sqrt(norm) &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"> cout &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of doc</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
<center> <a href="../../../../demo_drivers/biharmonic/structured_2d_biharmonic/">demo_drivers/biharmonic/structured_2d_biharmonic/ </a> </center><br  />
</li>
<li>The driver code is: <br  />
<br  />
<center> <a href="
../../../../
demo_drivers/biharmonic/structured_2d_biharmonic/structured_2d_biharmonic_bellelement.cc
">demo_drivers/biharmonic/structured_2d_biharmonic/structured_2d_biharmonic_bellelement.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="ttc" id="astructured__2d__biharmonic__bellelement_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="structured__2d__biharmonic__bellelement_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver for 2D Biharmonic problem.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l01154">structured_2d_biharmonic_bellelement.cc:1154</a></div></div>
<div class="ttc" id="aclassMyBiharmonicBellProblem_html_acdbf06c4f8cf70ee89cd8f1002da98e8"><div class="ttname"><a href="classMyBiharmonicBellProblem.html#acdbf06c4f8cf70ee89cd8f1002da98e8">MyBiharmonicBellProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve: (Re)set boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l01065">structured_2d_biharmonic_bellelement.cc:1065</a></div></div>
<div class="ttc" id="anamespacePhysical__Variables_html_af90d0c580c57b1152fd1cc7046055031"><div class="ttname"><a href="namespacePhysical__Variables.html#af90d0c580c57b1152fd1cc7046055031">Physical_Variables::get_exact_u</a></div><div class="ttdeci">void get_exact_u(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;u)</div><div class="ttdoc">Exact solution as a Vector.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00946">structured_2d_biharmonic_bellelement.cc:946</a></div></div>
<div class="ttc" id="anamespacePhysical__Variables_html_a9f73110ebbfe999c6f09ac797793a537"><div class="ttname"><a href="namespacePhysical__Variables.html#a9f73110ebbfe999c6f09ac797793a537">Physical_Variables::l_y</a></div><div class="ttdeci">double l_y</div><div class="ttdoc">length in the y direction</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00943">structured_2d_biharmonic_bellelement.cc:943</a></div></div>
<div class="ttc" id="anamespacePhysical__Variables_html"><div class="ttname"><a href="namespacePhysical__Variables.html">Physical_Variables</a></div><div class="ttdoc">Namespace for the solution of 2D Biharmonic equation.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00930">structured_2d_biharmonic_bellelement.cc:930</a></div></div>
<div class="ttc" id="abell__element_8txt_html_a9ea9af8920341be9c8d87a284651e90e"><div class="ttname"><a href="bell__element_8txt.html#a9ea9af8920341be9c8d87a284651e90e">u</a></div><div class="ttdeci">f u</div><div class="ttdef"><b>Definition:</b> <a href="bell__element_8txt_source.html#l00173">bell_element.txt:173</a></div></div>
<div class="ttc" id="abell__element_8txt_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="bell__element_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="bell__element_8txt_source.html#l00155">bell_element.txt:155</a></div></div>
<div class="ttc" id="aclassMyBiharmonicBellProblem_html_ae361099fb498e9965ea37a648ce71032"><div class="ttname"><a href="classMyBiharmonicBellProblem.html#ae361099fb498e9965ea37a648ce71032">MyBiharmonicBellProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution, pass the number of the case considered, so that output files can be distinguished.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l01105">structured_2d_biharmonic_bellelement.cc:1105</a></div></div>
<div class="ttc" id="aclassMyBiharmonicBellProblem_html_aa81548287a36375d4e3841cf3d71489b"><div class="ttname"><a href="classMyBiharmonicBellProblem.html#aa81548287a36375d4e3841cf3d71489b">MyBiharmonicBellProblem::~MyBiharmonicBellProblem</a></div><div class="ttdeci">~MyBiharmonicBellProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00979">structured_2d_biharmonic_bellelement.cc:979</a></div></div>
<div class="ttc" id="aclassMyBiharmonicBellProblem_html_a61b5ab7db1511188dd7ca00e01179dda"><div class="ttname"><a href="classMyBiharmonicBellProblem.html#a61b5ab7db1511188dd7ca00e01179dda">MyBiharmonicBellProblem::MyBiharmonicBellProblem</a></div><div class="ttdeci">MyBiharmonicBellProblem(typename MyBiharmonicEquations&lt; DIM, NNODE_1D &gt;::SourceFctPt source_fct_pt)</div><div class="ttdoc">Constructor: Pass number of elements and pointer to source function.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l01010">structured_2d_biharmonic_bellelement.cc:1010</a></div></div>
<div class="ttc" id="aclassMyBiharmonicBellProblem_html_afbe1effa8e47ff655f99d8ec869eaa2f"><div class="ttname"><a href="classMyBiharmonicBellProblem.html#afbe1effa8e47ff655f99d8ec869eaa2f">MyBiharmonicBellProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the problem specs after solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00988">structured_2d_biharmonic_bellelement.cc:988</a></div></div>
<div class="ttc" id="anamespacePhysical__Variables_html_ae766d6695cfb9a8d87be9767b38245ff"><div class="ttname"><a href="namespacePhysical__Variables.html#ae766d6695cfb9a8d87be9767b38245ff">Physical_Variables::n_x</a></div><div class="ttdeci">unsigned n_x</div><div class="ttdoc">number of elements in the x direction</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00934">structured_2d_biharmonic_bellelement.cc:934</a></div></div>
<div class="ttc" id="anamespacePhysical__Variables_html_a35801b250816fa72ce9023f8738515fa"><div class="ttname"><a href="namespacePhysical__Variables.html#a35801b250816fa72ce9023f8738515fa">Physical_Variables::n_y</a></div><div class="ttdeci">unsigned n_y</div><div class="ttdoc">number of elements in the y direction</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00937">structured_2d_biharmonic_bellelement.cc:937</a></div></div>
<div class="ttc" id="aclassMyBiharmonicBellProblem_html_ac67539e5f625b52f2da8055599e2c72d"><div class="ttname"><a href="classMyBiharmonicBellProblem.html#ac67539e5f625b52f2da8055599e2c72d">MyBiharmonicBellProblem::Source_fct_pt</a></div><div class="ttdeci">MyBiharmonicEquations&lt; DIM, NNODE_1D &gt;::SourceFctPt Source_fct_pt</div><div class="ttdoc">Pointer to source function.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00997">structured_2d_biharmonic_bellelement.cc:997</a></div></div>
<div class="ttc" id="anamespacePhysical__Variables_html_af92161eeeab3e15a31698af80f8d09db"><div class="ttname"><a href="namespacePhysical__Variables.html#af92161eeeab3e15a31698af80f8d09db">Physical_Variables::l_x</a></div><div class="ttdeci">double l_x</div><div class="ttdoc">length in the x direction</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00940">structured_2d_biharmonic_bellelement.cc:940</a></div></div>
<div class="ttc" id="aclassMyBiharmonicBellProblem_html"><div class="ttname"><a href="classMyBiharmonicBellProblem.html">MyBiharmonicBellProblem</a></div><div class="ttdoc">2D Biharmonic problem.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00970">structured_2d_biharmonic_bellelement.cc:970</a></div></div>
<div class="ttc" id="anamespacePhysical__Variables_html_ae11027d76c5f512b7db6a1b6d17dc792"><div class="ttname"><a href="namespacePhysical__Variables.html#ae11027d76c5f512b7db6a1b6d17dc792">Physical_Variables::source_function</a></div><div class="ttdeci">void source_function(const Vector&lt; double &gt; &amp;x, double &amp;source)</div><div class="ttdoc">Source function required to make the solution above an exact solution.</div><div class="ttdef"><b>Definition:</b> <a href="structured__2d__biharmonic__bellelement_8cc_source.html#l00957">structured_2d_biharmonic_bellelement.cc:957</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Sat Jul 17 2021 15:36:58
        </div>
      </div>
    </footer>
</body>
</html>
