In \href{../../../c1_element/bell_element/html/index.html}{\texttt{ the previous tutorial}}, the triangular Bell element has been successfully used to solve the Biharmonic equation which is a fourth-\/order problem in two dimensions. The domains of interest considered in the particular problem contained only straight boundaries so that this representation was exact. However, in many engineering applications, the geometric boundary of a problem is not straight. Solving such a problem with the straight-\/sided $ C^1 $-\/finite elements limits the convergence rate and accuracy as presented in \href{http://onlinelibrary.wiley.com/doi/10.1002/pamm.201010272/pdf}{\texttt{ a publication of P.\+Fischer(2010)}} .

In order to deal with a fourth-\/order problem, which requires $ C^1 $-\/continuity, on a curvilinear domain, the $ C^1 $-\/curved triangular element is introduced in this document. Numerical implementations of the Biharmonic equation on a circular domain will be presented. This is to compare the results obtained between the Bell and the $ C^1 $-\/curved triangular elements. Both rate of convergence and the obtained accuracy will be determined together with the computational time. This is to show that representing a curved boundary by a series of straight-\/sided elements exhibits a limitation in convergence rate and accuracy. Also, we would like to illustrate that the $ C^1 $-\/curved triangular element can retain the rate of convergence and accuracy when a curvilinear boundary is concerned.

The reader is referred to \href{../../../c1_element/bell_element/html/index.html}{\texttt{ a two-\/dimensional Biharmonic problem with the Bell triangular finite element tutorial}} for more detailed descriptions of the variational principle of the Biharmonic equation and the Bell element.

In addition, in this document we demonstrate


\begin{DoxyItemize}
\item general descriptions of the {\ttfamily C1\+Curved\+Element} which is our defined $ C^1 $-\/triangular finite element dealing with a 2D curvilinear domain
\end{DoxyItemize}
\begin{DoxyItemize}
\item numerical results of solving the Biharmonic equation with the {\ttfamily C1\+Curved\+Element} 
\end{DoxyItemize}and
\begin{DoxyItemize}
\item how to implement the {\ttfamily C1\+Curved\+Element} in {\ttfamily oomph-\/lib} using the Biharmonic equation as a case study.
\end{DoxyItemize}\DoxyHorRuler{0}
 ~\newline
 \DoxyHorRuler{0}
\hypertarget{index_overview}{}\doxysection{Overview of the C1\+Curved\+Element}\label{index_overview}
The constructed {\ttfamily C1\+Curved\+Element} provides a discretisation of a problem with two-\/dimensional, subparametric triangular finite elements. With this element, the discretisation of the domain of interest in this document will be the union of two sets of triangles. The first set will constitute of straight-\/sided triangles which is the triangulation of interior elements. The other will constitute of curve-\/sided triangles which are elements at a curved boundary. Note that each of two distinct triangles of the triangulations is either disjoint, or have a common vertex or a common edge. Consequently, we have to define mappings associated the reference and the physical triangles for each straight and curved triangles.

Regarding the approximation of variables on the straight boundary domain, the Bell shape functions will be employed. On the curved boundary domain, the shape functions will be re-\/constructed compatible with the Bell shape functions. These new functions will be defined over the approximated domain associated with the mappings approximating the curved boundary. Finally, all of these shape functions will be used to define interpolations of variables on the typical elements.

Specifically, we shall provide
\begin{DoxyItemize}
\item The mappings associated the reference triangle and the physical triangles
\item The shape functions defined on the {\ttfamily C1\+Curved\+Element} 
\item The interface of accessible functions to the shape functions
\end{DoxyItemize}\hypertarget{index_mapping}{}\doxysubsection{The mappings associated the reference triangle with the physical triangles}\label{index_mapping}
In order to approximate the geometry in the {\ttfamily C1\+Curved\+Element}, the subparametric mapping which associates the reference and the physical triangles is considered in this study. Also, we will define mapping by using polynomials to approximate boundaries.

Since there are two sets of triangular elements in the mesh, different mappings have to be considered for typical elements. Dealing with a straight-\/sided triangle in a physical domain, an affine mapping will be taken into account. Nonetheless, a nonlinear mapping has to be considered in order to deal with a curved-\/edge triangle.

Regarding a straight-\/sided triangle, we define the affine mapping $F_{K_{I}}$ which is parametrised by the reference coordinates $ \hat{x}_{\alpha}, \alpha = 1,2, $ defined on the reference triangle $ \hat{K} = \{(\hat{x}_1, \hat{x}_2) | 0 \leq \hat{x}_1, \hat{x}_2 \leq 1, \hat{x}_1 + \hat{x}_2 = 1 \} $ and can be constructed as follow

\[ x_{\alpha} = F_{K_{I\alpha}}(\hat{x}_{1},\hat{x}_{2}) = x_{\alpha 3} + (x_{\alpha 1} - x_{\alpha 3})\hat{x}_{1} + (x_{\alpha 2} - x_{\alpha 3})\hat{x}_{2}, \ \ \ \ \ \ (1) \] where $ x_{\alpha i}$ denote the global coordinates $ \alpha = 1,2 $ of the vertices $\mathbf{a}_{i}, i = 1,2,3,$ of the physical triangle $ K_I $ as depicted in the following figure. Also, $ F_{K_{I \alpha}} $ is a $ \alpha^{th} $ component of the mapping $ F_{K_{I}} $. This mapping will help us to associate a position $(\hat{x}_1,\hat{x}_2)$ on the reference triangle with a position $(x_{1},x_{2})$ on the physical triangle whose sides are straight.

 
\begin{DoxyImage}
\includegraphics[width=0.35\textwidth]{mapping}
\doxyfigcaption{A graphical description of the mappings associated between the reference coordinates and the physical coordinates. }
\end{DoxyImage}


Regarding the curved boundary, the mapping $ F_{K_{C}} $ is defined to associate between the reference and the physical curved triangles. These curved triangles are considered to have two straight sides and one curved side approximating an arc of the boundary. In this case, the mapping $ F_{K_{C}} $ is nonlinear and can be constructed as in the following descriptions.

Let $\Omega$ be a given bounded domain on the plane whose boundary is curve in two-\/dimensional space. We assume that the curved boundary $\Gamma$ can be subdivided into a finite number of arcs and each of them can be described as

\[ x_{1} = \chi_{1}(s), \ \ \ x_{2} = \chi_{2}(s), \ \ \ s_{m} \leq s \leq s_{M}, \]

where $ x_{\alpha}, \alpha=1,2, $ denote coordinates in two-\/dimensional space defined on the curved boundary $ \Gamma $ and approximated by the polynomials $\chi_{1}(s), \chi_{2}(s)$ which are continuous on the arc $ [s_{m},s_{M}]. $

Before we will consider the nonlinear mapping $ F_{K_{C}} $, we will first determine a mapping $ \varphi_{\alpha} $ which associates the side $ \bf{\hat{a}}_1\bf{\hat{a}}_2 $ on the reference triangle, $ \hat{K} $, with the curved boundary $\Gamma$. This mapping is defined to be parametrised by the reference coordinate, say $ \hat{x}_{2}, $ and satisfies

\[ \varphi_{\alpha}(\hat{x}_2 = 0) = \chi_{\alpha}(s_{m}) = x_{\alpha 1} = \mathbf{a}_{1}, \] \[ \varphi_{\alpha}(\hat{x}_2 = 1) = \chi_{\alpha}(s_{M}) = x_{\alpha 2} = \mathbf{a}_{2}, \ \ \ \ \ \ (2) \]

where $ \varphi_{\alpha}(\hat{x_{2}}) \equiv \chi_{\alpha}(s_{m} + (s_{M}-s_{m})\hat{x}_{2}) $. Note that either the reference coordinate $ \hat{x}_{1} $ or $ \hat{x}_{2} $ can be used to parametrise the arc but re-\/calculation will be required to defined the mapping.

Here, the Hermite-\/type polynomial of degree 3 is our choice to approximate the curved boundary. The reason for this choice is that cubic is the minimum degree of polynomial to obtain the $C^1$-\/continuity ( see \href{http://www.sciencedirect.com/science?_ob=MiamiImageURL&_cid=271868&_user=6991156&_pii=004578259390111A&_check=y&_origin=article&_zone=toolbar&_coverDate=31-Jan-1993&view=c&originContentFamily=serial&wchp=dGLzVlV-zSkzk&md5=d038a1aec18c25806e39c26187c2a200&pid=1-s2.0-004578259390111A-main.pdf}{\texttt{ M.\+Bernadou (1993)}} ). Hence, the following four conditions have to be specified

\[ x_{\alpha 1} = \varphi_{\alpha}(0) = \chi_{\alpha}(s_{m}), \mbox{ } x_{\alpha 2} = \varphi_{\alpha}(1) = \chi_{\alpha}(s_{M}), \] \[ \varphi^{\prime}_{\alpha}(0) = (s_{M}-s_{m})\chi^{\prime}_{\alpha}(s_{m}), \mbox{ } \varphi^{\prime}_{\alpha}(1) = (s_{M}-s_{m})\chi^{\prime}_{\alpha}(s_{M}). \ \ \ \ (3)\]

These conditions are constraints in order to satisfy (2) for the coordinate values $ x_{\alpha} $ in order to obtain the continuity.

By considering the cubic polynomial, $ \varphi_{\alpha}(\hat{x}_2) $, in the form of (4) with the conditions for derivatives in (3), the mapping $ \varphi_{\alpha}(\hat{x}_2) $ can be obtained.

\[ \varphi_{\alpha}(\hat{x}_2) = x_{\alpha 1} + (x_{\alpha 2} - x_{\alpha 1})\hat{x}_{2} + \hat{x}_{2}(1-\hat{x}_{2})[m_{\alpha}\hat{x}_{2}+c_{\alpha}]. \ \ \ \ (4) \]

Regarding the nonlinear mapping $ F_{K_{C}}, $ it is defined to approximate the coordinates $ x_{\alpha}, \alpha = 1,2, $ so that the side $ \bf{\hat{a}}_1\bf{\hat{a}}_2 $ on the reference triangle, $ \hat{K}, $ associates with the curved side of the curved physical triangle. Also, the mapping $ F_{K_{C}} $ has to be an affine mapping along the side $ \mathbf{a}_{3}\mathbf{a}_{\alpha}, \alpha = 1,2 $. Therefore, the nonlinear mapping $ F_{K_{C}} $ that associates the reference and the curved elements with the cubic polynomial approximating a curved boundary is obtained as follow

\[ x_{\alpha} = F_{K_{C\alpha}}(\hat{x}_{1},\hat{x}_{2}) = x_{\alpha 3} + ( x_{\alpha 1} - x_{\alpha 3} )\hat{x}_{1} + (x_{\alpha 2} - x_{\alpha 3})\hat{x}_{2} \] \[ + \frac{1}{2}\hat{x}_{1}\hat{x}_{2}\left\{\left[2(x_{\alpha 2}-x_{\alpha 1})-(s_{M}-s_{m})(\chi^{\prime}_{\alpha}(s_{m}) +\chi^{\prime}_{\alpha}(s_{M}))\right](\hat{x}_{2}-\hat{x}_{1} ) + (s_{M}-s_{m})\left[\chi^{\prime}_{\alpha}(s_{m}) -\chi^{\prime}_{\alpha}(s_{M})\right]\right\}, \ \ \ (5)\] where $ F_{K_{C\alpha}} $ denotes an $\alpha^{th} $ component of the mapping $ F_{K_{C}} $. Note that the nonlinear mapping $ F_{K_{C\alpha}}(1-\hat{x}_{2},\hat{x}_{2}) = \varphi_{\alpha}(\hat{x}_{2}) $ when comes to the side $ \mathbf{a}_{1}\mathbf{a}_{2} $, as decided.

The derivation of the nonlinear mapping $ F_{K_{C}} $ can be found in \href{http://www.sciencedirect.com/science?_ob=MiamiImageURL&_cid=271868&_user=6991156&_pii=004578259390111A&_check=y&_origin=article&_zone=toolbar&_coverDate=31-Jan-1993&view=c&originContentFamily=serial&wchp=dGLzVlV-zSkzk&md5=d038a1aec18c25806e39c26187c2a200&pid=1-s2.0-004578259390111A-main.pdf}{\texttt{ a publication of M.\+Bernadou (1993)}} .

\DoxyHorRuler{0}
\hypertarget{index_c1_shape}{}\doxysubsection{The shape functions defined on the C1\+Curved\+Element}\label{index_c1_shape}
In this section, we will elaborate the shape functions defined on the {\ttfamily C1\+Curved\+Element}. Since there are two types of elements defined on the {\ttfamily C1\+Curved\+Element}, two sets of shape functions will be considered.

On the straight-\/sided triangular element, we inherit the {\ttfamily Bell\+Element} to approximate values defined on the element. Therefore, the Bell shape functions will be employed and their details can be found in \href{../../../c1_element/bell_element/html/index.html}{\texttt{ the Bell triangular finite element tutorial}}. Note that the Bell shape functions are defined with respect to the global coordinates so that the transformation of derivatives between the local and the global coordinates is no longer need in an implementation.

Next, we will define shape functions of the $ C^1 $-\/curved finite element in order to interpolate any function defined over the curve-\/sided triangular element. Unlike the interpolation functions defined on the Bell triangular element, the interpolation functions of the $ C^1 $-\/curved triangle are chosen to defined over the reference triangle $ \hat{K}. $ Therefore, for any polynomial $p \in P_{K}$ defined over the curved triangle $ K_{C}, $ we employ the mapping defined in (5) to associate this polynomial $ p $ with the polynomial defined on the reference triangle as \[ \hat{p} = p \circ F_{K_C}. \]

Note that defining a polynomial on the reference triangle, $\hat{K}$, is a desirable condition which is convenient for the study of the approximation error and to take into account the numerical integration.

Subsequently, using a polynomial of degree 3 to approximate a curved boundary in our study, polynomials of degree 7 have to be defined as shape functions over the reference triangle in order to interpolate unknowns on a curved triangle. This is in order to achieve the required convergence and to satisfy the $ C^1 $-\/compatibility with the Bell finite elements. The reader may refer to \href{http://www.sciencedirect.com/science?_ob=MiamiImageURL&_cid=271868&_user=6991156&_pii=004578259390111A&_check=y&_origin=article&_zone=toolbar&_coverDate=31-Jan-1993&view=c&originContentFamily=serial&wchp=dGLzVlV-zSkzk&md5=d038a1aec18c25806e39c26187c2a200&pid=1-s2.0-004578259390111A-main.pdf}{\texttt{ a publication of M.\+Bernadou (1993)}} for more details.

The desired $P_{7}$-\/ $C^1$ reference element will constitute of $\hat{K}$ which is a unit right-\/angled triangle, the set of degrees of freedom $ \hat{\Sigma}(\hat{w}),$ and $\hat{P}$ which is a space of complete polynomials of degree 7 with its dimension equals to 36. The set of $ \hat{\Sigma}(\hat{w}) $ composes of values and their derivatives defined on vertices, $ \mathbf{\hat{a}}_i, i=1,2,3, $ and along edges, $ \mathbf{\hat{b}}_i, i=1,2,3 $, $ \mathbf{\hat{d}}_i, i = 1,...,6, $ and the internal nodes, $ \mathbf{\hat{e}}_i, i=1,2,3, $ of the reference triangle illustrated in the following figure and are defined as

\[ \hat{\Sigma}(\hat{w}) = \left\{\hat{w}(\mathbf{\hat{a}}_{i}), \frac{\partial \hat{w}}{\partial \hat{x}_{1}}(\mathbf{\hat{a}}_{i}), \frac{\partial \hat{w}}{\partial \hat{x}_{2}}(\mathbf{\hat{a}}_{i}), \frac{\partial^2 \hat{w}}{\partial \hat{x}^2_{1}}(\mathbf{\hat{a}_{i}}), \frac{\partial^2 \hat{w}}{\partial \hat{x}_{1}\hat{x}_{2}}(\mathbf{\hat{a}}_{i}), \frac{\partial^2 \hat{w}}{\partial \hat{x}^2_{2}}(\mathbf{\hat{a}}_{i}), i=1,2,3 \right\} \] \[ \cup \left\{ -\frac{\partial \hat{w}}{\partial \hat{x}_{1}}(\mathbf{\hat{b}}_{1}); -\frac{\partial \hat{w}}{\partial \hat{x}_{2}}(\mathbf{\hat{b}}_{2}); \frac{\sqrt{2}}{2}\left(\frac{\partial \hat{w}}{\partial \hat{x}_{1}}+\frac{\partial \hat{w}}{\partial \hat{x}_{2}}\right)(\mathbf{\hat{b}}_{3}) \right\} \cup \] \[ \left\{ \hat{w}(\mathbf{\hat{d}}_{i}),i=1,...,6; -\frac{\partial \hat{w}}{\partial \hat{x}_{1}}(\mathbf{\hat{d}}_{i}), i=1,2; -\frac{\partial \hat{w}}{\partial \hat{x}_{2}}(\mathbf{\hat{d}}_{i}), i=3,4; \frac{\sqrt{2}}{2}\left(\frac{\partial \hat{w}}{\partial \hat{x}_{1}} + \frac{\partial \hat{w}}{\partial \hat{x}_{2}}\right)(\mathbf{\hat{d}}_{i}), i=5,6 \right\} \] \[ \cup \left\{ \hat{w}(\mathbf{\hat{e}}_{i}),i=1,2,3 \right\}, \]

where $\hat{w}$ denotes a function defined over the reference element $\hat{K}.$

 
\begin{DoxyImage}
\includegraphics[width=0.35\textwidth]{Triple_of_FE}
\doxyfigcaption{The reference element of the C1-\/curved finite element compatible with the Bell triangle where the degree of polynomial approximating curved boundaries is cubic. }
\end{DoxyImage}


Since the $ P_7-C^1 $-\/shape functions of the $ C^1 $-\/curved finite element are defined on the reference triangle $ \hat{K} $, its 36 degrees of freedom have to be associated with those defined on the curved physical triangle. To consider the degrees of freedom defined on the curved physical triangle, they have to ensure the connection of class $ C^1 $-\/compatible with the Bell triangles as the Bell triangles are its adjacent elements.

To define such a connection, the following conditions have to be satisfied to assure a compatibility between a curved finite element and the Bell triangle.


\begin{DoxyItemize}
\item One-\/variable polynomials of any function $ p $ defined over the curved triangle and their normal derivatives $ \frac{\partial p}{\partial n} $ along the connected sides have to coincide with those of the Bell elements. That is the degrees of the polynomial and its normal derivatives along the connecting sides have to be of degree 5 and 3, respectively.
\item the degrees of freedom of the curved finite element relative to the connecting sides have to be identical to those of the Bell elements and have to be entirely determined on those sides.
\end{DoxyItemize}

Therefore, we have that our $ C^1$-\/curved triangular finite element has to define so that the set of degrees of freedom on the vertices of the curved physical triangle is the same as those of the Bell element.

Furthermore, there will be three additional degrees of freedom defined inside the curved triangle $ K_C$ as seen in Fig. 1.\+3. These nodes come from three internal nodes defined in order to ensure the $C^1$-\/continuity in determining the polynomial of degree 7 on the reference element. Consequently, there are 21 degrees of freedom in total defined over the curved triangular element.

The set $\Sigma_{K}(v)$ of values of degrees of freedom of $v$ defined on the curved physical triangle is then given by

\[ \Sigma_{K}(v) = \left\{ (D^{\alpha}v(\mathbf{a}_{i}), \alpha = 0,1,2), i=1,2,3; v(\mathbf{e}_{i}), i = 1,2,3 \right\}. \ \ \ \ \ \ (6)\]

 
\begin{DoxyImage}
\includegraphics[width=0.35\textwidth]{Set_of_dof_curved_element}
\doxyfigcaption{The set of degrees of freedom for the C1-\/curved finite element compatible with the Bell element. }
\end{DoxyImage}


In order to interpolate a function $ v $ defined on the curved physical triangle, the $P_7-C^1$-\/shape functions and the 36 associated values of degrees of freedom have to be taken into account. Since the 36 nodal degrees of freedom depend on 21 nodal degrees of freedom defined on $K_C$ illustrated in (6), the association between those values of degrees of freedom have to be defined.

Since the number of degrees of freedom defined on the curved and the reference triangles are different, the derivation of the associations is not straightforward. Detailed descriptions of the derivation of the association $ \tilde{M} $ can be found in \href{http://www.sciencedirect.com/science?_ob=MiamiImageURL&_cid=271868&_user=6991156&_pii=004578259390111A&_check=y&_origin=article&_zone=toolbar&_coverDate=31-Jan-1993&view=c&originContentFamily=serial&wchp=dGLzVlV-zSkzk&md5=d038a1aec18c25806e39c26187c2a200&pid=1-s2.0-004578259390111A-main.pdf}{\texttt{ a publication of M.\+Bernadou (1993)}}.

\DoxyHorRuler{0}
\hypertarget{index_intp}{}\doxysubsection{The interpolation of a function, v, defined on the domain}\label{index_intp}
The interpolation of a function $ v $ defined on the physical triangle can be determined associated with the straight and the curved element.

If we want to interpolate a function $ v $ defined on the straight physical triangle, the Bell shape functions have to be taken into account. Therefore, the interpolation can be defined as

\[ u(x_1,x_2) = \sum_{l=1}^{3}\sum_{k=1}^{6} u_{lk}\psi^{B}_{lk}(x_{1},x_{2}), \ \ \ \ \ \ (7) \]

where $ u_{lk} $ and $ \psi^{B}_{lk}, l=1,2,3, k=1,...,6, $ are the nodal values and the Bell shape functions defined on the physical element $ K_I $, respectively.

Otherwise, the interpolation of a function $ v $ defined on the curved physical triangle can be determined by quantities defined on the reference triangle as

\[ u(x_1(\mathbf{\xi}),x_2(\mathbf{\xi})) = \sum_{j=1}^{36}{\hat{u}_{j}\hat{\psi}_{j}}(\xi_{1},\xi_{2}), \ \ \ \ \ \ (8)\]

where $ \hat{u}_{j} $ are the nodal values defined at node $j$ on the reference triangle $ \hat{K} $. Also, $ \hat{\psi}_{j}, j=1,...,36, $ are the $ C^1 $-\/shape functions defined by complete polynomials of degree 7 on the reference element $ \hat{K} $.

Since all these nodal values $ \hat{u}_{j} $ are defined to depend only on 21 nodal values, $ u_{k} $, defined on the curved element $ K_{C} $, the set of nodal values defined on the reference element can be associated with those defined on the curved element through the association $ \tilde{M} $ by \[ \hat{u}_{j} = \sum_{k=1}^{21}{u_{k}\tilde{M}_{kj}}, \forall j=1,...,36, \ \ \ \ \ \ (9) \]

Substituting (9) into (8), we have that the approximation of the unknown $ u$ can be expressed as the linear combination between the shape functions defined on the reference triangle $ \hat{K} $ and the values defined on the physical curved triangle as follow

\[ u(x_1(\mathbf{\xi}),x_2(\mathbf{\xi})) = \sum_{j=1}^{36}{\sum_{k=1}^{21}{u_{k}\tilde{M}_{kj}}\hat{\psi}_{j}}(\xi_{1},\xi_{2}). \]

Note that the shape functions of the $ C^1 $-\/curved element can be determined from the $ \delta_{ij} $ property of the shape function. Also, they are defined with respect to the local coordinates. Hence, the transformation of derivatives between the local and the global coordinates is needed in an implementation in order to ensure $ C^1 $-\/continuity.

\DoxyHorRuler{0}
\hypertarget{index_interface}{}\doxysubsection{The interface of accessible functions to the shape functions of the C1\+Curved\+Element}\label{index_interface}
Regarding the curvilinear boundary domain study in this tutorial, its triangulation constitutes of both straight-\/sided and curve-\/sided triangle. Different number of nodes and shape functions have to be considers in {\ttfamily C1\+Curved\+Element} in order to associate with both the straight and curved triangular elements in the triangulation.

Now, we will consider the face-\/element of the {\ttfamily C1\+Curved\+Element}. According to section 1.\+1.\+2, we have that 21 degrees of freedom defined on the $ C^1 $-\/curved triangular element are associated with three vertices and three interior node of the curved physical triangle. Unlike the $ C^1 $-\/curved triangular elements, all 18 degrees of freedom of the Bell element are defined on only three vertices.

Therefore, the face element of the {\ttfamily C1\+Curved\+Element} have to define generally in order to associate with both straight-\/sided and curve-\/sided elements. Consequencely, there are six nodes in total in a {\ttfamily C1\+Curved\+Element} with {\ttfamily N\+N\+O\+D\+E\+\_\+1D} equals to 2. The following figure illustrates the number of nodes defined in both the Bell and the $ C^1 $-\/curved triangular elements.

 
\begin{DoxyImage}
\includegraphics[width=0.35\textwidth]{Graphic_curved_element}
\doxyfigcaption{The graphical description of the face-\/element defined in the {\ttfamily C1\+Curved\+Element}. }
\end{DoxyImage}


Apparently, our constructed {\ttfamily C1\+Curved\+Element} are only available for three interior nodes for all cases of {\ttfamily N\+N\+O\+D\+E\+\_\+1D}. The fixed number of interior nodes is a consequence of using degree 3 of polynomial to approximate a curvilinear boundary as mentioned in subsection 1.\+1.\+1.

In order to approximate the geometry, the linear mapping defined in (1) is employed to associate with the straight-\/sided triangles while the nonlinear mapping defined in (5) is employed to associate with the curved triangles. Those mapping will be inherited from Geometric\+Curved\+T\+Element\+Shape$<$2$>$ and can be accessible in {\ttfamily C1\+Curved\+Elemet$<$$>$} by

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\ttfamily C1\+Curved\+Element$<$$>$\+::shape(s,x)}, \end{center}    \\\cline{1-1}
\end{longtabu}
\end{center} 

Note that, unlike other elements in {\ttfamily oomph-\/lib}, the geometric shape functions in {\ttfamily C1\+Curved\+Element} rather computed the global position of the local coordinate $ s. $

Regarding shape functions defined on the {\ttfamily C1\+Curved\+Element}, different definitions of shape functions are defined in order to associate with both straight and curved triangular elements. On the set of straight-\/sided triangles, the Bell shape functions will be employed to approximate the unknowns. When the curve-\/sided triangles are concerned, the $ C^1 $-\/curved triangular shape functions defined in subsection 1.\+1.\+2 will be used to approximate the unknowns. Hence, the {\ttfamily C1\+Curved\+Element} is a $ C^1 $-\/triangular element carries two families of $ C^1 $-\/shape functions defined on both straight and curved triangles.

The shape functions of both Bell and $ C^1 $-\/curved triangular elements can be accessible via {\ttfamily Bell\+Element\+Shape\+::\+Bshape(...)} and {\ttfamily C1\+Curved\+Element\+Shape\+::\+Cshape(...)}, respectively. These functions will compute the shape functions at local coordinate $ s. $

As the global coordinates are required in the derivation of the shape functions of the {\ttfamily Bell\+Element\+Shape$<$$>$}, the physical coordinates of vertices have to be passed as an argument when shape functions are overloaded. The interface of the Bell shape functions obtained from {\ttfamily Bell\+Element\+Shape$<$$>$} at local coordinate $ s $ is {\ttfamily Bell\+Element\+Shape$<$$>$\+::\+Bshape(s,psi,position)}. Similarly, the first and the second-\/order derivatives can be obtained at local coordinate $ s $ as {\ttfamily Bell\+Element\+Shape$<$$>$\+::d\+Bshape(s,psi,dpsi,position)} and {\ttfamily Bell\+Element\+Shape$<$$>$\+::d2\+Bshape(s,psi,dpsi,d2psi,position)}, respectively. The vector {\ttfamily position} is the collection of coordinates on vertices of straight-\/edged triangles.

Now, to obtained the basis functions that employed to approximate variables on the straight-\/sided triangles in {\ttfamily C1\+Curved\+Element}, they can be accessible via

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\ttfamily C1\+Curved\+Element$<$$>$\+::basis\+\_\+straight(s,psi)}, \end{center}    \\\cline{1-1}
\end{longtabu}
\end{center} 

Furthermore, the first-\/ and second-\/order derivatives of the Bell shape functions in {\ttfamily C1\+Curved\+Element$<$$>$} can be accessible via

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\ttfamily C1\+Curved\+Element$<$$>$\+::dbasis\+\_\+straight(s,psi,dpsi)}, \end{center}    \\\cline{1-1}
\end{longtabu}
\end{center} 

and

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\ttfamily C1\+Curved\+Element$<$$>$\+::d2basis\+\_\+straight(s,psi,dpsi,d2psi)}, \end{center}    \\\cline{1-1}
\end{longtabu}
\end{center}  respectively.

Unlike the Bell shape functions, the $ C^1 $-\/curved shape functions has a usual interface as no global coordinate is required. They can be overloaded from {\ttfamily C1\+Curved\+Element\+Shape$<$$>$\+::\+Cshape(s,psi)} while their first-\/ and second-\/order derivatives can be obtained from {\ttfamily C1\+Curved\+Element\+Shape$<$$>$\+::d\+Cshape(s,psi,dpsi)} and {\ttfamily C1\+Curved\+Element\+Shape$<$$>$\+::d2\+Cshape(s,psi,dpsi,d2psi)}, respectively.

Now, to obtained the basis functions that employed to approximate variables on the curved triangles in {\ttfamily C1\+Curved\+Element}, they can be accessible via

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\ttfamily C1\+Curved\+Element$<$$>$\+::basis\+\_\+curve(s,psi)}, \end{center}    \\\cline{1-1}
\end{longtabu}
\end{center} 

Furthermore, the first-\/ and second-\/order derivatives of the $ C^1 $-\/curved shape functions in {\ttfamily C1\+Curved\+Element} can be accessible via

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\ttfamily C1\+Curved\+Element$<$$>$\+::dbasis\+\_\+curve(s,psi,dpsi)}, \end{center}    \\\cline{1-1}
\end{longtabu}
\end{center} 

and

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\begin{center} {\ttfamily C1\+Curved\+Element$<$$>$\+::d2basis\+\_\+curve(s,psi,dpsi,d2psi)}, \end{center}    \\\cline{1-1}
\end{longtabu}
\end{center}  respectively.

Regarding the association, which associated the values of degrees of freedom between the reference and physical curved triangles, mentioned in (9), it can be inherited from the functions {\ttfamily C1\+Curved\+Element\+Shape$<$2$>$\+::set\+\_\+of\+\_\+value(\+D,\+B,node\+\_\+position,bd\+\_\+element,bd\+\_\+node\+\_\+position,x)} and the following are required as its arguments


\begin{DoxyItemize}
\item coordinates of three vertices of a curved triangle passed as {\ttfamily node\+\_\+position},
\item coordinates of the vertices of a curved triangle that situate on a curved boundary passed as {\ttfamily bd\+\_\+node\+\_\+position},
\item coordinates of the vertices of a curved triangle that is off-\/boundary passed as {\ttfamily x}.
\end{DoxyItemize}

Note that the matrices $ D, B $ denote the submatrices of value transformation described in \href{http://www.sciencedirect.com/science?_ob=MiamiImageURL&_cid=271868&_user=6991156&_pii=004578259390111A&_check=y&_origin=article&_zone=toolbar&_coverDate=31-Jan-1993&view=c&originContentFamily=serial&wchp=dGLzVlV-zSkzk&md5=d038a1aec18c25806e39c26187c2a200&pid=1-s2.0-004578259390111A-main.pdf}{\texttt{ a publication of M.\+Bernadou (1993)}} .

\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_reslt}{}\doxysection{Solving the Biharmonic equation with the C1\+Curved\+Element}\label{index_reslt}
The sections below provide an example of solving the fourth-\/order problem using {\ttfamily C1\+Curved\+Element}. The fourth-\/order problem consider here is the same Biharmonic equation described in \href{../../../c1_element/bell_element/html/index.html}{\texttt{ another tutorial}} which is expressed as follow\+:

\[ \frac{\partial^4 u}{\partial x^4} + 2\frac{\partial^4 u}{\partial x^2\partial y^2} + \frac{\partial^4 u}{\partial y^4} = 0, \ \ \ (10) \]

with the exact solution $ u(x,y) = \cos(x)e^y.$ However, in this document, the problem is implemented in the quarter of the unit circular domain $ \Omega = \{(x,y) | x,y \in [0,1] , x^2+y^2 = 1\} $ which is a curvilinear boundary domain rather than a straight-\/sided boundary domain. Similarly, we also apply Dirichlet boundary conditions such that the exact solution is satisfied. Also, the conditions that have to be specified on the boundaries have to correspond with the degrees of freedom defined for the {\ttfamily C1\+Curved\+Element} in the previous section.

Since 36 values of degrees of freedom defined on the reference triangle depend on the 21 values of degrees of freedom defined on the physical curved triangle, those 21 degrees of freedom on the physical curved triangle have to be imposed. These degrees of freedom constitute of 6 degrees of freedom at 3 vertex nodes and the values of degrees of freedom at 3 internal nodes. The 6 degrees of freedom defined on vertices incorporate the value of unknown field, the first derivatives with respect to the first and second coordinates, and the second derivatives with respect to the first, second, and mix derivatives have to be determined at the boundaries. The boundary specifications can be determined the same as described in \href{../../../c1_element/bell_element/html/index.html}{\texttt{ a two-\/dimensional Biharmonic problem with the Bell triangular finite element tutorial}}.

Here are two tables comparing the performance with the associated computational time between the {\ttfamily Bell\+Element} and the {\ttfamily C1\+Curved\+Element}. The accuracy of the solutions will base on the $ L^2 $-\/norm error which is mathematically described as

\[ |u_{exact}-u_{FE}| = \left( \int_{\Omega} | u_{exact} - u_{FE}|^2 d\Omega \right)^{1/2}, \] where $ u_{exact},u_{FE} $ denote the exact and the finite element solutions, respectively.

Table 1\+: $L^2$-\/norm error of the solution obtained from the Biharmonic implementations using the Bell\+Element with various numbers of elements.

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
Number of elements  &Number of dofs  &Error  &Time (sec)   \\\cline{1-4}
29  &48  &$ 5.67891 \times 10^{-4} $  &0.\+23   \\\cline{1-4}
84  &198  &$ 1.77260 \times 10^{-4} $  &0.\+66   \\\cline{1-4}
250  &636  &$ 9.42737 \times 10^{-5} $  &2.\+02   \\\cline{1-4}
2034  &5838  &$ 3.49306 \times 10^{-5} $  &17.\+48   \\\cline{1-4}
4833  &14022  &$ 5.12128 \times 10^{-6} $  &43.\+94     \\\cline{1-4}
\end{longtabu}
~\newline
 \end{center} 

Table 2\+: $L^2$-\/norm error of the solution obtained from the Biharmonic implementations using the C1\+Curved\+Element with various numbers of elements.

\begin{center} \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
Number of elements  &Number of dofs  &Error  &Time (sec)   \\\cline{1-4}
29  &63  &$ 1.41802 \times 10^{-4} $  &5.\+73   \\\cline{1-4}
84  &228  &$ 3.70896 \times 10^{-5} $  &16.\+07   \\\cline{1-4}
250  &696  &$ 9.52325 \times 10^{-6} $  &54.\+92   \\\cline{1-4}
2034  &5958  &$ 1.0478 \times 10^{-8} $  &436.\+17   \\\cline{1-4}
4833  &14262  &$ 3.6392 \times 10^{-10} $  &1749.\+63     \\\cline{1-4}
\end{longtabu}
~\newline
 \end{center} 

Tables 1 and 2 show that the computational time for the {\ttfamily C1\+Curved\+Element} is obviously very expensive compared to that of the {\ttfamily Bell\+Element} when the same number of element is concerned. However, for the same number of elements, accuracies obtained from the curved elements are superior to those obtained from the straight elements.

Furthermore, if the same error is considered, say $O(10^{-5})$, it can be seen from Tables 1 and 2 that the number of the {\ttfamily Bell\+Element} has to be 2034 to obtain such an accuracy. On the other hands, the number of the {\ttfamily C1\+Curved\+Element} needed to obtain such accuracy is 84 which is a lot less. Also, the computational time to obtained the accuracy of order $O(10^{-5})$ for the {\ttfamily Bell\+Element} is 17.\+48 and for the {\ttfamily C1\+Curved\+Element} is 16.\+07 which is smaller.

In order to compare the convergence rate between the {\ttfamily Bell\+Element} and the {\ttfamily C1\+Curved\+Element}, Fig. 1.\+5 illustrates the comparison between the $L^2$-\/norm error and the element size obtained from those elements. It can be seen that the {\ttfamily C1\+Curved\+Element} converges faster and, also, gives smaller error than the {\ttfamily Bell\+Element}.

When performing the log-\/plot between the $L^2$-\/norm error and the element size, Fig. 1.\+6 depicts that the convergence rate of the {\ttfamily C1\+Curved\+Element} are greater than the {\ttfamily Bell\+Element} as its slope is greater. The obtained rate of convergence for the {\ttfamily C1\+Curved\+Element} and {\ttfamily the} Bell\+Element is quintic and quadratic, respectively.

It is noteworthy that using the {\ttfamily Bell\+Element} to solve the $ C^1 $-\/problem with a curved boundary domain decreases its rate of convergence from its potential when solving an exact representation domain (see \href{../../../c1_element/bell_element/html/index.html}{\texttt{ another tutorial}}). This limitation of convergence rate in the {\ttfamily Bell\+Element} is due to the representation of the curved boundaries with straight-\/edge elements.

 
\begin{DoxyImage}
\includegraphics[width=0.65\textwidth]{Rate_of_convergence_compare}
\doxyfigcaption{The comparison of the convergence rate between the Bell and the C1-\/curved triangular elements. }
\end{DoxyImage}


 
\begin{DoxyImage}
\includegraphics[width=0.65\textwidth]{Rate_of_convergence_compare_logplot}
\doxyfigcaption{The comparison of the convergence rate between the Bell and the C1-\/curved triangular elements. }
\end{DoxyImage}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_impl}{}\doxysection{Implementation in oomph-\/lib}\label{index_impl}
In order to solve the Biharmonic equation with {\ttfamily oomph-\/lib}, the Global parameters and functions can be defined the same as in \href{../../../c1_element/bell_element/html/index.html}{\texttt{ another Biharmonic tutorial}}. However, we use the {\ttfamily Biharmonic\+Curved\+Element$<$2,2$>$} to solve the Biharmonic equation when the curvilinear boundary is concerned. This can be modified in the driver code.

In sequels, we will discuss only functions that defined differently from solving the Biharmonic equation with the {\ttfamily Bell\+Element}.

\DoxyHorRuler{0}
\hypertarget{index_problem}{}\doxysubsection{The problem class}\label{index_problem}
The problem class has five member functions, illustrated as follows\+:


\begin{DoxyItemize}
\item The problem constructor
\item {\ttfamily action\+\_\+before\+\_\+newton\+\_\+solve()} \+: Update the problem specifications before solve. Boundary conditions maybe set here.
\item {\ttfamily action\+\_\+after\+\_\+newton\+\_\+solve()} \+: Update the problem specifications after solve.
\item {\ttfamily doc\+\_\+solution()} \+: Pass the number of the case considered, so that output files can be distinguished.
\item {\ttfamily nodal\+\_\+permutation()} \+: Perform a nodal permutation in a curved element.
\end{DoxyItemize} 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//==start\_of\_problem\_class============================================}}
\DoxyCodeLine{\textcolor{comment}{/// 2D Biharmonic problem.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keywordtype}{unsigned} DIM, \textcolor{keywordtype}{unsigned} NNODE\_1D> }
\DoxyCodeLine{\textcolor{keyword}{class }\mbox{\hyperlink{classMyBiharmonicProblem}{MyBiharmonicProblem}} : \textcolor{keyword}{public} Problem}
\DoxyCodeLine{\{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Constructor: Pass number of elements and pointer to source function}}
\DoxyCodeLine{\textcolor{comment}{} \mbox{\hyperlink{classMyBiharmonicProblem_ab894abf54210a71c3b4e00e1b30e380e}{MyBiharmonicProblem}}(\textcolor{keyword}{typename} MyBiharmonicEquations<DIM,NNODE\_1D>::SourceFctPt source\_fct\_pt,}
\DoxyCodeLine{                          \textcolor{keyword}{typename} MyBiharmonicEquations<DIM,NNODE\_1D>::ExactSolnPt exact\_pt,}
\DoxyCodeLine{                          \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& node\_file\_name,}
\DoxyCodeLine{                          \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& element\_file\_name,}
\DoxyCodeLine{                          \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& poly\_file\_name);}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Destructor (empty)}}
\DoxyCodeLine{\textcolor{comment}{} \mbox{\hyperlink{classMyBiharmonicProblem_ad6d1bdce803ec5fd13bf6b0e3b1f3ca9}{\string~MyBiharmonicProblem}}()}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{keyword}{delete} mesh\_pt();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Update the problem specs before solve: (Re)set boundary conditions}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classMyBiharmonicProblem_ae9a9d6db2c84c3cc12138558b60d676d}{actions\_before\_newton\_solve}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Update the problem specs after solve (empty)}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classMyBiharmonicProblem_a0600c4a7dff6f362b6171c66e07b594c}{actions\_after\_newton\_solve}}()\{\}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// \(\backslash\)short Doc the solution, pass the number of the case considered,}}
\DoxyCodeLine{\textcolor{comment}{ /// so that output files can be distinguished.}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classMyBiharmonicProblem_aa1c9d6b8298b2b78f5df9343349ecd70}{doc\_solution}}(DocInfo\& doc\_info);}
\DoxyCodeLine{ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Perform a nodal permutation in curved elements}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{classMyBiharmonicProblem_a40167119fb35b4926185b7adc23a6358}{nodal\_permutation}}();}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Pointer to source function}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keyword}{typename} MyBiharmonicEquations<DIM,NNODE\_1D>::SourceFctPt \mbox{\hyperlink{classMyBiharmonicProblem_a1ba6c64955d32e319db7a7de7807458a}{Source\_fct\_pt}};}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Pointer to the exact solution}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keyword}{typename} MyBiharmonicEquations<DIM,NNODE\_1D>::ExactSolnPt \mbox{\hyperlink{classMyBiharmonicProblem_a9f681412ab2041bf3ddcd668ee816362}{Exact\_soln\_pt}};}
\DoxyCodeLine{}
\DoxyCodeLine{\}; \textcolor{comment}{// end of problem class}}

\end{DoxyCodeInclude}


Only function {\ttfamily Problem\+::nodal\+\_\+permutation()} is newly defined to associate with a curvilinear boundary. This function is employed to swap nodes so that they are correspond with the defined shape functions when using the {\ttfamily C1\+Curved\+Element}.

\DoxyHorRuler{0}
\hypertarget{index_permute}{}\doxysubsection{The nodal\+\_\+permutation() function}\label{index_permute}
Regarding the mapping associated between the reference coordinates and the physical coordinates defined on the curved triangle, it can be seen that we defined the side $ \hat{\bf{a}}_1\hat{\bf{a}}_2$ of the reference to associate with the curved boundary. Also, in the definition defined in (2), the vertex node $ \bf{a}_1 $ was defined to be correspond with the position where $ s $ is minimum on each arc of the curved boundary $ \Gamma $ and the node $ \bf{a}_2 $ was correspond with the position where the maximum $ s $ is obtained. Furthermore, the node $ \bf{a}_3 $ was defined to be the off-\/boundary node of a curved triangle.

However, a discretisation of the curvilinear domain by triangles can give a triangulation where the node ordering in a triangular element incompatible with the described definitions. As illustrated in the following figure, three cases of node ordering can happen.

 
\begin{DoxyImage}
\includegraphics[width=0.45\textwidth]{node_ordering}
\doxyfigcaption{The graphical description of node ordering. }
\end{DoxyImage}


It can be seen from the definition in (2) and the figure that $ F_{K}(\bf{\hat{a}}_{i}) = \bf{p}_{i}$ rather than $ \bf{a}_i. $ Therefore, in order to derive our $ C^1$-\/curved triangular shape functions, a re-\/position of nodes has to be performed. The function {\ttfamily nodal\+\_\+permutation(...)} will provide a nodal permutation where the nodal pointers will be swapped so that they are associated with the shape functions defined at that node. The nodal pointers will be permuted to correspond with the conditions required in (2).

Here are codes for a nodal permutation.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//===start\_of\_nodal\_permutation===========================================}}
\DoxyCodeLine{\textcolor{comment}{/// \(\backslash\)short Update the nodal permutation in curved elements: (Re)assign }}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{/// coordinates so that the first and the second nodes are associated}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{/// with the lower and upper position on a boundary, respectively. }}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{/// The third node is off-\/boundary node.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keywordtype}{unsigned} DIM, \textcolor{keywordtype}{unsigned} NNODE\_1D>}
\DoxyCodeLine{ \textcolor{keywordtype}{void} \mbox{\hyperlink{classMyBiharmonicProblem_a40167119fb35b4926185b7adc23a6358}{MyBiharmonicProblem<ELEMENT,DIM,NNODE\_1D>::nodal\_permutation}}()}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   DenseMatrix<double> position(3,2);}
\DoxyCodeLine{   DenseMatrix<double> bd\_position(20,2);}
\DoxyCodeLine{   Vector<double> x(2);}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} bd\_element;}
\DoxyCodeLine{  }
\DoxyCodeLine{   \textcolor{comment}{// Get number of elements in the mesh}}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} n\_element = mesh\_pt()-\/>nelement();}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{// Start a classification of nodes}}
\DoxyCodeLine{   \textcolor{comment}{// Loop over elements to get coordinates of nodes on a boundary}}
\DoxyCodeLine{   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} n=0;n<n\_element;n++)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     \textcolor{comment}{// Upcast from GeneralisedElement to the present element}}
\DoxyCodeLine{     ELEMENT *elem\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(mesh\_pt()-\/>element\_pt(n));}
\DoxyCodeLine{     \textcolor{comment}{// we need just three vertices}}
\DoxyCodeLine{     \textcolor{keywordtype}{unsigned} n\_node = 3;}
\DoxyCodeLine{   }
\DoxyCodeLine{     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} l=0;l<n\_node;l++)}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} j=0;j<DIM;j++)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         position(l,j) = elem\_pt-\/>node\_pt(l)-\/>x(j);}
\DoxyCodeLine{        \}}
\DoxyCodeLine{      \}}
\DoxyCodeLine{    }
\DoxyCodeLine{     \textcolor{keywordtype}{int} count=0;}
\DoxyCodeLine{     }
\DoxyCodeLine{     \textcolor{comment}{// check whether this element is on boundary or not}}
\DoxyCodeLine{     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_node;i++)}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       \textcolor{comment}{// check whether this node is on 1st boundary (curve boundary)}}
\DoxyCodeLine{       \textcolor{keywordtype}{bool} bd\_node1 = elem\_pt-\/>node\_pt(i)-\/>is\_on\_boundary(1);}
\DoxyCodeLine{       \textcolor{keywordflow}{if}(bd\_node1==1)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         count += 1;}
\DoxyCodeLine{         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} j=0;j<DIM;j++)}
\DoxyCodeLine{          \{}
\DoxyCodeLine{           bd\_position(count-\/1,j) = elem\_pt-\/>node\_pt(i)-\/>x(j);}
\DoxyCodeLine{          \}}
\DoxyCodeLine{        \}}
\DoxyCodeLine{       \textcolor{keywordflow}{else}}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} j=0;j<DIM;j++)}
\DoxyCodeLine{          \{}
\DoxyCodeLine{           x[j] = elem\_pt-\/>node\_pt(i)-\/>x(j);}
\DoxyCodeLine{          \}}
\DoxyCodeLine{        \}}
\DoxyCodeLine{      \}}
\DoxyCodeLine{     }
\DoxyCodeLine{     \textcolor{keywordflow}{if}(count == 2) \textcolor{comment}{// this case is a boundary element}}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       bd\_element = 1;}
\DoxyCodeLine{      \}          }
\DoxyCodeLine{     \textcolor{keywordflow}{else}}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       bd\_element = 0;           }
\DoxyCodeLine{      \} \textcolor{comment}{// end\_of\_classification}}
\DoxyCodeLine{     \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{     /// Permutation just for the curved elements}}
\DoxyCodeLine{\textcolor{comment}{}     \textcolor{keywordflow}{if}(bd\_element==1)}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       \textcolor{keywordtype}{unsigned} n\_position\_type = 6;}
\DoxyCodeLine{       DenseMatrix<double> nodal\_value(3,n\_position\_type,0.0);}
\DoxyCodeLine{       \textcolor{keywordtype}{double} angle\_1 = atan(bd\_position(0,1)/bd\_position(0,0));}
\DoxyCodeLine{       \textcolor{keywordtype}{double} angle\_2 = atan(bd\_position(1,1)/bd\_position(1,0));}
\DoxyCodeLine{       }
\DoxyCodeLine{       \textcolor{keywordflow}{if}(angle\_1 > angle\_2)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         \textcolor{keywordflow}{if}(position(2,0)==x[0] \&\& position(2,1)==x[1])                                  }
\DoxyCodeLine{          \{}
\DoxyCodeLine{           Node* first\_pt = elem\_pt-\/>node\_pt(0);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(0) = elem\_pt-\/>node\_pt(1);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(1) = first\_pt;}
\DoxyCodeLine{           }
\DoxyCodeLine{           Node* second\_pt = elem\_pt-\/>node\_pt(3);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(3) = elem\_pt-\/>node\_pt(4);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(5) = second\_pt;                         }
\DoxyCodeLine{          \}}
\DoxyCodeLine{         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(position(1,0)==bd\_position(0,0) \&\& position(1,1)==bd\_position(0,1))                                  }
\DoxyCodeLine{          \{}
\DoxyCodeLine{           Node* first\_pt = elem\_pt-\/>node\_pt(2);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(0) = elem\_pt-\/>node\_pt(2);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(2) = first\_pt;}
\DoxyCodeLine{           }
\DoxyCodeLine{           Node* second\_pt = elem\_pt-\/>node\_pt(3);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(3) = elem\_pt-\/>node\_pt(5);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(5) = second\_pt;                         }
\DoxyCodeLine{          \}}
\DoxyCodeLine{         \textcolor{keywordflow}{else} }
\DoxyCodeLine{          \{ }
\DoxyCodeLine{           Node* first\_pt = elem\_pt-\/>node\_pt(0);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(0) = elem\_pt-\/>node\_pt(2);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(2) = elem\_pt-\/>node\_pt(1);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(1) = first\_pt;}
\DoxyCodeLine{           }
\DoxyCodeLine{           Node* second\_pt = elem\_pt-\/>node\_pt(3);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(3) = elem\_pt-\/>node\_pt(5);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(5) = elem\_pt-\/>node\_pt(4);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(4) = second\_pt;}
\DoxyCodeLine{          \}}
\DoxyCodeLine{        \}}
\DoxyCodeLine{       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(angle\_1 < angle\_2)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         \textcolor{keywordflow}{if}(position(0,0)==bd\_position(0,0) \&\& position(0,1)==bd\_position(0,1))}
\DoxyCodeLine{          \{}
\DoxyCodeLine{           \textcolor{keywordflow}{if}(position(2,0)==bd\_position(1,0) \&\& position(2,1)==bd\_position(1,1))                                  }
\DoxyCodeLine{            \{}
\DoxyCodeLine{             Node* first\_pt = elem\_pt-\/>node\_pt(1);}
\DoxyCodeLine{             elem\_pt-\/>node\_pt(1) = elem\_pt-\/>node\_pt(2);}
\DoxyCodeLine{             elem\_pt-\/>node\_pt(2) = first\_pt;}
\DoxyCodeLine{             }
\DoxyCodeLine{             Node* second\_pt = elem\_pt-\/>node\_pt(4);}
\DoxyCodeLine{             elem\_pt-\/>node\_pt(4) = elem\_pt-\/>node\_pt(5);}
\DoxyCodeLine{             elem\_pt-\/>node\_pt(5) = second\_pt;                         }
\DoxyCodeLine{            \}}
\DoxyCodeLine{          \}}
\DoxyCodeLine{         \textcolor{keywordflow}{else} }
\DoxyCodeLine{          \{}
\DoxyCodeLine{           }
\DoxyCodeLine{           Node* first\_pt = elem\_pt-\/>node\_pt(0);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(0) = elem\_pt-\/>node\_pt(1);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(1) = elem\_pt-\/>node\_pt(2);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(2) = first\_pt;}
\DoxyCodeLine{           }
\DoxyCodeLine{           Node* second\_pt = elem\_pt-\/>node\_pt(3);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(3) = elem\_pt-\/>node\_pt(4);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(4) = elem\_pt-\/>node\_pt(5);}
\DoxyCodeLine{           elem\_pt-\/>node\_pt(5) = second\_pt;}
\DoxyCodeLine{          \}   }
\DoxyCodeLine{        \}}
\DoxyCodeLine{      \}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}  \textcolor{comment}{// end of permutation}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
\hypertarget{index_constructor}{}\doxysubsection{The Problem constructor}\label{index_constructor}
The problem constructor starts by overloading the function {\ttfamily Problem\+::mesh\+\_\+pt()} and set to the specific mesh used in this problem. In this tutorial, we implement the problem with a 2D unstructured mesh which is externally created by {\ttfamily Triangle}. The generated output will be used to build the {\ttfamily oomph-\/lib} mesh. The reader may refer to \href{../../../meshes/mesh_from_inline_triangle/html/index.html}{\texttt{ another tutorial}} to create an unstructured triangular mesh internally.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=====start\_of\_constructor===============================================}}
\DoxyCodeLine{\textcolor{comment}{/// \(\backslash\)short Constructor for 2D Biharmonic problem.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{/// Discretise the 2D domain with n\_element elements of type ELEMENT.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{/// Specify function pointer to source function. }}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keywordtype}{unsigned} DIM, \textcolor{keywordtype}{unsigned} NNODE\_1D>}
\DoxyCodeLine{\mbox{\hyperlink{classMyBiharmonicProblem_ab894abf54210a71c3b4e00e1b30e380e}{MyBiharmonicProblem<ELEMENT,DIM,NNODE\_1D>::MyBiharmonicProblem}}}
\DoxyCodeLine{(\textcolor{keyword}{typename} MyBiharmonicEquations<DIM,NNODE\_1D>::SourceFctPt source\_fct\_pt,}
\DoxyCodeLine{ \textcolor{keyword}{typename} MyBiharmonicEquations<DIM,NNODE\_1D>::ExactSolnPt exact\_pt,}
\DoxyCodeLine{ \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& node\_file\_name,}
\DoxyCodeLine{ \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& element\_file\_name,}
\DoxyCodeLine{ \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& poly\_file\_name) : }
\DoxyCodeLine{ Source\_fct\_pt(source\_fct\_pt), Exact\_soln\_pt(exact\_pt)}
\DoxyCodeLine{\{ }
\DoxyCodeLine{ Problem::mesh\_pt() = \textcolor{keyword}{new} TriangleMesh<ELEMENT>(node\_file\_name,element\_file\_name,poly\_file\_name);}

\end{DoxyCodeInclude}


Next, the boundary conditions of the problem will be taken care. Since the Dirichlet boundary conditions are applied in this problem, we pin the nodal values and their first-\/order derivatives on all boundaries. In this study, we also set degrees of freedom associated with the second-\/order derivatives to be pinned in order to reduce the number of degrees of freedom in the problem.

Note that there are three boundaries on the quarter of the unit circular domain. The boundary identities are labelled anticlockwise where the first boundary is associated with the side $ (x,y) = (0,y). $

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{ \textcolor{comment}{// start\_of\_boundary\_conditions}}
\DoxyCodeLine{ \textcolor{comment}{// assign conditions at boundary 0}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} i=0;}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned}  n\_node1 = mesh\_pt()-\/>nboundary\_node(i);}
\DoxyCodeLine{ cout  << \textcolor{stringliteral}{"nnode on b0 = "} << n\_node1 << endl;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n=0;n<n\_node1;n++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(0); }
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(1); }
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(2);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(3);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(4);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(5);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{comment}{// assign conditions at boundary 1}}
\DoxyCodeLine{ i=1;}
\DoxyCodeLine{ n\_node1 = mesh\_pt()-\/>nboundary\_node(i);}
\DoxyCodeLine{ cout  << \textcolor{stringliteral}{"nnode on b1 = "} << n\_node1 << endl;}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n=0;n<n\_node1;n++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(0); }
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(1); }
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(2);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(3);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(4);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(5);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{comment}{// assign conditions at boundary 2}}
\DoxyCodeLine{ i=2;}
\DoxyCodeLine{ n\_node1 = mesh\_pt()-\/>nboundary\_node(2);}
\DoxyCodeLine{ cout  << \textcolor{stringliteral}{"nnode on b2 = "} << n\_node1 << endl;}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n=0;n<n\_node1;n++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(0);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(1); }
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(2);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(3);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(4);}
\DoxyCodeLine{   mesh\_pt()-\/>boundary\_node\_pt(i,n)-\/>pin(5);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// end of boundary conditions}}

\end{DoxyCodeInclude}


According to the {\ttfamily C1\+Curved\+Element}, there are two different types of triangular elements which contain different numbers of nodes in an element. The straight-\/sided triangular elements constitute of three vertex nodes with out any interior node while the curved elements constitute of three vertices and three interior nodes. Since there are overall six nodes in {\ttfamily C1\+Curved\+Element}, all three interior nodes have to be pinned when the straight-\/sided elements are concerned.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{   \textcolor{comment}{// pinned the unnecessary nodes in the straight-\/sided elements}}

\end{DoxyCodeInclude}


We then loop over the elements and set the pointers to the physical parameters, the function pointer to the source function which is the function on the right-\/hand side of the Biharmonic equation, and the pointer to the exact solutions.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{ \textcolor{comment}{// Loop over elements and set pointers to Physical parameters}}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_element;i++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{comment}{// Upcast from GeneralisedElement to the present element}}
\DoxyCodeLine{   ELEMENT *elem\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(mesh\_pt()-\/>element\_pt(i));}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{//Set the source function pointer and all physical variables}}
\DoxyCodeLine{   elem\_pt-\/>source\_fct\_pt() = Source\_fct\_pt;}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{//Set the exact solution pointer}}
\DoxyCodeLine{   elem\_pt-\/>exact\_pt() = Exact\_soln\_pt;}
\DoxyCodeLine{  \} \textcolor{comment}{// end of pointers set up}}

\end{DoxyCodeInclude}


Before we can implement a problem in a curved element, a nodal permutation is needed in order to satisfy (2). That is the coordinates of the first and the second nodes have to be associated with the lower and upper position on a boundary, respectively. Furthermore, the third node should be off-\/boundary.

 
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{ \textcolor{comment}{/// Perform a nodal permutation in curved elements}}
\DoxyCodeLine{ \textcolor{keywordtype}{void} nodal\_permutation();}

\end{DoxyCodeInclude}


We finish the constructor by assigning the equation numbering scheme.  
\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{ \textcolor{comment}{// Setup equation numbering scheme}}
\DoxyCodeLine{ assign\_eqn\_numbers();}
\DoxyCodeLine{\} \textcolor{comment}{// end of constructor}}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
\hypertarget{index_sources}{}\doxysection{Source files for this tutorial}\label{index_sources}

\begin{DoxyItemize}
\item The source files for this tutorial are located in the directory\+:~\newline
~\newline
\begin{center} \href{../../../../demo_drivers/biharmonic/unstructured_2d_biharmonic/}{\texttt{ demo\+\_\+drivers/biharmonic/unstructured\+\_\+2d\+\_\+biharmonic/ }} \end{center} ~\newline

\item The driver code for the 2D Biharmonic problem with the {\ttfamily Bell\+Element} is\+: ~\newline
~\newline
\begin{center} \href{
../../../../
demo_drivers/biharmonic/unstructured_2d_biharmonic/unstructured_2d_biharmonic_bellelement.cc
}{\texttt{ demo\+\_\+drivers/biharmonic/unstructured\+\_\+2d\+\_\+biharmonic/unstructured\+\_\+2d\+\_\+biharmonic\+\_\+bellelement.\+cc }} \end{center} 
\item The driver code for the 2D Biharmonic problem with the {\ttfamily C1\+Curved\+Element} is\+: ~\newline
~\newline
\begin{center} \href{
../../../../
demo_drivers/biharmonic/unstructured_2d_biharmonic/unstructured_2d_biharmonic_curvedelement.cc
}{\texttt{ demo\+\_\+drivers/biharmonic/unstructured\+\_\+2d\+\_\+biharmonic/unstructured\+\_\+2d\+\_\+biharmonic\+\_\+curvedelement.\+cc }} \end{center} 
\end{DoxyItemize}\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{P\+D\+F file}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}
