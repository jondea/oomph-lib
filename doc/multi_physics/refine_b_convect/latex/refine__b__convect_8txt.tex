\hypertarget{refine__b__convect_8txt}{}\doxysection{refine\+\_\+b\+\_\+convect.\+txt File Reference}
\label{refine__b__convect_8txt}\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}} = \char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$non-\/refineable version of the \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}}$<$/a $>$ we create the refineable \mbox{\hyperlink{refine__b__convect_8txt_a76374ef3c6061f3c4786702a50a907ed}{element}} \textbackslash{}c Refineable\+Buoyant\+Q\+Crouzeix\+Raviart\+Element by multiple inheritance from the \textbackslash{}c Refineable\+Q\+Crouzeix\+Raviart\+Element \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} \textbackslash{}c Refineable\+Q\+Advection\+Diffusion\+Element\+:\textbackslash{}dontinclude boussinesq\+\_\+elements.\+h \textbackslash{}skipline start\+\_\+element\+\_\+class \textbackslash{}until \{ Many of the additional member \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required in the combined multi-\/physics \mbox{\hyperlink{refine__b__convect_8txt_a76374ef3c6061f3c4786702a50a907ed}{element}} are identical to those in the non-\/refineable version\+:-\/ the access function to(the pointer to the) Rayleigh number, \textbackslash{}c ra\+\_\+pt(), -\/ the output \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}}, \textbackslash{}c output(...), -\/ the function \textbackslash{}c required\+\_\+n\+\_\+value(...) which specifies the number of values required at each node, -\/ the function \textbackslash{}c u\+\_\+index\+\_\+adv\+\_\+diff(...) which specifies the index at which the temperature is stored within the elements\textquotesingle{} \textbackslash{}c Nodes, -\/ the function \textbackslash{}c get\+\_\+wind\+\_\+adv\+\_\+diff(...) which specifies the \char`\"{}wind\char`\"{} in the advection diffusion equations in terms of the Navier-\/Stokes velocities, -\/ the function \textbackslash{}c get\+\_\+body\+\_\+force\+\_\+nst(...) which specifies the body force in the Navier-\/Stokes equations in terms of the temperature. -\/ the two \char`\"{}fill in\char`\"{} function are implemented as in the non-\/refineable element. The function \textbackslash{}c fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+residuals(...) concatenates the contributions from the two underlying elements
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity and linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation and re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$ HR $>$$<$ HR $>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} (empty) destructor
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$ HR $>$$<$ HR $>$ section problem The problem class The problem class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this problem dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} (Since the domain is enclosed the pressure is only determined up to an arbitrary constant.) The pressure degree of freedom that was pinned before the adaptation may have disappeared during the adaptation
\item 
the function c \mbox{\hyperlink{refine__b__convect_8txt_afb1ff8cf837bf38120135bebec006cd4}{fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+jacobian}} (...) computes the coupled elemental Jacobian matrix by finite-\/differencing. . We shall only discuss those additional \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} that are required in the refineable version of the combined multi-\/physics element. Both const ituent elements are derived from the \textbackslash{}c Element\+With\+Z2\+Error\+Estimator base class \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} each \mbox{\hyperlink{refine__b__convect_8txt_a76374ef3c6061f3c4786702a50a907ed}{element}} provides its own definition of the \char`\"{}Z2-\/flux\char`\"{} that is \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} by the Z2 error estimator to compute elemental error estimates. We must decide on a single error estimator for the combined element. We could base the error estimation entirely on the fluid flow
\item 
a choice that would be appropriate for problems with thin thermal boundary layers The different error estimates can all be specified by user defined \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} that combine the vector of compound flux error estimates into a single number For the function code double \mbox{\hyperlink{refine__b__convect_8txt_a208f161875a2b8b1c7302a9d2b409f70}{navier\+\_\+stokes\+\_\+flux\+\_\+error}} (const Vector$<$ double $>$ \&errors)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
mainpage Refineable Boussinesq \mbox{\hyperlink{refine__b__convect_8txt_a45c28d7c95e6c5c1c6023e8af810b0cb}{Convection}}
\item 
nard \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The lower wall is maintained at a temperature f \mbox{\hyperlink{refine__b__convect_8txt_a4a045af2547c93c6b9801986cc145179}{theta\+\_\+}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous \mbox{\hyperlink{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}{example}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation \mbox{\hyperlink{refine__b__convect_8txt_a00f33da8657b7c8459f10df3ab2c3272}{Therefore}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady \mbox{\hyperlink{refine__b__convect_8txt_a11778e96d5cb3a43210ca8e38083780f}{problem}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady state of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$ HR $>$$<$ HR $>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$ HR $>$$<$ HR $>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the therefore the constraint must be re applied \mbox{\hyperlink{refine__b__convect_8txt_ad36caf34ab0237a3578c42f2c4a9244a}{However}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$ HR $>$$<$ HR $>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the therefore the constraint must be re applied we unpin all pressure degrees of freedom first to ensure that we do not accidentally pin two pressure degrees of freedom until end\+\_\+of\+\_\+fix The remaining member \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} provide access to the boolean flag that controls the application of the \mbox{\hyperlink{refine__b__convect_8txt_a9a325f28a20fa4ec06f5574b0c0b4e61}{imperfection}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the solution from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the solution into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken solution shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$ HR $>$$<$ HR $>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the therefore the constraint must be re applied we unpin all pressure degrees of freedom first to ensure that we do not accidentally pin two pressure degrees of freedom until end\+\_\+of\+\_\+fix The remaining member \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} provide access to the boolean flag that controls the application of the \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} document the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}}
\item 
As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$ HR $>$$<$ HR $>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the therefore the constraint must be re applied we unpin all pressure degrees of freedom first to ensure that we do not accidentally pin two pressure degrees of freedom until end\+\_\+of\+\_\+fix The remaining member \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} provide access to the boolean flag that controls the application of the \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} document the which has no arguments The constructor builds a coarse initial c \mbox{\hyperlink{refine__b__convect_8txt_a3ab223d59a01d8efabc714852a703bbe}{Refineable\+Rectangular\+Quad\+Mesh}}
\item 
the function c or the temperature \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}}
\item 
the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature \mbox{\hyperlink{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}{fields}}
\item 
the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature with the velocity \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} terms stored first dontinclude boussinesq\+\_\+elements h skipline The recovery order is that of until end of get\+\_\+\+Z2\+\_\+flux The default behaviour of the Z2 error estimator is to combine all components of the flux vector into a single compound flux In the present multi physics \mbox{\hyperlink{refine__b__convect_8txt_a76374ef3c6061f3c4786702a50a907ed}{element}}
\item 
the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature with the velocity \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} terms stored first dontinclude boussinesq\+\_\+elements h skipline The recovery order is that of until end of get\+\_\+\+Z2\+\_\+flux The default behaviour of the Z2 error estimator is to combine all components of the flux vector into a single compound flux In the present multi physics we instead define two compound \mbox{\hyperlink{refine__b__convect_8txt_a2e63fd5c89a130dca9c63ccc02d69afb}{fluxes}}
\item 
the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature with the velocity \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} terms stored first dontinclude boussinesq\+\_\+elements h skipline The recovery order is that of until end of get\+\_\+\+Z2\+\_\+flux The default behaviour of the Z2 error estimator is to combine all components of the flux vector into a single compound flux In the present multi physics we instead define two compound containing the index of the compound flux to which the flux component contributes dontinclude boussinesq\+\_\+elements h skipline The number of compound \mbox{\hyperlink{refine__b__convect_8txt_a2e63fd5c89a130dca9c63ccc02d69afb}{fluxes}} until end of get\+\_\+\+Z2\+\_\+compound\+\_\+flux\+\_\+indices The c Z2\+Error\+Estimator calculates the error estimates for each compound flux The individual error estimates are then combined to a single error estimate by the function c Z2\+Error\+Estimator\+::get\+\_\+combined\+\_\+error\+\_\+estimate(). By default the single error estimate is chosen to be the maximum of all calculated error estimates. Alternative user-\/defined \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} can be specified via the function pointer \textbackslash{}c Z2\+Error\+Estimator an appropriate choice for problems in which the variations in the velocity \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} are expected to be much more rapid than those in the temperature \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} \mbox{\hyperlink{refine__b__convect_8txt_a712a71924df6c574241cb6c5a2ddba8b}{Alternatively}}
\item 
endcode specifies that the combined error estimate is the first of the compound error estimates the error estimate for the Navier Stokes equations n n In the current \mbox{\hyperlink{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}{example}} both \mbox{\hyperlink{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}{fields}} vary very \mbox{\hyperlink{refine__b__convect_8txt_aa2c2c21bccf7a2b590e22a9d0e2b1b98}{smoothly}}
\item 
endcode specifies that the combined error estimate is the first of the compound error estimates the error estimate for the Navier Stokes equations n n In the current \mbox{\hyperlink{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}{example}} both \mbox{\hyperlink{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}{fields}} vary very \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} as a result spatial adaptivity is not really required in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} This is why we set a very narrow range of target errors if the default targets are \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}}
\item 
endcode specifies that the combined error estimate is the first of the compound error estimates the error estimate for the Navier Stokes equations n n In the current \mbox{\hyperlink{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}{example}} both \mbox{\hyperlink{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}{fields}} vary very \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} as a result spatial adaptivity is not really required in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} This is why we set a very narrow range of target errors if the default targets are c oomph lib refines the mesh uniformly subsection exercises Exercises is \mbox{\hyperlink{refine__b__convect_8txt_a19b22ddd6f9262a97f12413b125f9da7}{stable}}
\end{DoxyCompactItemize}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}\label{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!href@{href}}
\index{href@{href}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{href}{href}}
{\footnotesize\ttfamily using \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}} =  \char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$non-\/refineable version of the \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}}$<$/a$>$ we create the refineable \mbox{\hyperlink{refine__b__convect_8txt_a76374ef3c6061f3c4786702a50a907ed}{element}} \textbackslash{}c Refineable\+Buoyant\+Q\+Crouzeix\+Raviart\+Element by multiple inheritance from the \textbackslash{}c Refineable\+Q\+Crouzeix\+Raviart\+Element \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} \textbackslash{}c Refineable\+Q\+Advection\+Diffusion\+Element\+: \textbackslash{}dontinclude boussinesq\+\_\+elements.\+h \textbackslash{}skipline start\+\_\+element\+\_\+class \textbackslash{}until \{ Many of the additional member \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required in the combined multi-\/physics \mbox{\hyperlink{refine__b__convect_8txt_a76374ef3c6061f3c4786702a50a907ed}{element}} are identical to those in the non-\/refineable version\+: -\/ the access function to (the pointer to the) Rayleigh number, \textbackslash{}c ra\+\_\+pt(), -\/ the output \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}}, \textbackslash{}c output(...), -\/ the function \textbackslash{}c required\+\_\+n\+\_\+value(...) which specifies the number of values required at each node, -\/ the function \textbackslash{}c u\+\_\+index\+\_\+adv\+\_\+diff(...) which specifies the index at which the temperature is stored within the elements\textquotesingle{} \textbackslash{}c Nodes, -\/ the function \textbackslash{}c get\+\_\+wind\+\_\+adv\+\_\+diff(...) which specifies the \char`\"{}wind\char`\"{} in the advection diffusion equations in terms of the Navier-\/Stokes velocities, -\/ the function \textbackslash{}c get\+\_\+body\+\_\+force\+\_\+nst(...) which specifies the body force in the Navier-\/Stokes equations in terms of the temperature. -\/ the two \char`\"{}fill in\char`\"{} function are implemented as in the non-\/refineable element. The function \textbackslash{}c fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+residuals(...) concatenates the contributions from the two underlying elements}



Definition at line 180 of file refine\+\_\+b\+\_\+convect.\+txt.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}\label{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!and@{and}}
\index{and@{and}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{and()}{and()}}
{\footnotesize\ttfamily As discussed in the$<$a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a$>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity and linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation and re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$HR$>$$<$HR$>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor and (\begin{DoxyParamCaption}\item[{empty}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{refine__b__convect_8txt_afb1ff8cf837bf38120135bebec006cd4}\label{refine__b__convect_8txt_afb1ff8cf837bf38120135bebec006cd4}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!fill\_in\_contribution\_to\_jacobian@{fill\_in\_contribution\_to\_jacobian}}
\index{fill\_in\_contribution\_to\_jacobian@{fill\_in\_contribution\_to\_jacobian}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{fill\_in\_contribution\_to\_jacobian()}{fill\_in\_contribution\_to\_jacobian()}}
{\footnotesize\ttfamily the function c fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+jacobian (\begin{DoxyParamCaption}\item[{}]{... }\end{DoxyParamCaption}) const}



Referenced by oomph\+::\+Refineable\+Navier\+Stokes\+Boussinesq\+Element$<$ N\+S\+T\+\_\+\+E\+L\+E\+M\+E\+N\+T, A\+D\+\_\+\+E\+L\+E\+M\+E\+N\+T $>$\+::fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+jacobian(), oomph\+::\+Buoyant\+Q\+Crouzeix\+Raviart\+Element$<$ D\+I\+M $>$\+::fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+jacobian(), oomph\+::\+Refineable\+Advection\+Diffusion\+Boussinesq\+Element$<$ A\+D\+\_\+\+E\+L\+E\+M\+E\+N\+T, N\+S\+T\+\_\+\+E\+L\+E\+M\+E\+N\+T $>$\+::fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+jacobian(), oomph\+::\+Navier\+Stokes\+Boussinesq\+Element$<$ N\+S\+T\+\_\+\+E\+L\+E\+M\+E\+N\+T, A\+D\+\_\+\+E\+L\+E\+M\+E\+N\+T $>$\+::fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+jacobian(), oomph\+::\+Advection\+Diffusion\+Boussinesq\+Element$<$ A\+D\+\_\+\+E\+L\+E\+M\+E\+N\+T, N\+S\+T\+\_\+\+E\+L\+E\+M\+E\+N\+T $>$\+::fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+jacobian(), and oomph\+::\+Refineable\+Buoyant\+Q\+Crouzeix\+Raviart\+Element$<$ D\+I\+M $>$\+::fill\+\_\+in\+\_\+contribution\+\_\+to\+\_\+jacobian().

\mbox{\Hypertarget{refine__b__convect_8txt_a208f161875a2b8b1c7302a9d2b409f70}\label{refine__b__convect_8txt_a208f161875a2b8b1c7302a9d2b409f70}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!navier\_stokes\_flux\_error@{navier\_stokes\_flux\_error}}
\index{navier\_stokes\_flux\_error@{navier\_stokes\_flux\_error}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{navier\_stokes\_flux\_error()}{navier\_stokes\_flux\_error()}}
{\footnotesize\ttfamily a choice that would be appropriate for problems with thin thermal boundary layers The different error estimates can all be specified by user defined \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} that combine the vector of compound flux error estimates into a single number For the function code double navier\+\_\+stokes\+\_\+flux\+\_\+error (\begin{DoxyParamCaption}\item[{const Vector$<$ double $>$ \&}]{errors }\end{DoxyParamCaption})}



Definition at line 303 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}\label{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!problem@{problem}}
\index{problem@{problem}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{problem()}{problem()}}
{\footnotesize\ttfamily As discussed in the$<$a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a$>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$HR$>$$<$HR$>$ section problem The problem class The problem class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this problem dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the problem (\begin{DoxyParamCaption}\item[{Since the domain is enclosed the pressure is only determined up to an arbitrary}]{constant. }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{refine__b__convect_8txt_a712a71924df6c574241cb6c5a2ddba8b}\label{refine__b__convect_8txt_a712a71924df6c574241cb6c5a2ddba8b}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!Alternatively@{Alternatively}}
\index{Alternatively@{Alternatively}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{Alternatively}{Alternatively}}
{\footnotesize\ttfamily the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature with the velocity \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} terms stored first dontinclude boussinesq\+\_\+elements h skipline The recovery order is that of until end of get\+\_\+\+Z2\+\_\+flux The default behaviour of the Z2 error estimator is to combine all components of the flux vector into a single compound flux In the present multi physics we instead define two compound containing the index of the compound flux to which the flux component contributes dontinclude boussinesq\+\_\+elements h skipline The number of compound \mbox{\hyperlink{refine__b__convect_8txt_a2e63fd5c89a130dca9c63ccc02d69afb}{fluxes}} until end of get\+\_\+\+Z2\+\_\+compound\+\_\+flux\+\_\+indices The c Z2\+Error\+Estimator calculates the error estimates for each compound flux The individual error estimates are then combined to a single error estimate by the function c Z2\+Error\+Estimator\+::get\+\_\+combined\+\_\+error\+\_\+estimate (). By default the single error estimate is chosen to be the maximum of all calculated error estimates. Alternative user-\/defined \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} can be specified via the function pointer \textbackslash{}c Z2\+Error\+Estimator an appropriate choice for problems in which the variations in the velocity \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} are expected to be much more rapid than those in the temperature \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} Alternatively}



Definition at line 222 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a45c28d7c95e6c5c1c6023e8af810b0cb}\label{refine__b__convect_8txt_a45c28d7c95e6c5c1c6023e8af810b0cb}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!Convection@{Convection}}
\index{Convection@{Convection}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{Convection}{Convection}}
{\footnotesize\ttfamily mainpage Refineable Boussinesq Convection}



Definition at line 8 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a76374ef3c6061f3c4786702a50a907ed}\label{refine__b__convect_8txt_a76374ef3c6061f3c4786702a50a907ed}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!element@{element}}
\index{element@{element}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{element}{element}}
{\footnotesize\ttfamily the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature with the velocity \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} terms stored first dontinclude boussinesq\+\_\+elements h skipline The recovery order is that of until end of get\+\_\+\+Z2\+\_\+flux The default behaviour of the Z2 error estimator is to combine all components of the flux vector into a single compound flux In the present multi physics element}



Definition at line 206 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}\label{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!example@{example}}
\index{example@{example}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{example}{example}}
{\footnotesize\ttfamily a choice that would be appropriate for problems with thin thermal boundary layers The different error estimates can all be specified by user defined \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} that combine the vector of compound flux error estimates into a single number For example}



Definition at line 36 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}\label{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!field@{field}}
\index{field@{field}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{field}{field}}
{\footnotesize\ttfamily the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature with the velocity field terms stored first dontinclude boussinesq\+\_\+elements h skipline The recovery order is that of until end of get\+\_\+\+Z2\+\_\+flux The default behaviour of the Z2 error estimator is to combine all components of the flux vector into a single compound flux In the present multi physics we instead define two compound containing the index of the compound flux to which the flux component contributes dontinclude boussinesq\+\_\+elements h skipline The number of compound \mbox{\hyperlink{refine__b__convect_8txt_a2e63fd5c89a130dca9c63ccc02d69afb}{fluxes}} until end of get\+\_\+\+Z2\+\_\+compound\+\_\+flux\+\_\+indices The c Z2\+Error\+Estimator calculates the error estimates for each compound flux The individual error estimates are then combined to a single error estimate by the function c Z2\+Error\+Estimator\+::get\+\_\+combined\+\_\+error\+\_\+estimate (). By default the single error estimate is chosen to be the maximum of all calculated error estimates. Alternative user-\/defined \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} can be specified via the function pointer \textbackslash{}c Z2\+Error\+Estimator an appropriate choice for problems in which the variations in the velocity field are expected to be much more rapid than those in the temperature field the error estimation could be based exclusively on the temperature field}



Definition at line 193 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}\label{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!fields@{fields}}
\index{fields@{fields}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{fields}{fields}}
{\footnotesize\ttfamily the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature fields}



Definition at line 198 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a2e63fd5c89a130dca9c63ccc02d69afb}\label{refine__b__convect_8txt_a2e63fd5c89a130dca9c63ccc02d69afb}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!fluxes@{fluxes}}
\index{fluxes@{fluxes}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{fluxes}{fluxes}}
{\footnotesize\ttfamily the function c or the temperature but instead we shall choose our single error estimate to be the maximum of the fluid \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature error estimates The \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} required by the c Z2\+Error\+Estimator are overloaded to return all the flux terms associated with both the velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} temperature with the velocity \mbox{\hyperlink{refine__b__convect_8txt_a48e3ff99683c6fde7db73706d5aff2aa}{field}} terms stored first dontinclude boussinesq\+\_\+elements h skipline The recovery order is that of until end of get\+\_\+\+Z2\+\_\+flux The default behaviour of the Z2 error estimator is to combine all components of the flux vector into a single compound flux In the present multi physics we instead define two compound fluxes}



Definition at line 212 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}\label{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!functions@{functions}}
\index{functions@{functions}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{functions}{functions}}
{\footnotesize\ttfamily As discussed in the$<$a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a$>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$HR$>$$<$HR$>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action functions}



Definition at line 58 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_ad36caf34ab0237a3578c42f2c4a9244a}\label{refine__b__convect_8txt_ad36caf34ab0237a3578c42f2c4a9244a}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!However@{However}}
\index{However@{However}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{However}{However}}
{\footnotesize\ttfamily As discussed in the$<$a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a$>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$HR$>$$<$HR$>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the therefore the constraint must be re applied However}



Definition at line 71 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a9a325f28a20fa4ec06f5574b0c0b4e61}\label{refine__b__convect_8txt_a9a325f28a20fa4ec06f5574b0c0b4e61}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!imperfection@{imperfection}}
\index{imperfection@{imperfection}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{imperfection}{imperfection}}
{\footnotesize\ttfamily As discussed in the$<$a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a$>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$HR$>$$<$HR$>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the therefore the constraint must be re applied we unpin all pressure degrees of freedom first to ensure that we do not accidentally pin two pressure degrees of freedom until end\+\_\+of\+\_\+fix The remaining member \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} provide access to the boolean flag that controls the application of the imperfection}



Definition at line 78 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a11778e96d5cb3a43210ca8e38083780f}\label{refine__b__convect_8txt_a11778e96d5cb3a43210ca8e38083780f}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!problem@{problem}}
\index{problem@{problem}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{problem}{problem}}
{\footnotesize\ttfamily As discussed in the$<$ a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a $>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the problem}



Definition at line 40 of file refine\+\_\+b\+\_\+convect.\+txt.



Referenced by main().

\mbox{\Hypertarget{refine__b__convect_8txt_a3ab223d59a01d8efabc714852a703bbe}\label{refine__b__convect_8txt_a3ab223d59a01d8efabc714852a703bbe}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!RefineableRectangularQuadMesh@{RefineableRectangularQuadMesh}}
\index{RefineableRectangularQuadMesh@{RefineableRectangularQuadMesh}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{RefineableRectangularQuadMesh}{RefineableRectangularQuadMesh}}
{\footnotesize\ttfamily As discussed in the$<$a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a$>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$HR$>$$<$HR$>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the therefore the constraint must be re applied we unpin all pressure degrees of freedom first to ensure that we do not accidentally pin two pressure degrees of freedom until end\+\_\+of\+\_\+fix The remaining member \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} provide access to the boolean flag that controls the application of the \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} document the which has no arguments The constructor builds a coarse initial c Refineable\+Rectangular\+Quad\+Mesh}



Definition at line 90 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_aa2c2c21bccf7a2b590e22a9d0e2b1b98}\label{refine__b__convect_8txt_aa2c2c21bccf7a2b590e22a9d0e2b1b98}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!smoothly@{smoothly}}
\index{smoothly@{smoothly}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{smoothly}{smoothly}}
{\footnotesize\ttfamily endcode specifies that the combined error estimate is the first of the compound error estimates the error estimate for the Navier Stokes equations n n In the current \mbox{\hyperlink{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}{example}} both \mbox{\hyperlink{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}{fields}} vary very smoothly}



Definition at line 310 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}\label{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!solution@{solution}}
\index{solution@{solution}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{solution}{solution}}
{\footnotesize\ttfamily As discussed in the$<$a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a$>$ a small perturbation is required to force the solution from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation we add a small perturbation to the vertical velocity on the upper wall before solving the steady allowing for up to two levels of adaptive mesh refinement until doc\+\_\+solution Having forced the solution into a non trivial symmetry broken we switch off the perturbation \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} re solve the allowing for another two levels of adaptive refinement The Newton solver now converges to the unperturbed but symmetry broken solution shown above until end of \mbox{\hyperlink{refineable__b__convection_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$HR$>$$<$HR$>$ section \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class The \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} class contains the constructor the usual action \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} an access function to the specific mesh \mbox{\hyperlink{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}{used}} in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} dontinclude refineable\+\_\+b\+\_\+convection cc skipline start\+\_\+of\+\_\+problem\+\_\+class until end of access No specific action is required before the adaptation but following the mesh adaptation exactly one pressure degree of freedom must be pinned in the therefore the constraint must be re applied we unpin all pressure degrees of freedom first to ensure that we do not accidentally pin two pressure degrees of freedom until end\+\_\+of\+\_\+fix The remaining member \mbox{\hyperlink{refine__b__convect_8txt_a0da63057661cd5950bb6ea2e67737e60}{functions}} provide access to the boolean flag that controls the application of the \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} document the solution}



Definition at line 89 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a19b22ddd6f9262a97f12413b125f9da7}\label{refine__b__convect_8txt_a19b22ddd6f9262a97f12413b125f9da7}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!stable@{stable}}
\index{stable@{stable}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{stable}{stable}}
{\footnotesize\ttfamily endcode specifies that the combined error estimate is the first of the compound error estimates the error estimate for the Navier Stokes equations n n In the current \mbox{\hyperlink{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}{example}} both \mbox{\hyperlink{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}{fields}} vary very \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} as a result spatial adaptivity is not really required in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} This is why we set a very narrow range of target errors if the default targets are c oomph lib refines the mesh uniformly subsection exercises Exercises is stable}



Definition at line 317 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}\label{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!state@{state}}
\index{state@{state}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{state}{state}}
{\footnotesize\ttfamily endcode specifies that the combined error estimate is the first of the compound error estimates the error estimate for the Navier Stokes equations n n In the current \mbox{\hyperlink{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}{example}} both \mbox{\hyperlink{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}{fields}} vary very \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} as a result spatial adaptivity is not really required in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} This is why we set a very narrow range of target errors if the default targets are c oomph lib refines the mesh uniformly subsection exercises Exercises is i e it returns to the trivial state}



Definition at line 45 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a00f33da8657b7c8459f10df3ab2c3272}\label{refine__b__convect_8txt_a00f33da8657b7c8459f10df3ab2c3272}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!Therefore@{Therefore}}
\index{Therefore@{Therefore}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{Therefore}{Therefore}}
{\footnotesize\ttfamily As discussed in the$<$a \mbox{\hyperlink{refine__b__convect_8txt_a652760e0529a489769c0132b14a1bdef}{href}}=\char`\"{}../../b\+\_\+convection/html/index.\+html\char`\"{}$>$ previous$<$/a$>$ a small perturbation is required to force the \mbox{\hyperlink{refine__b__convect_8txt_a80824adb7703bf8f436e10e7386f2692}{solution}} from the trivial steady \mbox{\hyperlink{refine__b__convect_8txt_a7c1fa6e10991638196020d39232e43d1}{state}} of zero velocity \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} linear temperature variation Therefore}



Definition at line 38 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a4a045af2547c93c6b9801986cc145179}\label{refine__b__convect_8txt_a4a045af2547c93c6b9801986cc145179}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!theta\_@{theta\_}}
\index{theta\_@{theta\_}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{theta\_}{theta\_}}
{\footnotesize\ttfamily nard \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} The lower wall is maintained at a temperature f where f theta\+\_\+}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{bottom\} \(\backslash\)f\$ \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} the upper wall is maintained at}
\DoxyCodeLine{ a temperature \(\backslash\)f\$ \mbox{\hyperlink{refine__b__convect_8txt_a4a045af2547c93c6b9801986cc145179}{\(\backslash\)theta\_}}\{top\} \(\backslash\)f\$}

\end{DoxyCode}


Definition at line 9 of file refine\+\_\+b\+\_\+convect.\+txt.

\mbox{\Hypertarget{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}\label{refine__b__convect_8txt_a8243e0f56e579a9799a10c24a49568d9}} 
\index{refine\_b\_convect.txt@{refine\_b\_convect.txt}!used@{used}}
\index{used@{used}!refine\_b\_convect.txt@{refine\_b\_convect.txt}}
\doxysubsubsection{\texorpdfstring{used}{used}}
{\footnotesize\ttfamily endcode specifies that the combined error estimate is the first of the compound error estimates the error estimate for the Navier Stokes equations n n In the current \mbox{\hyperlink{refine__b__convect_8txt_a3bc94e43fb4273f87ea807c066ffd698}{example}} both \mbox{\hyperlink{refine__b__convect_8txt_adb1d642e2d099efbec7c4aebec8d84c8}{fields}} vary very \mbox{\hyperlink{refine__b__convect_8txt_a94a201c7ba6a4bac422b4209ddd924f4}{and}} as a result spatial adaptivity is not really required in this \mbox{\hyperlink{refine__b__convect_8txt_aef81b175242f105f4cfa6465e82a5948}{problem}} This is why we set a very narrow range of target errors if the default targets are used}



Definition at line 313 of file refine\+\_\+b\+\_\+convect.\+txt.

