\hypertarget{oscillating__sphere_8txt}{}\doxysection{oscillating\+\_\+sphere.\+txt File Reference}
\label{oscillating__sphere_8txt}\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}} = \char`\"{}../../../fourier\+\_\+decomposed\+\_\+helmholtz/sphere\+\_\+scattering/html/index.\+html\char`\"{}$>$ another tutorial,$<$/a $>$ the formulation used here allows the imposition of the Sommerfeld radiation condition by means of so-\/called \char`\"{}perfectly matched layers\char`\"{}(P\+M\+Ls) as an alternative to classical absorbing/approximate \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} or DtN maps. We start by reviewing the relevant theory and then present the solution of a simple model \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} -\/ the outward propagation of waves from the surface of a unit sphere.$<$ T\+A\+B\+LE border=0 $>$$<$ TR $>$$<$ TD $>$$<$ C\+E\+N\+T\+ER class=\char`\"{}panel panel-\/success\char`\"{}$>$$<$ div class=\char`\"{}panel-\/heading\char`\"{}$>$$<$ B $>$Acknowledgements$<$/B $>$$<$/div $>$$<$ div class=\char`\"{}panel-\/body\char`\"{}$>$This tutorial and the associated driver codes were developed jointly with Matthew Walker(The University of Manchester), with financial support from Thales Underwater Ltd.$<$/div $>$$<$/C\+E\+N\+T\+ER $>$$<$/TD $>$$<$/TR $>$$<$/T\+A\+B\+LE $>$$<$ HR $>$ \textbackslash{}section theory Theory\+:\+The azimuthally Fourier-\/decomposed Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} The Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} governs time-\/harmonic solutions of problems governed by the linear wave \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}nabla$^\wedge$2 U(x, y, z, t)=\textbackslash{}frac\{1\}\{c$^\wedge$2\} \textbackslash{}frac\{\textbackslash{}partial$^\wedge$2 U(x, y, z, t)\}\{\textbackslash{}partial t$^\wedge$2\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}lin\+\_\+wave\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ c \textbackslash{}f\$ is the wavespeed. Assuming that \textbackslash{}f\$ U(x, y, z, t) \textbackslash{}f\$ is time-\/harmonic, with frequency \textbackslash{}f\$ \textbackslash{}omega \textbackslash{}f\$, we write the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} function \textbackslash{}f\$ U(x, y, z, t) \textbackslash{}f\$ as \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}U(x, y, z, t)=Re(u(x, y, z) \textbackslash{} e$^\wedge$\{-\/i \textbackslash{}omega t\}) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}time\+\_\+decomp\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ u(x, y, z) \textbackslash{}f\$ is complex-\/valued. This transforms( @R\mbox{[}lin\+\_\+wave\mbox{]}@) into the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}nabla$^\wedge$2 u(x, y, z)+k$^\wedge$2 u(x, y, z)=0 \textbackslash{}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}helmholtz\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ k=\textbackslash{}omega/c \textbackslash{}f\$ is the wavenumber. Like other elliptic P\+D\+Es the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} admits Dirichlet, Neumann(flux) and Robin \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} conditions. If the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} is solved \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} an unbounded spatial \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}}(e.\+g. \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} scattering problems) the solution must also satisfy the so-\/called$<$ a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+: Sommerfeld radiation condition$<$/a$>$, which \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 3D has the form \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} \textbackslash{}lim\+\_\+\{r\textbackslash{}to \textbackslash{}infty\} r \textbackslash{}left(\textbackslash{}frac\{\textbackslash{}partial u\}\{\textbackslash{}partial r\} -\/ iku \textbackslash{}right) =0. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} Mathematically, this condition is required to ensure the uniqueness of the solution (and hence the well-\/posedness of the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}}). In a physical context, such as a scattering \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}}, the condition ensures that scattering of an incoming wave only produces outgoing not incoming waves from infinity. These equations can be solved using \textbackslash{}c oomph-\/lib\textquotesingle{}s cartesian Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}, described \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} $<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}../../../helmholtz/scattering/html/index.\+html\char`\"{}$>$another tutorial.$<$/a$>$ Here we consider an alternative approach \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} which we solve the equations \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} cylindrical polar coordinates \textbackslash{}f\$ (r,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},z) \textbackslash{}f\$, related to the cartesian coordinates \textbackslash{}f\$ (x,y,z) \textbackslash{}f\$ via \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} x = r \textbackslash{}cos(\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}), \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} y = r \textbackslash{}sin(\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}), \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} z = z. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} We then decompose the solution into its Fourier components by writing \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} u(r,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},z) = \textbackslash{}sum\+\_\+\{N=-\/\textbackslash{}infty\}$^\wedge$\{\textbackslash{}infty\} u\+\_\+N(r,z) \textbackslash{}exp(\{\textbackslash{}rm i\} N \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} Since the governing equations are linear we can compute each Fourier component \textbackslash{}f\$ u\+\_\+N(r,z) \textbackslash{}f\$ individually by solving \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} \textbackslash{}nabla$^\wedge$2 \{u\+\_\+\{N\}\}(r,z) + \textbackslash{}left(k$^\wedge$2-\/\textbackslash{}frac\{N$^\wedge$2\}\{r$^\wedge$2\}\textbackslash{}right) u\+\_\+N(r,z) = 0 \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}fourier\+\_\+helmholtz\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} while specifying the Fourier wavenumber \textbackslash{}f\$ N \textbackslash{}f\$ as a parameter. $<$HR$>$ \textbackslash{}section discr Discretisation by finite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} The discretisation of the Fourier-\/decomposed Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} itself only requires a trivial modification of its $<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}../../../helmholtz/scattering/html/index.\+html\char`\"{}$>$cartesian counterpart$<$/a$>$. Since most practical applications of the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} involve complex-\/valued solutions, we provide separate storage for the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts of the solution -\/-\/ each \textbackslash{}c Node therefore stores two unknowns values. By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}},the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts are stored as values 0 and 1, respectively
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aa9d9f6559fbca85135a48fb32eda1b88}{interest}} (the vicinity of the scatterer, say). If computations are performed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} a finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}}
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown in the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development in$<$ a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown in the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, in the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented in the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (in 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} in the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown in the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used in this case can be seen in the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used in the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ in spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed in terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed in terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices in the second sum \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} (@R\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@). The relation between the cylindrical polar coordinates \textbackslash{}f\$(r
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of f D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} f partial D\+\_\+c f of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} f D\+\_\+c f with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$ a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}f\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}f\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}f\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}f\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}f\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}f\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}f\mbox{]} and \textbackslash{}f\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}f\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}f\mbox{]} and \textbackslash{}f\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}f\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}f\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}f\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given by\textbackslash{}f\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}f\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the functions\textbackslash{}f\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}f\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel functions\textbackslash{}f\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}f\mbox{]}The functions\textbackslash{}f\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}f\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre polynomials\textbackslash{}f\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}f\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l f which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum z f and spherical polar coordinates \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} (\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$ is given by \textbackslash{}f\mbox{[}\textbackslash{}rho
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$ a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum z \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} and spherical polar coordinates \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}theta = \textbackslash{}arctan(r/z),\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} = \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} so \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,2\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} remains and \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} theta \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} sweeps from the north \mbox{\hyperlink{oscillating__sphere_8txt_a2f576549dc9ac2728d61f3ee163c330d}{pole}} (\textbackslash{}f\$ \textbackslash{}theta=0 \textbackslash{}f\$)
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$ a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum z \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} and spherical polar coordinates \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}theta = \textbackslash{}arctan(r/z),\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} = \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} so \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,2\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} remains and \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} theta \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} sweeps from the north via the \mbox{\hyperlink{oscillating__sphere_8txt_afefe646f568feee47987198143fbb914}{equator}} (\textbackslash{}f\$ \textbackslash{}theta=\textbackslash{}pi/2 \textbackslash{}f\$) to the south \mbox{\hyperlink{oscillating__sphere_8txt_a2f576549dc9ac2728d61f3ee163c330d}{pole}}(\textbackslash{}f\$ \textbackslash{}theta
\item 
\mbox{\hyperlink{oscillating__sphere_8txt_a2f76e88828a6b8514d2fa31f12c5515c}{Next}} we define the coefficients dontinclude oscillating\+\_\+sphere cc skipline \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} Vector$<$ double $>$ \mbox{\hyperlink{oscillating__sphere_8txt_aab3ca09673101b3920b214f6d576851d}{Coeff}} (N\+\_\+terms, 1.\+0)
\begin{DoxyCompactList}\small\item\em Number of terms in the exact solution. \end{DoxyCompactList}\item 
required for the specification of the exact solution dontinclude oscillating\+\_\+sphere cc skipline \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} void \mbox{\hyperlink{oscillating__sphere_8txt_a130eaf1d2feef2136f6898ccc17bf86c}{get\+\_\+exact\+\_\+u}} (const Vector$<$ double $>$ \&x, Vector$<$ double $>$ \&u) and its derivative \textbackslash{}dontinclude oscillating\+\_\+sphere.\+cc \textbackslash{}skipline(spherical r) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} exact\+\_\+minus\+\_\+dudr whose listings we omit here.$<$ HR $>$ \textbackslash{}subsection drv\+\_\+cde The driver code The driver code is very straightforward. We create the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} object
\begin{DoxyCompactList}\small\item\em Exact solution as a Vector of size 2, containing real and imag parts. \end{DoxyCompactList}\item 
and define the output directory dontinclude oscillating\+\_\+sphere cc skipline \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} doc\+\_\+info \mbox{\hyperlink{oscillating__sphere_8txt_a9bc4cd80c8928687b39ebefb5ad315cc}{set\+\_\+directory}} (\mbox{\hyperlink{namespaceProblemParameters_a9df0f1728e8e7e53dcca84385ae9a031}{Problem\+Parameters\+::\+Directory}})
\item 
we solve the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} and document the results dontinclude oscillating\+\_\+sphere cc skipline Solve the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} with Newton s method \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} \mbox{\hyperlink{oscillating__sphere_8txt_a14576df8952318060b14848b23a6f9cb}{newton\+\_\+solve}} ()
\item 
skipline Output the solution \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} end of \mbox{\hyperlink{oscillating__sphere_8cc_a3c04138a5bfe5d72780bb7e82a18e627}{main}}$<$ HR $>$ subsection prb\+\_\+clss The \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} class The \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} class is very similar to that employed for the$<$ a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}../../../helmholtz/scattering/html/index.\+html\char`\"{}$>$ solution of the D Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} with flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} conditions$<$/a $>$ We provide helper functions to create the P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} and to apply the \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} (mainly because these tasks have to be performed repeatedly \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spatially adaptive version of this code which is not discussed explicitly here;but see the exercise on \textbackslash{}ref adaptivity). \textbackslash{}dontinclude oscillating\+\_\+sphere.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+problem\+\_\+class \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} create\+\_\+power\+\_\+monitor\+\_\+mesh()
\item 
\mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}} we assign the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} dontinclude oscillating\+\_\+sphere cc skipline Setup \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} numbering scheme \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} \mbox{\hyperlink{oscillating__sphere_8txt_a566114d60479b614e9f94d830e74689d}{assign\+\_\+eqn\+\_\+numbers}} () The \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} can now be solved.$<$ HR $>$ \textbackslash{}subsection inner\+\_\+flx Impose flux on inner \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} The function \textbackslash{}c create\+\_\+flux\+\_\+elements() creates the Face\+Elements required to apply the flux/Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} on the \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the sphere. \textbackslash{}dontinclude oscillating\+\_\+sphere.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+create\+\_\+flux\+\_\+element \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} end of create flux \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} on inner \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}}$<$ HR $>$ \textbackslash{}subsection p\+\_\+monitor Create power monitor \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} The function \textbackslash{}c create\+\_\+power\+\_\+monitor\+\_\+mesh creates the Face\+Elements that allow the computation of the radiated power over the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the computational domain. \textbackslash{}dontinclude oscillating\+\_\+sphere.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+create\+\_\+power\+\_\+monitor\+\_\+mesh \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} end of create\+\_\+power\+\_\+monitor\+\_\+mesh$<$ HR $>$ \textbackslash{}subsection c\+\_\+prob\+\_\+setup Complete \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} setup The helper function \textbackslash{}c complete\+\_\+problem\+\_\+setup() completes the setup of the \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by passing pointers to the relevant \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} \mbox{\hyperlink{oscillating__sphere_8txt_a33650d25d57a83a28469b9defda6fedb}{parameters}} to them. We apply zero Dirichlet \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} on the centreline if the Fourier wavenumber is odd. \textbackslash{}dontinclude oscillating\+\_\+sphere.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+complete\+\_\+problem\+\_\+setup \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}}$<$ HR $>$ \textbackslash{}subsection app\+\_\+z\+\_\+bc Apply zero Dirichlet \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} This final helper function pins both nodal values(representing the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary part of the solution) on the centreline and sets their values to zero. \textbackslash{}dontinclude oscillating\+\_\+sphere.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+apply\+\_\+zero\+\_\+dirichlet\+\_\+boundary\+\_\+conditions \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}}$<$ HR $>$ \textbackslash{}subsection p\+\_\+process Post-\/processing The post-\/processing function \textbackslash{}c doc\+\_\+solution(...) outputs the solution within the bulk
\item 
skipline Output solution within the bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} some\+\_\+file \mbox{\hyperlink{oscillating__sphere_8txt_a28c94e0de096081d389e8e2a238d6bba}{close}} ()
\item 
dontinclude oscillating\+\_\+sphere cc skipline Total radiated power \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} power$<$$<$ std\+::endl$<$ HR $>$ section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the most practically relevant solutions of the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} are complex valued Since c oomph lib s solvers only deal with \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} (double precision) unknowns
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
mainpage Example \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}}
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}}
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of f D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aeebca83226489bb25c0f116bec0e6414}{f}}
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \mbox{\hyperlink{oscillating__sphere_8txt_a14e8f683d4fb77d00b3fb8bb90761c23}{middle}}
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within \mbox{\hyperlink{oscillating__sphere_8txt_ae3ffce5e745677b8f040caaf3440cd87}{it}}
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$ a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}varphi,\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}varphi) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}varphi)=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}varphi). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum \mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}
\item 
The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$ a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum z \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} and spherical polar coordinates \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}theta = \textbackslash{}arctan(r/z),\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} = \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} so \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,2\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} remains \mbox{\hyperlink{oscillating__sphere_8txt_ad83f065ef4522a53bbfe66955036485e}{unchanged}}
\item 
required for the specification of the exact solution dontinclude oscillating\+\_\+sphere cc skipline until void dontinclude oscillating\+\_\+sphere cc skipline start\+\_\+of\+\_\+main \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}}
\item 
\mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}
\item 
The private member data includes pointers to the bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}}
\item 
The private member data includes pointers to the bulk dontinclude oscillating\+\_\+sphere cc skipline Pointer to the bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} Bulk\+\_\+mesh\+\_\+pt a pointer to the \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of Face\+Elements that apply the flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the surface of the \mbox{\hyperlink{oscillating__sphere_8txt_a3515bdc5abaf7202b32eefa88764f1ff}{sphere}}
\item 
The private member data includes pointers to the bulk dontinclude oscillating\+\_\+sphere cc skipline Pointer to the bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} Bulk\+\_\+mesh\+\_\+pt a pointer to the \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of Face\+Elements that apply the flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the surface of the dontinclude oscillating\+\_\+sphere cc skipline Mesh of Face\+Elements that \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} Helmholtz\+\_\+inner\+\_\+boundary\+\_\+mesh\+\_\+pt and the various P\+ML sub \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}}
\item 
$<$ HR $>$ subsection prb\+\_\+con The \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} constructor We open a trace file \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} which we record the radiated power and create the c Circle object that defines the curvilinear inner \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} dontinclude oscillating\+\_\+sphere cc skipline start\+\_\+of\+\_\+constructor \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} r\+\_\+min skipline Circle $\ast$inner\+\_\+circle\+\_\+pt \mbox{\hyperlink{oscillating__sphere_8txt_a2f76e88828a6b8514d2fa31f12c5515c}{Next}} we specify the the outer radius of computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} dontinclude oscillating\+\_\+sphere cc skipline double \mbox{\hyperlink{oscillating__sphere_8txt_a74802b7295659bc9e37a44d70d613d79}{r\+\_\+max}} =3.\+0
\item 
and define its polygonal outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}}
\item 
and define its polygonal outer \mbox{\hyperlink{oscillating__sphere_8txt_a04b2b2fb16b8821e58a5b516e51d7ed3}{boundary\+\_\+id}}
\item 
we specify the \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} \mbox{\hyperlink{oscillating__sphere_8txt_a33650d25d57a83a28469b9defda6fedb}{parameters}}
\item 
we specify the \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} dontinclude oscillating\+\_\+sphere cc skipline Use the Triangle\+Mesh\+Parameter \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} \mbox{\hyperlink{oscillating__sphere_8txt_aba13bf05d9ddc7d35aee69d61bcaa8ae}{element\+\_\+area}}
\item 
\mbox{\hyperlink{oscillating__sphere_8txt_a2f76e88828a6b8514d2fa31f12c5515c}{Next}}
\item 
we create the Face\+Elements that apply the flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the \mbox{\hyperlink{oscillating__sphere_8txt_a3515bdc5abaf7202b32eefa88764f1ff}{sphere}} and add the corresponding \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} \mbox{\hyperlink{oscillating__sphere_8txt_a61fe0fc5636402ca3797cad489becf6a}{too}}
\item 
We create another set of Face\+Elements that allow the computation of the radiated flux over the outer boundaries of the \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}}
\item 
We complete the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} setup by passing the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} \mbox{\hyperlink{oscillating__sphere_8txt_a33650d25d57a83a28469b9defda6fedb}{parameters}} to the \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}
\item 
\mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}} we assign the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} \mbox{\hyperlink{oscillating__sphere_8txt_a2fb8037de86c92a80bdf9e1a3c761310}{numbers}}
\item 
\mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}} we assign the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} dontinclude oscillating\+\_\+sphere cc skipline Setup \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} numbering scheme \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} the solution within the \mbox{\hyperlink{oscillating__sphere_8txt_afd42351d885e00835f391d8eb03b5302}{P\+M\+Ls}}
\item 
\mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}} we assign the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} dontinclude oscillating\+\_\+sphere cc skipline Setup \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} numbering scheme \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} the solution within the the exact solution and the radiated power dontinclude oscillating\+\_\+sphere cc skipline start\+\_\+of\+\_\+doc \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} unsigned \mbox{\hyperlink{oscillating__sphere_8txt_ade33917a6234df7322b6cafdb0953278}{npts}} =5
\item 
dontinclude oscillating\+\_\+sphere cc skipline Total radiated power \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} power$<$$<$ std\+::endl$<$ HR $>$ section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \mbox{\hyperlink{oscillating__sphere_8txt_a8bb1e768639877331c6fd6ee89e1eb71}{introduction}}
\item 
dontinclude oscillating\+\_\+sphere cc skipline Total radiated power \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} power$<$$<$ std\+::endl$<$ HR $>$ section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the most practically relevant solutions of the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} are complex valued Since c oomph lib s solvers only deal with the equations are separated into their \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts In the implementation of the Helmholtz we store the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts of the solution as two separate values at each node By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}
\end{DoxyCompactItemize}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}\label{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!href@{href}}
\index{href@{href}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{href}{href}}
{\footnotesize\ttfamily using \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}} =  \char`\"{}../../../fourier\+\_\+decomposed\+\_\+helmholtz/sphere\+\_\+scattering/html/index.\+html\char`\"{}$>$ another tutorial, $<$/a$>$ the formulation used here allows the imposition of the Sommerfeld radiation condition by means of so-\/called \char`\"{}perfectly matched layers\char`\"{} (P\+M\+Ls) as an alternative to classical absorbing/approximate \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} or DtN maps. We start by reviewing the relevant theory and then present the solution of a simple model \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} -\/ the outward propagation of waves from the surface of a unit sphere. $<$T\+A\+B\+LE border=0$>$ $<$TR$>$ $<$TD$>$ $<$C\+E\+N\+T\+ER class=\char`\"{}panel panel-\/success\char`\"{}$>$ $<$div class=\char`\"{}panel-\/heading\char`\"{}$>$$<$B$>$Acknowledgements$<$/B$>$$<$/div$>$$<$div class=\char`\"{}panel-\/body\char`\"{}$>$This tutorial and the associated driver codes were developed jointly with Matthew Walker (The University of Manchester), with financial support from Thales Underwater Ltd. $<$/div$>$$<$/C\+E\+N\+T\+ER$>$ $<$/TD$>$ $<$/TR$>$ $<$/T\+A\+B\+LE$>$ $<$HR$>$ \textbackslash{}section theory Theory\+: The azimuthally Fourier-\/decomposed Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} The Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} governs time-\/harmonic solutions of problems governed by the linear wave \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} \textbackslash{}nabla$^\wedge$2 U(x,y,z,t) = \textbackslash{}frac\{1\}\{c$^\wedge$2\} \textbackslash{}frac\{\textbackslash{}partial$^\wedge$2 U(x,y,z,t)\}\{\textbackslash{}partial t$^\wedge$2\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}lin\+\_\+wave\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ c \textbackslash{}f\$ is the wavespeed. Assuming that \textbackslash{}f\$ U(x,y,z,t) \textbackslash{}f\$ is time-\/harmonic, with frequency \textbackslash{}f\$ \textbackslash{}omega \textbackslash{}f\$, we write the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} function \textbackslash{}f\$ U(x,y,z,t) \textbackslash{}f\$ as \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} U(x,y,z,t) = Re (u(x,y,z) \textbackslash{} e$^\wedge$\{-\/i \textbackslash{}omega t\}) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}time\+\_\+decomp\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ u(x,y,z) \textbackslash{}f\$ is complex-\/valued. This transforms (@R\mbox{[}lin\+\_\+wave\mbox{]}@) into the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} \textbackslash{}nabla$^\wedge$2 u(x,y,z) + k$^\wedge$2 u(x,y,z) = 0 \textbackslash{} , \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}helmholtz\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ k = \textbackslash{}omega/c \textbackslash{}f\$ is the wavenumber. Like other elliptic P\+D\+Es the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} admits Dirichlet, Neumann (flux) and Robin \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} conditions. If the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} is solved \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} an unbounded spatial \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (e.\+g. \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} scattering problems) the solution must also satisfy the so-\/called $<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+: Sommerfeld radiation condition$<$/a$>$, which \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 3D has the form \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} \textbackslash{}lim\+\_\+\{r\textbackslash{}to \textbackslash{}infty\} r \textbackslash{}left(\textbackslash{}frac\{\textbackslash{}partial u\}\{\textbackslash{}partial r\} -\/ iku \textbackslash{}right) =0. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} Mathematically, this condition is required to ensure the uniqueness of the solution (and hence the well-\/posedness of the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}}). In a physical context, such as a scattering \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}}, the condition ensures that scattering of an incoming wave only produces outgoing not incoming waves from infinity. These equations can be solved using \textbackslash{}c oomph-\/lib\textquotesingle{}s cartesian Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}, described \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} $<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}../../../helmholtz/scattering/html/index.\+html\char`\"{}$>$another tutorial.$<$/a$>$ Here we consider an alternative approach \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} which we solve the equations \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} cylindrical polar coordinates \textbackslash{}f\$ (r,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},z) \textbackslash{}f\$, related to the cartesian coordinates \textbackslash{}f\$ (x,y,z) \textbackslash{}f\$ via \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} x = r \textbackslash{}cos(\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}), \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} y = r \textbackslash{}sin(\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}), \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} z = z. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} We then decompose the solution into its Fourier components by writing \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} u(r,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},z) = \textbackslash{}sum\+\_\+\{N=-\/\textbackslash{}infty\}$^\wedge$\{\textbackslash{}infty\} u\+\_\+N(r,z) \textbackslash{}exp(\{\textbackslash{}rm i\} N \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} Since the governing equations are linear we can compute each Fourier component \textbackslash{}f\$ u\+\_\+N(r,z) \textbackslash{}f\$ individually by solving \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} \textbackslash{}nabla$^\wedge$2 \{u\+\_\+\{N\}\}(r,z) + \textbackslash{}left(k$^\wedge$2-\/\textbackslash{}frac\{N$^\wedge$2\}\{r$^\wedge$2\}\textbackslash{}right) u\+\_\+N(r,z) = 0 \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}fourier\+\_\+helmholtz\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} while specifying the Fourier wavenumber \textbackslash{}f\$ N \textbackslash{}f\$ as a parameter. $<$HR$>$ \textbackslash{}section discr Discretisation by finite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} The discretisation of the Fourier-\/decomposed Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} itself only requires a trivial modification of its $<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}../../../helmholtz/scattering/html/index.\+html\char`\"{}$>$cartesian counterpart$<$/a$>$. Since most practical applications of the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} involve complex-\/valued solutions, we provide separate storage for the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts of the solution -\/-\/ each \textbackslash{}c Node therefore stores two unknowns values. By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}},the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts are stored as values 0 and 1, respectively}



Definition at line 112 of file oscillating\+\_\+sphere.\+txt.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{oscillating__sphere_8txt_a566114d60479b614e9f94d830e74689d}\label{oscillating__sphere_8txt_a566114d60479b614e9f94d830e74689d}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!assign\_eqn\_numbers@{assign\_eqn\_numbers}}
\index{assign\_eqn\_numbers@{assign\_eqn\_numbers}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{assign\_eqn\_numbers()}{assign\_eqn\_numbers()}}
{\footnotesize\ttfamily \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}} we assign the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} dontinclude oscillating\+\_\+sphere cc skipline Setup \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} numbering scheme \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} assign\+\_\+eqn\+\_\+numbers (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}}



Referenced by P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem().

\mbox{\Hypertarget{oscillating__sphere_8txt_a28c94e0de096081d389e8e2a238d6bba}\label{oscillating__sphere_8txt_a28c94e0de096081d389e8e2a238d6bba}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!close@{close}}
\index{close@{close}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{close()}{close()}}
{\footnotesize\ttfamily skipline Output exact solution \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} some\+\_\+file close (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{oscillating__sphere_8txt_aab3ca09673101b3920b214f6d576851d}\label{oscillating__sphere_8txt_aab3ca09673101b3920b214f6d576851d}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!Coeff@{Coeff}}
\index{Coeff@{Coeff}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{Coeff()}{Coeff()}}
{\footnotesize\ttfamily \mbox{\hyperlink{oscillating__sphere_8txt_a2f76e88828a6b8514d2fa31f12c5515c}{Next}} we define the coefficients dontinclude oscillating\+\_\+sphere cc skipline \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} Vector$<$double$>$ Coeff (\begin{DoxyParamCaption}\item[{N\+\_\+terms}]{,  }\item[{1.}]{0 }\end{DoxyParamCaption})}



Number of terms in the exact solution. 



Referenced by Problem\+Parameters\+::exact\+\_\+minus\+\_\+dudr(), and Problem\+Parameters\+::get\+\_\+exact\+\_\+u().

\mbox{\Hypertarget{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}\label{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!conditions@{conditions}}
\index{conditions@{conditions}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{conditions()}{conditions()}}
{\footnotesize\ttfamily skipline Output the solution \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} end of \mbox{\hyperlink{oscillating__sphere_8cc_a3c04138a5bfe5d72780bb7e82a18e627}{main}}$<$HR$>$ subsection prb\+\_\+clss The \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} class The \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} class is very similar to that employed for the$<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}../../../helmholtz/scattering/html/index.\+html\char`\"{}$>$ solution of the D Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} with flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} conditions$<$/a$>$ We provide helper functions to create the P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} and to apply the \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} conditions (\begin{DoxyParamCaption}\item[{mainly because these tasks have to be performed repeatedly \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spatially adaptive version of this code which is not discussed explicitly here;but see the exercise on \textbackslash{}ref}]{adaptivity }\end{DoxyParamCaption})}

\mbox{\Hypertarget{oscillating__sphere_8txt_afefe646f568feee47987198143fbb914}\label{oscillating__sphere_8txt_afefe646f568feee47987198143fbb914}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!equator@{equator}}
\index{equator@{equator}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{equator()}{equator()}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum z \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} and spherical polar coordinates \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}theta = \textbackslash{}arctan(r/z),\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} = \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} so \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,2\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} remains and \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} theta \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} sweeps from the north via the equator (\begin{DoxyParamCaption}\item[{\textbackslash{}f\$ \textbackslash{}}]{theta = {\ttfamily \textbackslash{}pi/2~\textbackslash{}f\$} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}\label{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!f@{f}}
\index{f@{f}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{f()}{f()}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of f D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} f partial D\+\_\+c f of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} f D\+\_\+c f with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}f\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}f\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}f\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}f\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}f\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}f\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}f\mbox{]} and \textbackslash{}f\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}f\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}f\mbox{]} and \textbackslash{}f\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}f\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}f\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}f\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given by\textbackslash{}f\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}f\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the functions\textbackslash{}f\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}f\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel functions\textbackslash{}f\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}f\mbox{]}The functions\textbackslash{}f\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}f\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre polynomials\textbackslash{}f\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}f\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l f which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum z f and spherical polar coordinates f (\begin{DoxyParamCaption}\item[{\textbackslash{}}]{rho,  }\item[{\textbackslash{}}]{theta,  }\item[{\textbackslash{}}]{varphi }\end{DoxyParamCaption})}

\mbox{\Hypertarget{oscillating__sphere_8txt_a130eaf1d2feef2136f6898ccc17bf86c}\label{oscillating__sphere_8txt_a130eaf1d2feef2136f6898ccc17bf86c}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!get\_exact\_u@{get\_exact\_u}}
\index{get\_exact\_u@{get\_exact\_u}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{get\_exact\_u()}{get\_exact\_u()}}
{\footnotesize\ttfamily required for the specification of the exact solution dontinclude oscillating\+\_\+sphere cc skipline \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} void get\+\_\+exact\+\_\+u (\begin{DoxyParamCaption}\item[{const Vector$<$ double $>$ \&}]{x,  }\item[{Vector$<$ double $>$ \&}]{u }\end{DoxyParamCaption})}



Exact solution as a Vector of size 2, containing real and imag parts. 

\mbox{\Hypertarget{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}\label{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!in@{in}}
\index{in@{in}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{in()}{in()}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown in the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development in$<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown in the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, in the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented in the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (in 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} in the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown in the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used in this case can be seen in the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used in the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ in spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed in terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed in terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices in the second sum in (\begin{DoxyParamCaption}\item[{@R@}]{\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{oscillating__sphere_8txt_aa9d9f6559fbca85135a48fb32eda1b88}\label{oscillating__sphere_8txt_aa9d9f6559fbca85135a48fb32eda1b88}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!interest@{interest}}
\index{interest@{interest}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{interest()}{interest()}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of interest (\begin{DoxyParamCaption}\item[{the vicinity of the}]{scatterer,  }\item[{say}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{oscillating__sphere_8txt_a14576df8952318060b14848b23a6f9cb}\label{oscillating__sphere_8txt_a14576df8952318060b14848b23a6f9cb}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!newton\_solve@{newton\_solve}}
\index{newton\_solve@{newton\_solve}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{newton\_solve()}{newton\_solve()}}
{\footnotesize\ttfamily we solve the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} and document the results dontinclude oscillating\+\_\+sphere cc skipline Solve the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} with Newton s method \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} newton\+\_\+solve (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{oscillating__sphere_8txt_a2f576549dc9ac2728d61f3ee163c330d}\label{oscillating__sphere_8txt_a2f576549dc9ac2728d61f3ee163c330d}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!pole@{pole}}
\index{pole@{pole}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{pole()}{pole()}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum z \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} and spherical polar coordinates \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}theta = \textbackslash{}arctan(r/z),\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} = \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} so \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,2\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} remains and \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} theta \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} sweeps from the north pole (\begin{DoxyParamCaption}\item[{\textbackslash{}f\$ \textbackslash{}}]{theta = {\ttfamily 0~\textbackslash{}f\$} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}\label{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!real@{real}}
\index{real@{real}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{real()}{real()}}
{\footnotesize\ttfamily dontinclude oscillating\+\_\+sphere cc skipline Total radiated power \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} power$<$$<$ std\+::endl$<$HR$>$ section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the most practically relevant solutions of the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} are complex valued Since c oomph lib s solvers only deal with real (\begin{DoxyParamCaption}\item[{double}]{precision }\end{DoxyParamCaption})}



Referenced by oomph\+::\+P\+M\+L\+Helmholtz\+Point\+Source\+Element$<$ E\+L\+E\+M\+E\+N\+T $>$\+::fill\+\_\+in\+\_\+point\+\_\+source\+\_\+contribution\+\_\+to\+\_\+residuals().

\mbox{\Hypertarget{oscillating__sphere_8txt_a9bc4cd80c8928687b39ebefb5ad315cc}\label{oscillating__sphere_8txt_a9bc4cd80c8928687b39ebefb5ad315cc}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!set\_directory@{set\_directory}}
\index{set\_directory@{set\_directory}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{set\_directory()}{set\_directory()}}
{\footnotesize\ttfamily and define the output directory dontinclude oscillating\+\_\+sphere cc skipline \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} doc\+\_\+info set\+\_\+directory (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceProblemParameters_a9df0f1728e8e7e53dcca84385ae9a031}{Problem\+Parameters\+::\+Directory}}}]{ }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}\label{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!boundary@{boundary}}
\index{boundary@{boundary}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{boundary}{boundary}}
{\footnotesize\ttfamily and combine the various pieces of the boundary to the closed outer boundary}



Definition at line 468 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a04b2b2fb16b8821e58a5b516e51d7ed3}\label{oscillating__sphere_8txt_a04b2b2fb16b8821e58a5b516e51d7ed3}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!boundary\_id@{boundary\_id}}
\index{boundary\_id@{boundary\_id}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{boundary\_id}{boundary\_id}}
{\footnotesize\ttfamily and define its polygonal outer boundary\+\_\+id}



Definition at line 468 of file oscillating\+\_\+sphere.\+txt.



Referenced by P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem().

\mbox{\Hypertarget{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}\label{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!default@{default}}
\index{default@{default}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{default}{default}}
{\footnotesize\ttfamily dontinclude oscillating\+\_\+sphere cc skipline Total radiated power \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} power$<$$<$ std\+::endl$<$HR$>$ section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the most practically relevant solutions of the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} are complex valued Since c oomph lib s solvers only deal with the equations are separated into their \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts In the implementation of the Helmholtz we store the \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts of the solution as two separate values at each node By default}



Definition at line 623 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}\label{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!domain@{domain}}
\index{domain@{domain}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{domain}{domain}}
{\footnotesize\ttfamily We create another set of Face\+Elements that allow the computation of the radiated flux over the outer boundaries of the domain}



Definition at line 506 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_aba13bf05d9ddc7d35aee69d61bcaa8ae}\label{oscillating__sphere_8txt_aba13bf05d9ddc7d35aee69d61bcaa8ae}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!element\_area@{element\_area}}
\index{element\_area@{element\_area}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{element\_area}{element\_area}}
{\footnotesize\ttfamily we specify the \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} dontinclude oscillating\+\_\+sphere cc skipline Use the Triangle\+Mesh\+Parameter \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} element\+\_\+area}



Definition at line 487 of file oscillating\+\_\+sphere.\+txt.



Referenced by P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem().

\mbox{\Hypertarget{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}\label{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!elements@{elements}}
\index{elements@{elements}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{elements}{elements}}
{\footnotesize\ttfamily dontinclude oscillating\+\_\+sphere cc skipline Total radiated power \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} power$<$$<$ std\+::endl$<$HR$>$ section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the most practically relevant solutions of the Helmholtz \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} are complex valued Since c oomph lib s solvers only deal with the equations are separated into their \mbox{\hyperlink{oscillating__sphere_8txt_a48949ff2f6e8b315391b69a7d7ee215a}{real}} and imaginary parts In the implementation of the Helmholtz elements}



Definition at line 520 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}\label{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!equation@{equation}}
\index{equation@{equation}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{equation}{equation}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson equation}



Definition at line 138 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_aeebca83226489bb25c0f116bec0e6414}\label{oscillating__sphere_8txt_aeebca83226489bb25c0f116bec0e6414}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!f@{f}}
\index{f@{f}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{f}{f}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of f D\+\_\+c f}



Definition at line 144 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}\label{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!Finally@{Finally}}
\index{Finally@{Finally}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{Finally}{Finally}}
{\footnotesize\ttfamily Finally}



Definition at line 401 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a8bb1e768639877331c6fd6ee89e1eb71}\label{oscillating__sphere_8txt_a8bb1e768639877331c6fd6ee89e1eb71}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!introduction@{introduction}}
\index{introduction@{introduction}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{introduction}{introduction}}
{\footnotesize\ttfamily dontinclude oscillating\+\_\+sphere cc skipline Total radiated power \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} power$<$$<$ std\+::endl$<$HR$>$ section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the introduction}



Definition at line 617 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_ae3ffce5e745677b8f040caaf3440cd87}\label{oscillating__sphere_8txt_ae3ffce5e745677b8f040caaf3440cd87}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!it@{it}}
\index{it@{it}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{it}{it}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within it}



Definition at line 151 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}\label{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!mesh@{mesh}}
\index{mesh@{mesh}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{mesh}{mesh}}
{\footnotesize\ttfamily This mesh does not need to be added to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} since its \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} merely act as post processing tools and do not provide any contributions to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} s residual vector We build the P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} and combine the various sub \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} s global mesh}



Definition at line 427 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}\label{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!meshes@{meshes}}
\index{meshes@{meshes}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{meshes}{meshes}}
{\footnotesize\ttfamily The private member data includes pointers to the bulk dontinclude oscillating\+\_\+sphere cc skipline Pointer to the bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} Bulk\+\_\+mesh\+\_\+pt a pointer to the \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of Face\+Elements that apply the flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the surface of the dontinclude oscillating\+\_\+sphere cc skipline Mesh of Face\+Elements that \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} Helmholtz\+\_\+inner\+\_\+boundary\+\_\+mesh\+\_\+pt and the various P\+ML sub meshes}



Definition at line 444 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a14e8f683d4fb77d00b3fb8bb90761c23}\label{oscillating__sphere_8txt_a14e8f683d4fb77d00b3fb8bb90761c23}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!middle@{middle}}
\index{middle@{middle}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{middle}{middle}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the middle}



Definition at line 144 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a2f76e88828a6b8514d2fa31f12c5515c}\label{oscillating__sphere_8txt_a2f76e88828a6b8514d2fa31f12c5515c}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!Next@{Next}}
\index{Next@{Next}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{Next}{Next}}
{\footnotesize\ttfamily Next}



Definition at line 495 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_ade33917a6234df7322b6cafdb0953278}\label{oscillating__sphere_8txt_ade33917a6234df7322b6cafdb0953278}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!npts@{npts}}
\index{npts@{npts}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{npts}{npts}}
{\footnotesize\ttfamily \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}} we assign the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} dontinclude oscillating\+\_\+sphere cc skipline Setup \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} numbering scheme \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} the solution within the the exact solution and the radiated power dontinclude oscillating\+\_\+sphere cc skipline start\+\_\+of\+\_\+doc \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} unsigned npts =5}



Definition at line 595 of file oscillating\+\_\+sphere.\+txt.



Referenced by P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::doc\+\_\+solution().

\mbox{\Hypertarget{oscillating__sphere_8txt_a2fb8037de86c92a80bdf9e1a3c761310}\label{oscillating__sphere_8txt_a2fb8037de86c92a80bdf9e1a3c761310}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!numbers@{numbers}}
\index{numbers@{numbers}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{numbers}{numbers}}
{\footnotesize\ttfamily \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}} we assign the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} numbers}



Definition at line 529 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a33650d25d57a83a28469b9defda6fedb}\label{oscillating__sphere_8txt_a33650d25d57a83a28469b9defda6fedb}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!parameters@{parameters}}
\index{parameters@{parameters}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{parameters}{parameters}}
{\footnotesize\ttfamily we specify the \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} parameters}



Definition at line 483 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_afd42351d885e00835f391d8eb03b5302}\label{oscillating__sphere_8txt_afd42351d885e00835f391d8eb03b5302}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!PMLs@{PMLs}}
\index{PMLs@{PMLs}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{PMLs}{PMLs}}
{\footnotesize\ttfamily \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}} we assign the \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} dontinclude oscillating\+\_\+sphere cc skipline Setup \mbox{\hyperlink{oscillating__sphere_8txt_a22740c20e99352fbe54bcb96d67962cc}{equation}} numbering scheme \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} the solution within the P\+M\+Ls}



Definition at line 590 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}\label{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!problem@{problem}}
\index{problem@{problem}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{problem}{problem}}
{\footnotesize\ttfamily build the bulk and add \mbox{\hyperlink{oscillating__sphere_8txt_ae3ffce5e745677b8f040caaf3440cd87}{it}} to the problem}



Definition at line 4 of file oscillating\+\_\+sphere.\+txt.



Referenced by main().

\mbox{\Hypertarget{oscillating__sphere_8txt_a74802b7295659bc9e37a44d70d613d79}\label{oscillating__sphere_8txt_a74802b7295659bc9e37a44d70d613d79}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!r\_max@{r\_max}}
\index{r\_max@{r\_max}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{r\_max}{r\_max}}
{\footnotesize\ttfamily $<$HR$>$ subsection prb\+\_\+con The \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} constructor We open a trace file \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} which we record the radiated power and create the c Circle object that defines the curvilinear inner \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} dontinclude oscillating\+\_\+sphere cc skipline start\+\_\+of\+\_\+constructor \mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{until}} r\+\_\+min skipline Circle$\ast$ inner\+\_\+circle\+\_\+pt \mbox{\hyperlink{oscillating__sphere_8txt_a2f76e88828a6b8514d2fa31f12c5515c}{Next}} we specify the the outer radius of computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} dontinclude oscillating\+\_\+sphere cc skipline double r\+\_\+max =3.\+0}



Definition at line 462 of file oscillating\+\_\+sphere.\+txt.



Referenced by P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Problem().

\mbox{\Hypertarget{oscillating__sphere_8txt_a3515bdc5abaf7202b32eefa88764f1ff}\label{oscillating__sphere_8txt_a3515bdc5abaf7202b32eefa88764f1ff}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!sphere@{sphere}}
\index{sphere@{sphere}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{sphere}{sphere}}
{\footnotesize\ttfamily \mbox{\hyperlink{oscillating__sphere_8txt_a2f76e88828a6b8514d2fa31f12c5515c}{Next}} we define the curvilinear inner \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of a c Triangle\+Mesh\+Curvi\+Line which defines the surface of the sphere}



Definition at line 434 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_a61fe0fc5636402ca3797cad489becf6a}\label{oscillating__sphere_8txt_a61fe0fc5636402ca3797cad489becf6a}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!too@{too}}
\index{too@{too}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{too}{too}}
{\footnotesize\ttfamily we create the Face\+Elements that apply the flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the \mbox{\hyperlink{oscillating__sphere_8txt_a3515bdc5abaf7202b32eefa88764f1ff}{sphere}} and add the corresponding \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} too}



Definition at line 500 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_ad83f065ef4522a53bbfe66955036485e}\label{oscillating__sphere_8txt_ad83f065ef4522a53bbfe66955036485e}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!unchanged@{unchanged}}
\index{unchanged@{unchanged}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{unchanged}{unchanged}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}})=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}}). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum z \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} and spherical polar coordinates \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}theta = \textbackslash{}arctan(r/z),\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{[}\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} = \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}},\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} so \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} \mbox{\hyperlink{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}{varphi}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} \mbox{[}0,2\textbackslash{}pi\mbox{]} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} remains unchanged}



Definition at line 324 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}\label{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!until@{until}}
\index{until@{until}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{until}{until}}
{\footnotesize\ttfamily required for the specification of the exact solution dontinclude oscillating\+\_\+sphere cc skipline until void dontinclude oscillating\+\_\+sphere cc skipline start\+\_\+of\+\_\+main until}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\(\backslash\)skipline Create the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} with 2D six-\/\mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{node}}}
\DoxyCodeLine{\mbox{\hyperlink{oscillating__sphere_8txt_ac6e0fc65935716384de6d75d1442e294}{\(\backslash\)until}} \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}}}

\end{DoxyCode}


Definition at line 390 of file oscillating\+\_\+sphere.\+txt.

\mbox{\Hypertarget{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}\label{oscillating__sphere_8txt_ae4e2ee6949033743df56746ccec53b7a}} 
\index{oscillating\_sphere.txt@{oscillating\_sphere.txt}!varphi@{varphi}}
\index{varphi@{varphi}!oscillating\_sphere.txt@{oscillating\_sphere.txt}}
\doxysubsubsection{\texorpdfstring{varphi}{varphi}}
{\footnotesize\ttfamily The application of Dirichlet and Neumann \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_af10ef57b5a2f4bc9729c690c53cd91a4}{conditions}} is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the spurious wave reflections are likely to be generated at the artificial \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} partial D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} The idea behind P\+ML methods is to surround the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} D\+\_\+c \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the P\+ML layer and the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} Our implementation of the perfectly matched layers follows the development \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}}$<$a \mbox{\hyperlink{oscillating__sphere_8txt_aa05bea9df6009950e0aa53b0c9d0abee}{href}}=\char`\"{}http\+:\+A. Bermudez, L. Hervella-\/Nieto, A. Prieto, and R. Rodriguez \char`\"{}An optimal perfectly matched layer with unbounded absorbing function for time-\/harmonic acoustic scattering problems\char`\"{}Journal of Computational Physics $<$b$>$223$<$/b$>$ 469-\/488 (2007)$<$/a$>$and we assume the boundaries of the computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} to be alignedwith the coordinate axes, as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the sketch below.\+The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[}\textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}to \textbackslash{}frac\{1\}\{s\+\_\+j(x\+\_\+j)\} \textbackslash{}frac\{\textbackslash{}partial\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{where \$j =\char`\"{}r\char`\"{},\char`\"{}z\char`\"{}\$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}cctransform\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}within the perfectly matched layers. The choice of \textbackslash{}f\$ s\+\_\+r(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+z(z) \textbackslash{}f\$ depends on the orientation of the P\+ML layer. Since we are restricting ourselves to axis-\/alignedmesh boundaries we distinguish three different cases-\/ For layers that are aligned with the r axis (such as the top and bottom P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$ is the z-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer, and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ For the right layer that is aligned with the z axis we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1, \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} where \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ is the r-\/coordinate of the outer \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} of the P\+ML layer. -\/ In corner regions that are bounded by two axis-\/aligned P\+ML layers (with outer coordinates \textbackslash{}f\$ R\+\_\+\{P\+ML\} \textbackslash{}f\$ and \textbackslash{}f\$ Z\+\_\+\{P\+ML\} \textbackslash{}f\$) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = 1 +\textbackslash{}frac\{i\}\{k\}\textbackslash{} \textbackslash{}sigma\+\_\+\{r\}(r) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{r\}(r) = \textbackslash{}frac\{1\}\{$\vert$R\+\_\+\{P\+ML\}-\/r$\vert$\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfctx\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} and \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+z(z) = 1+\textbackslash{}frac\{i\}\{k\} \textbackslash{} \textbackslash{}sigma\+\_\+\{z\}(z) \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} with \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}sigma\+\_\+\{z\}(z) = \textbackslash{}frac\{1\}\{$\vert$Z\+\_\+\{P\+ML\}-\/z$\vert$\}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}absorbingfcty\+\_\+corner\mbox{]}@ \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]} -\/ \mbox{\hyperlink{oscillating__sphere_8txt_ad929b1cb755dfec91450fd4b3154900e}{Finally}}, \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the actual computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} (outside the P\+ML layers) we set \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{[} s\+\_\+r(r) = s\+\_\+z(z) = 1. \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}.$<$HR$>$\textbackslash{}section impl Implementation within oomph-\/lib\+The finite-\/element-\/discretised equations (modified by the P\+ML terms discussed above) are implemented \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the \textbackslash{}c P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Equations class. As usual, we provide fully functional \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} by combining these with geometricfinite \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} (from the Q and T families -\/-\/ corresponding (\mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} 2D)to triangles and quad \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}}). By \mbox{\hyperlink{oscillating__sphere_8txt_a73aeb342910308bf3baee52239210f17}{default}}, the P\+ML modificationsare disabled, i.\+e. \textbackslash{}f\$ s\+\_\+\{r\}(r) \textbackslash{}f\$ and \textbackslash{}f\$ s\+\_\+\{z\}(z) \textbackslash{}f\$ are bothset to 1. The generation of suitable 2D P\+ML \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} along the axis-\/alignedboundaries of a given bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} is facilitated by helperfunctions which automatically erect layers of (quadrilateral)P\+ML elements. The layers are built from \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Element$<$N\+N\+O\+D\+E\+\_\+1D$>$ \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} andthe parameter \textbackslash{}c N\+N\+O\+D\+E\+\_\+1D is automatically chosen to match that ofthe \mbox{\hyperlink{oscillating__sphere_8txt_aa162f89ece3ec8ee343cb997f9facb2c}{elements}} \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the bulk mesh. The bulk \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} can contain quads or triangles(as shown \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the specific example presented below).$<$HR$>$\textbackslash{}section osc\+\_\+sph A specific example\+: Outward propagation of waves from the surface of an oscillating sphere\+We will now demonstrate the methodology for a specific example\+:the propagation of waves from the surface of a unit sphere.\+The specific \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} this case can be seen \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the figure below.\+We create an unstructured \mbox{\hyperlink{oscillating__sphere_8txt_ae6a65a4bc905ad6d7bdc2d682c446a4f}{mesh}} of six-\/noded \textbackslash{}c T\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elementsto create the finite computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} surrounding a sphere.\+This is surrounded by three axis-\/aligned P\+ML layers and twocorner \mbox{\hyperlink{oscillating__sphere_8txt_a152f7b5af32e2751fa06dd6f0aa42f51}{meshes}} (each made of nine-\/noded \textbackslash{}c Q\+P\+M\+L\+Fourier\+Decomposed\+Helmholtz\+Elements).@I w 0.\+5\textbackslash{}textwidth comp\+\_\+domain \char`\"{}The computational \mbox{\hyperlink{oscillating__sphere_8txt_af618b8baefd50928e83125b76c2d4f77}{domain}} used \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the example problem. \char`\"{}We construct an exact solution to the \mbox{\hyperlink{oscillating__sphere_8txt_a9a18528a3a08b0985c8b197f4e12846b}{problem}} by applying\+Neumann/flux \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} condition on the innerspherical \mbox{\hyperlink{oscillating__sphere_8txt_ad548c9b95034eb12dc7809dbb2fb9a27}{boundary}} such that the imposed flux \textbackslash{}f\$ \textbackslash{}partial u/\textbackslash{}partialn \textbackslash{}f\$ is consistent with the exact solution\textbackslash{}f\$ u(\textbackslash{}rho,\textbackslash{}varphi,\textbackslash{}theta) \textbackslash{}f\$ \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} spherical polar coordinates \textbackslash{}f\$(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}varphi) \textbackslash{}f\$, given \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{by\textbackslash{}f}}\mbox{[}u(\textbackslash{}rho,\textbackslash{}theta,\textbackslash{}varphi)=\textbackslash{}sum\+\_\+\{l=0\}$^\wedge$\{+\textbackslash{}infty\}\textbackslash{}sum\+\_\+\{n=-\/l\}$^\wedge$\{l\}\textbackslash{}left(a\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(1)\}(k\textbackslash{}rho)+b\+\_\+\{ln\} \textbackslash{} h\+\_\+\{l\}$^\wedge$\{(2)\}(k\textbackslash{}rho)\textbackslash{}right)P\+\_\+\{l\}$^\wedge$\{n\}(\textbackslash{}cos\textbackslash{}theta)\textbackslash{}exp(\{\textbackslash{}rm i\} n \textbackslash{}varphi). \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}gen\+\_\+polar\+\_\+hh\mbox{]}@\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}where the \textbackslash{}f\$a\+\_\+\{ln\}, b\+\_\+\{ln\} \textbackslash{}f\$ are arbitrary coefficients and the \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}h\+\_\+\{l\}$^\wedge$\{(1)\}(x)=j\+\_\+\{l\}(x)+\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}h\+\_\+\{l\}$^\wedge$\{(2)\}(x)=j\+\_\+\{l\}(x)-\/\{\textbackslash{}rm i\} y\+\_\+\{l\}(x) \textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the spherical Hankel functions of first and second kind,respectively, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms the spherical Bessel \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}j\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}J\+\_\+\{l+1/2\}(x) \textbackslash{}mbox\{ \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \}y\+\_\+\{l\}(x)=\textbackslash{}sqrt\{\textbackslash{}frac\{\textbackslash{}pi\}\{2x\}\}Y\+\_\+\{l+1/2\}(x).\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}The \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{functions\textbackslash{}f}}\mbox{[}P\+\_\+\{l\}$^\wedge$\{m\}(x)=(-\/1)$^\wedge$\{m\}(1-\/x$^\wedge$2)$^\wedge$\{m/2\}\textbackslash{}frac\{d$^\wedge$m\}\{dx$^\wedge$m\}P\+\_\+\{l\}(x)\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}are the associated Legendre functions, expressed \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} terms of the\+Legendre \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{polynomials\textbackslash{}f}}\mbox{[}P\+\_\+\{n\}(x)=\textbackslash{}frac\{1\}\{2$^\wedge$\{n\} \textbackslash{}, n!\}\textbackslash{}frac\{d$^\wedge$n\}\{dx$^\wedge$n\}\mbox{[}(x$^\wedge$2-\/1)$^\wedge$\{n\}\mbox{]}.\textbackslash{}\mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}}\mbox{]}This definition shows that \textbackslash{}f\$ P\+\_\+\{l\}$^\wedge$\{m\}(x)=0 \textbackslash{}f\$ for \textbackslash{}f\$ m$>$ l \mbox{\hyperlink{oscillating__sphere_8txt_aefa4af5ac906f5325536c58dbbfb3f98}{f}} which explains the limited range of summation indices \mbox{\hyperlink{oscillating__sphere_8txt_acbd75d9c449695d4f3497ee25fe93f33}{in}} the second sum varphi}



Definition at line 312 of file oscillating\+\_\+sphere.\+txt.

