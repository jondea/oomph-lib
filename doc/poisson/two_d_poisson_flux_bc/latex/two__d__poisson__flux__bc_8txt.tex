\hypertarget{two__d__poisson__flux__bc_8txt}{}\doxysection{two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt File Reference}
\label{two__d__poisson__flux__bc_8txt}\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0212ca86d5969b023039861ae8e472f8}{i}} = 1\}$^\wedge$2 \textbackslash{}frac\{\textbackslash{}partial$^\wedge$2u\}\{\textbackslash{}partial x\+\_\+i$^\wedge$2\}=f(x\+\_\+1, x\+\_\+2), \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}2D\+Poisson\mbox{]}@ \textbackslash{}f\mbox{]} in the rectangular domain \textbackslash{}f\$ D=\textbackslash{}left\textbackslash{}\{(x\+\_\+1, x\+\_\+2) \textbackslash{}in\mbox{[}0, 1\mbox{]} \textbackslash{}times\mbox{[}0, 2\mbox{]}\textbackslash{}right\textbackslash{}\} \textbackslash{}f\$. The domain boundary \textbackslash{}f\$ \textbackslash{}partial D=\textbackslash{}partial D\+\_\+\{Neumann\} \textbackslash{}cup \textbackslash{}partial D\+\_\+\{Dirichlet\} \textbackslash{}f\$, where \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{Neumann\}=\textbackslash{}left\textbackslash{}\{(x\+\_\+1, x\+\_\+2)$\vert$x\+\_\+1=1, \textbackslash{} x\+\_\+2\textbackslash{}in\mbox{[}0, 2\mbox{]} \textbackslash{}right\textbackslash{}\} \textbackslash{}f\$. On \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{Dirichlet\} \textbackslash{}f\$ we apply the Dirichlet boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} \textbackslash{}f\mbox{[}\textbackslash{}left. u\textbackslash{}right$\vert$\+\_\+\{\textbackslash{}partial D\+\_\+\{Dirichlet\}\}=u\+\_\+0, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}2D\+Poisson\+\_\+\+BC\mbox{]}@ \textbackslash{}f\mbox{]} where the function \textbackslash{}f\$ u\+\_\+0 \textbackslash{}f\$ is given. On \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{Neumann\} \textbackslash{}f\$ we apply the Neumann \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} \textbackslash{}f\mbox{[}\textbackslash{}left. \textbackslash{}frac\{\textbackslash{}partial u\}\{\textbackslash{}partial n\}\textbackslash{}right$\vert$\+\_\+\{\textbackslash{}partial D\+\_\+\{Neumann\}\}=\textbackslash{}left. \textbackslash{}frac\{\textbackslash{}partial u\}\{\textbackslash{}partial x\+\_\+1\}\textbackslash{}right$\vert$\+\_\+\{\textbackslash{}partial D\+\_\+\{Neumann\}\}=\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}2D\+Poisson\+\_\+flux\+BC\mbox{]}@ \textbackslash{}f\mbox{]} where the function \textbackslash{}f\$ \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}} \textbackslash{}f\$ is given.$<$/TD $>$$<$/TR $>$$<$/T\+A\+B\+LE $>$$<$/C\+E\+N\+T\+ER $>$ We provide a detailed discussion of the driver code$<$ A H\+R\+EF=\char`\"{}../../../../demo\+\_\+drivers/poisson/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc\char`\"{}$>$ two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc$<$/A $>$ which solves the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} for \textbackslash{}f\mbox{[}u\+\_\+0(x\+\_\+1, x\+\_\+2)=\textbackslash{}tanh(1-\/\textbackslash{}alpha(x\+\_\+1 \textbackslash{}tan\textbackslash{}\+Phi -\/ x\+\_\+2)), \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}Exact\+Soln\mbox{]}@ \textbackslash{}f\mbox{]} \textbackslash{}f\mbox{[}f(x\+\_\+1, x\+\_\+2)=\textbackslash{}sum\+\_\+\{\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0212ca86d5969b023039861ae8e472f8}{i}}=1\}$^\wedge$2 \textbackslash{}frac\{\textbackslash{}partial$^\wedge$2 u\+\_\+0\}\{\textbackslash{}partial x\+\_\+i$^\wedge$2\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}Source\+Fct\mbox{]}@ \textbackslash{}f\mbox{]} and \textbackslash{}f\mbox{[}\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}}=\textbackslash{}left. \textbackslash{}frac\{\textbackslash{}partial u\+\_\+0\}\{\textbackslash{}partial n\} \textbackslash{}right$\vert$\+\_\+\{x\+\_\+1=1\}=\textbackslash{}left. \textbackslash{}frac\{\textbackslash{}partial u\+\_\+0\}\{\textbackslash{}partial x\+\_\+1\} \textbackslash{}right$\vert$\+\_\+\{x\+\_\+1=1\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}Flux\+Fct\mbox{]}@ \textbackslash{}f\mbox{]} so that \textbackslash{}f\$ u\+\_\+0(x\+\_\+1, x\+\_\+2) \textbackslash{}f\$ is the exact solution of the problem. For large values of \textbackslash{}f\$ \textbackslash{}alpha \textbackslash{}f\$ the solution approaches a step function \textbackslash{}f\mbox{[}u\+\_\+\{step\}(x\+\_\+1, x\+\_\+2)=\textbackslash{}left\textbackslash{}\{ \textbackslash{}begin\{array\}\{rl\} -\/1 \&\textbackslash{}mbox \{for \$x\+\_\+2$<$ x\+\_\+1 \textbackslash{} \textbackslash{}tan\textbackslash{}\+Phi\$\} \textbackslash{}\textbackslash{} 1 \&\textbackslash{}mbox \{for \$x\+\_\+2 $>$ x\+\_\+1 \textbackslash{} \textbackslash{}tan\textbackslash{}\+Phi\$\} \textbackslash{}end\{array\} \textbackslash{}right. \textbackslash{}f\mbox{]} and presents a serious challenge for any numerical method. The figure below compares the numerical and exact solutions for \textbackslash{}f\$ \textbackslash{}alpha=1 \textbackslash{}f\$ and \textbackslash{}f\$ \textbackslash{}Phi=45$^\wedge$o \textbackslash{}f\$. @I w 0.\+75\textbackslash{}textwidth soln \char`\"{}Plot of the solution \char`\"{} Most of the driver code is identical to the code that solves the$<$ A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$ equivalent \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} without Neumann boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}}$<$/A $>$. Therefore we only provide a detailed discussion of those functions that needed to be changed to accommodate the Neumann boundary conditions.$<$ HR $>$$<$ HR $>$ \textbackslash{}section global Global parameters and functions As in the Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}, we define the source function( @R\mbox{[}Source\+Fct\mbox{]}@) and the exact solution( @R\mbox{[}Exact\+Soln\mbox{]}@), together with the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} parameters \textbackslash{}f\$ \textbackslash{}tan \textbackslash{}Phi \textbackslash{}f\$ and \textbackslash{}f\$ \textbackslash{}alpha \textbackslash{}f\$, in a namespace \textbackslash{}c Tanh\+Soln\+For\+Poisson. We add the function \textbackslash{}c \mbox{\hyperlink{namespaceTanhSolnForPoisson_a0e99ccf27df36f28f091de6d57484172}{Tanh\+Soln\+For\+Poisson\+::prescribed\+\_\+flux\+\_\+on\+\_\+fixed\+\_\+x\+\_\+boundary}}(...) which computes the prescribed flux \textbackslash{}f\$ \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}} \textbackslash{}f\$ required in the Neumann boundary condition( @R\mbox{[}2D\+Poisson\+\_\+flux\+BC\mbox{]}@). The function evaluates \textbackslash{}f\$ \textbackslash{}partial u\+\_\+0/\textbackslash{}partial n=\{\textbackslash{}bf N\} \textbackslash{}cdot \textbackslash{}nabla u\+\_\+0 \textbackslash{}f\$ for the normal direction specified by the vector \textbackslash{}f\$ \{\textbackslash{}bf N\}=(1, 0)$^\wedge$T. \textbackslash{}f\$ \textbackslash{}dontinclude two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+namespace \textbackslash{}until end of namespace$<$ HR $>$$<$ HR $>$ \textbackslash{}section \mbox{\hyperlink{two__d__poisson__flux__bc_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}} The driver code The driver code is very similar to that for the$<$ A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$pure Dirichlet problem\+:$<$/A $>$ We set up the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}, check its integrity and define the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} parameters. Following this, we solve the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} for a number of \textbackslash{}f\$ \textbackslash{}alpha \textbackslash{}f\$ values and document the solution. \textbackslash{}dontinclude two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+main \textbackslash{}until end of \mbox{\hyperlink{two__d__poisson__flux__bc_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}$<$ HR $>$$<$ HR $>$ \textbackslash{}section \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} The \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} class The \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} class is virtually identical to that used for the$<$ A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$pure Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}$<$/A $>$\+:The only difference is that the class now contains an additional private data member, \textbackslash{}c \mbox{\hyperlink{classFluxPoissonProblem_a1ee0cfcbc307252430a3a5ba7ab7fd6e}{Flux\+Poisson\+Problem\+::\+Npoisson\+\_\+elements}}, which stores the number of 2D \char`\"{}bulk\char`\"{} elements in the mesh, and an additional private member function \textbackslash{}c \mbox{\hyperlink{classFluxPoissonProblem_a542ce9cc1c4e17eae68d51d2e13ac0c3}{Flux\+Poisson\+Problem\+::create\+\_\+flux\+\_\+elements}}(...). pwd \textbackslash{}dontinclude two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+problem\+\_\+class \textbackslash{}until end of \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} class\mbox{[}See the discussion of the$<$ A H\+R\+EF=\char`\"{}../../../poisson/one\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$ 1D Poisson \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}$<$/A $>$ for a more detailed discussion of the function type Poisson\+Equations$<$ 2 $>$\+::Poisson\+Source\+Fct\+Pt.\mbox{]}$<$ HR $>$$<$ HR $>$ \textbackslash{}section constructor The Problem constructor The first part of the \textbackslash{}c Problem constructor is identical to that used for the$<$ A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$pure Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}$<$/A $>$\+:We create a 2D Mesh consisting of 4x4 quadrilateral Poisson elements\+:\textbackslash{}skipline start\+\_\+of\+\_\+constructor \textbackslash{}until \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a7c73c0d381a5a4a7df3d1c1e0e1e7d0c}{mesh\+\_\+pt}} Before continuing, we store the number of 2D \char`\"{}bulk\char`\"{} Poisson elements in the variable \textbackslash{}c Flux\+Poisson\+Problem\+::\+Npoisson\+\_\+element\+:\textbackslash{}skipline Store \textbackslash{}until Npoisson Now, we need to apply the prescribed-\/flux boundary condition along the Neumann boundary \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{Neumann\} \textbackslash{}f\$. The documentation for the \textbackslash{}c Simple\+Rectangular\+Quad\+Mesh shows that this boundary is mesh boundary 1. The necessary steps are performed by the function \textbackslash{}c create\+\_\+flux\+\_\+elements(..), described in the section \textbackslash{}ref create\+\_\+flux below. \textbackslash{}skipline Create prescribed \textbackslash{}until create\+\_\+flux The rest of the constructor is very similar to its counterpart in the$<$ A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$pure Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}$<$/A $>$. First we apply Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} on the remaining boundaries by pinning the nodal values. Next, we finish the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} setup by looping over all \char`\"{}bulk\char`\"{} Poisson elements and set the pointer to the source function. Since we have added the \textbackslash{}c Poisson\+Flux\+Elements to the \textbackslash{}c Mesh, only the first \textbackslash{}c Npoisson\+\_\+element elements are \char`\"{}bulk\char`\"{} elements and the loop is restricted to these. We then perform a second loop over the \textbackslash{}c Poisson\+Flux\+Elements which need to be passed the pointer to the prescribed-\/flux function \textbackslash{}c \mbox{\hyperlink{namespaceTanhSolnForPoisson_a0e99ccf27df36f28f091de6d57484172}{Tanh\+Soln\+For\+Poisson\+::prescribed\+\_\+flux\+\_\+on\+\_\+fixed\+\_\+x\+\_\+boundary}}(...). Finally, we generate the equation numbering scheme. \textbackslash{}skipline Set the boundary \textbackslash{}until end of constructor$<$ HR $>$$<$ HR $>$ \textbackslash{}section create\+\_\+flux Creating the flux elements \textbackslash{}c oomph-\/lib provides an element type \textbackslash{}c Poisson\+Flux\+Element, which allows the application of Neumann(flux) boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} along the \char`\"{}faces\char`\"{} of higher-\/dimensional \char`\"{}bulk\char`\"{} Poisson elements. \textbackslash{}c Poisson\+Flux\+Elements are templated by the type of the corresponding higher-\/dimensional \char`\"{}bulk\char`\"{} element, so that a \textbackslash{}c Poisson\+Flux\+Element$<$ Q\+Poisson\+Element$<$ 2, 3 $>$ $>$ is a one-\/dimensional three-\/node element that applies Neumann boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} along the one-\/dimensional edge of a nine-\/node quadrilateral Poisson element. Similarly, a \textbackslash{}c Poisson\+Flux\+Element$<$ Q\+Poisson\+Element$<$ 3, 2 $>$ $>$ is a two-\/dimensional quadrilateral four-\/node element that applies Neumann boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} along the two-\/dimensional face of a eight-\/node brick-\/shaped Poisson element
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
etc The constructor of the c Poisson\+Flux\+Element takes two and are located next to mesh boundary and along this boundary the element s coordinate f s\+\_\+0 f has a \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a7af92336b728ac7ac4c4e00db8416246}{constant}} (maximum) value of+1.\+0. Hence we need to set \textbackslash{}c face\+\_\+index
\item 
etc The constructor of the c Poisson\+Flux\+Element takes two and are located next to mesh boundary and along this boundary the element s coordinate f s\+\_\+0 f has a the determination of the face index can be more \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_aa1b732f59a1563bf877837102dbc1462}{difficult}} (or at least very tedious)
\item 
see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_aa0179aaad42ada3cc81a968b2f120161}{hand}} (excluding the \textbackslash{}c Poisson\+Flux\+Elements)
\item 
see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by or a suitable \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}} measure would have to be defined in the c Poisson\+Flux\+Elements We do not pursue either approach here because the difficulty is a direct consequence of \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a462d003ce9bafedfd4d5eab9bf2d7f0c}{our}} (questionable) decision to include elements of different types in the same \textbackslash{}c Mesh object. While this is perfectly \char`\"{}legal\char`\"{} and often convenient
\item 
\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a844fc4763d586f380d443a31d47359d9}{sprintf}} (filename,\char`\"{}\%s/\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}}\%i.\+dat\char`\"{}, doc\+\_\+info.\+directory().c\+\_\+str(), doc\+\_\+info.\+number())
\item 
some\+\_\+file \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_af77a465e0d1816259c8ab5349a359efd}{open}} (filename)
\item 
\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a7c73c0d381a5a4a7df3d1c1e0e1e7d0c}{mesh\+\_\+pt}} () -\/$>$ compute\+\_\+error(some\+\_\+file, \mbox{\hyperlink{namespaceTanhSolnForPoisson_af7896e9c18ce6438c73ae2a875e8b7de}{Tanh\+Soln\+For\+Poisson\+::get\+\_\+exact\+\_\+u}}, \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}}, \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a3bb09fda90c0006dbfa90d31248da3db}{norm}})
\item 
some\+\_\+file \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4db815975fe5a6bb5ab498ab0b08182e}{close}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
mainpage Demo \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}
\item 
mainpage Demo we demonstrate how to solve a Poisson \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} with Neumann boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}}
\item 
etc The constructor of the c Poisson\+Flux\+Element takes two \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_ad8c4bb14a8307f2f39780b9b5b3d93ad}{arguments}}
\item 
see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by or a suitable \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}} measure would have to be defined in the c Poisson\+Flux\+Elements We do not pursue either approach here because the difficulty is a direct consequence of the practice introduces additional difficulties in refineable problems and we shall demonstrate$<$ A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc2/html/index.\+html\char`\"{}$>$ an alternative approach in another example$<$/A $>$ skipline start\+\_\+of\+\_\+doc until end of doc$<$ HR $>$$<$ HR $>$ section exercises Exercises and Comments but leave the nodes on the Neumann boundary un pinned Compare the computational result to those obtained when you set the prescribed flux to \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a1542fa0f99d318313858c9bb4403dd71}{zero}}
\item 
see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by or a suitable \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}} measure would have to be defined in the c Poisson\+Flux\+Elements We do not pursue either approach here because the difficulty is a direct consequence of the practice introduces additional difficulties in refineable problems and we shall demonstrate$<$ A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc2/html/index.\+html\char`\"{}$>$ an alternative approach in another example$<$/A $>$ skipline start\+\_\+of\+\_\+doc until end of doc$<$ HR $>$$<$ HR $>$ section exercises Exercises and Comments but leave the nodes on the Neumann boundary un pinned Compare the computational result to those obtained when you set the prescribed flux to f \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}}
\item 
see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by or a suitable \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}} measure would have to be defined in the c Poisson\+Flux\+Elements We do not pursue either approach here because the difficulty is a direct consequence of the practice introduces additional difficulties in refineable problems and we shall demonstrate$<$ A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc2/html/index.\+html\char`\"{}$>$ an alternative approach in another example$<$/A $>$ skipline start\+\_\+of\+\_\+doc until end of doc$<$ HR $>$$<$ HR $>$ section exercises Exercises and Comments but leave the nodes on the Neumann boundary un pinned Compare the computational result to those obtained when you set the prescribed flux to f \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a3bb09fda90c0006dbfa90d31248da3db}{norm}}
\item 
endcode in c doc\+\_\+solution(...). What happens when you run the code? The code \textquotesingle{}s behaviour illustrates a general convention in \textbackslash{}c oomph-\/lib if the function is not \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_ad57194365c985b13bf163eb3693b62ef}{overloaded}}
\item 
endcode in c doc\+\_\+solution(...). What happens when you run the code? The code \textquotesingle{}s behaviour illustrates a general convention in \textbackslash{}c oomph-\/lib if the function is not the virtual broken function throws an \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}}
\item 
endcode in c doc\+\_\+solution(...). What happens when you run the code? The code \textquotesingle{}s behaviour illustrates a general convention in \textbackslash{}c oomph-\/lib if the function is not the virtual broken function throws an allowing a traceback in a debugger to find out where the broken function was called from We note that this practice is not universally approved of in the C community but we believe it to have its place in situations such as the one described here n n \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_ab25a8a9873224dd0667732bbde3a41aa}{Incidentally}}
\end{DoxyCompactItemize}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a0212ca86d5969b023039861ae8e472f8}\label{two__d__poisson__flux__bc_8txt_a0212ca86d5969b023039861ae8e472f8}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!i@{i}}
\index{i@{i}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{i}{i}}
{\footnotesize\ttfamily using \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0212ca86d5969b023039861ae8e472f8}{i}} =  1\}$^\wedge$2 \textbackslash{}frac\{\textbackslash{}partial$^\wedge$2u\}\{\textbackslash{}partial x\+\_\+i$^\wedge$2\} = f(x\+\_\+1,x\+\_\+2), \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}2D\+Poisson\mbox{]}@ \textbackslash{}f\mbox{]} in the rectangular domain \textbackslash{}f\$ D = \textbackslash{}left\textbackslash{}\{ (x\+\_\+1,x\+\_\+2) \textbackslash{}in \mbox{[}0,1\mbox{]} \textbackslash{}times \mbox{[}0,2\mbox{]}\textbackslash{}right\textbackslash{}\} \textbackslash{}f\$. The domain boundary \textbackslash{}f\$ \textbackslash{}partial D = \textbackslash{}partial D\+\_\+\{Neumann\} \textbackslash{}cup \textbackslash{}partial D\+\_\+\{Dirichlet\} \textbackslash{}f\$, where \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{Neumann\} = \textbackslash{}left\textbackslash{}\{ (x\+\_\+1,x\+\_\+2) $\vert$ x\+\_\+1=1, \textbackslash{} x\+\_\+2\textbackslash{}in \mbox{[}0,2\mbox{]} \textbackslash{}right\textbackslash{}\} \textbackslash{}f\$. On \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{Dirichlet\} \textbackslash{}f\$ we apply the Dirichlet boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} \textbackslash{}f\mbox{[} \textbackslash{}left. u\textbackslash{}right$\vert$\+\_\+\{\textbackslash{}partial D\+\_\+\{Dirichlet\}\}=u\+\_\+0, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}2D\+Poisson\+\_\+\+BC\mbox{]}@ \textbackslash{}f\mbox{]} where the function \textbackslash{}f\$ u\+\_\+0 \textbackslash{}f\$ is given. On \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{Neumann\} \textbackslash{}f\$ we apply the Neumann \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} \textbackslash{}f\mbox{[} \textbackslash{}left. \textbackslash{}frac\{\textbackslash{}partial u\}\{\textbackslash{}partial n\}\textbackslash{}right$\vert$\+\_\+\{\textbackslash{}partial D\+\_\+\{Neumann\}\} = \textbackslash{}left. \textbackslash{}frac\{\textbackslash{}partial u\}\{\textbackslash{}partial x\+\_\+1\}\textbackslash{}right$\vert$\+\_\+\{\textbackslash{}partial D\+\_\+\{Neumann\}\} =\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}2D\+Poisson\+\_\+flux\+BC\mbox{]}@ \textbackslash{}f\mbox{]} where the function \textbackslash{}f\$ \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}} \textbackslash{}f\$ is given. $<$/TD$>$ $<$/TR$>$ $<$/T\+A\+B\+LE$>$ $<$/C\+E\+N\+T\+ER$>$ We provide a detailed discussion of the driver code $<$A H\+R\+EF=\char`\"{}../../../../demo\+\_\+drivers/poisson/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc\char`\"{}$>$ two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc$<$/A$>$ which solves the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} for \textbackslash{}f\mbox{[} u\+\_\+0(x\+\_\+1,x\+\_\+2) = \textbackslash{}tanh(1-\/\textbackslash{}alpha(x\+\_\+1 \textbackslash{}tan\textbackslash{}\+Phi -\/ x\+\_\+2)), \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}Exact\+Soln\mbox{]}@ \textbackslash{}f\mbox{]} \textbackslash{}f\mbox{[} f(x\+\_\+1,x\+\_\+2) = \textbackslash{}sum\+\_\+\{\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0212ca86d5969b023039861ae8e472f8}{i}}=1\}$^\wedge$2 \textbackslash{}frac\{\textbackslash{}partial$^\wedge$2 u\+\_\+0\}\{\textbackslash{}partial x\+\_\+i$^\wedge$2\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}Source\+Fct\mbox{]}@ \textbackslash{}f\mbox{]} and \textbackslash{}f\mbox{[} \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}} = \textbackslash{}left. \textbackslash{}frac\{\textbackslash{}partial u\+\_\+0\}\{\textbackslash{}partial n\} \textbackslash{}right$\vert$\+\_\+\{x\+\_\+1=1\} = \textbackslash{}left. \textbackslash{}frac\{\textbackslash{}partial u\+\_\+0\}\{\textbackslash{}partial x\+\_\+1\} \textbackslash{}right$\vert$\+\_\+\{x\+\_\+1=1\}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}Flux\+Fct\mbox{]}@ \textbackslash{}f\mbox{]} so that \textbackslash{}f\$ u\+\_\+0(x\+\_\+1,x\+\_\+2) \textbackslash{}f\$ is the exact solution of the problem. For large values of \textbackslash{}f\$ \textbackslash{}alpha \textbackslash{}f\$ the solution approaches a step function \textbackslash{}f\mbox{[} u\+\_\+\{step\}(x\+\_\+1,x\+\_\+2) = \textbackslash{}left\textbackslash{}\{ \textbackslash{}begin\{array\}\{rl\} -\/1 \& \textbackslash{}mbox \{for \$x\+\_\+2 $<$ x\+\_\+1 \textbackslash{} \textbackslash{}tan\textbackslash{}\+Phi\$\} \textbackslash{}\textbackslash{} 1 \& \textbackslash{}mbox \{for \$x\+\_\+2 $>$ x\+\_\+1 \textbackslash{} \textbackslash{}tan\textbackslash{}\+Phi\$\} \textbackslash{}end\{array\} \textbackslash{}right. \textbackslash{}f\mbox{]} and presents a serious challenge for any numerical method. The figure below compares the numerical and exact solutions for \textbackslash{}f\$ \textbackslash{}alpha = 1 \textbackslash{}f\$ and \textbackslash{}f\$ \textbackslash{}Phi = 45$^\wedge$o \textbackslash{}f\$. @I w 0.\+75\textbackslash{}textwidth soln \char`\"{}Plot of the solution \char`\"{} Most of the driver code is identical to the code that solves the $<$A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$ equivalent \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} without Neumann boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}}$<$/A$>$. Therefore we only provide a detailed discussion of those functions that needed to be changed to accommodate the Neumann boundary conditions. $<$HR$>$ $<$HR$>$ \textbackslash{}section global Global parameters and functions As in the Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}, we define the source function (@R\mbox{[}Source\+Fct\mbox{]}@) and the exact solution (@R\mbox{[}Exact\+Soln\mbox{]}@), together with the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} parameters \textbackslash{}f\$ \textbackslash{}tan \textbackslash{}Phi \textbackslash{}f\$ and \textbackslash{}f\$ \textbackslash{}alpha \textbackslash{}f\$, in a namespace \textbackslash{}c Tanh\+Soln\+For\+Poisson. We add the function \textbackslash{}c \mbox{\hyperlink{namespaceTanhSolnForPoisson_a0e99ccf27df36f28f091de6d57484172}{Tanh\+Soln\+For\+Poisson\+::prescribed\+\_\+flux\+\_\+on\+\_\+fixed\+\_\+x\+\_\+boundary}}(...) which computes the prescribed flux \textbackslash{}f\$ \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}{g\+\_\+0}} \textbackslash{}f\$ required in the Neumann boundary condition (@R\mbox{[}2D\+Poisson\+\_\+flux\+BC\mbox{]}@). The function evaluates \textbackslash{}f\$ \textbackslash{}partial u\+\_\+0 /\textbackslash{}partial n = \{\textbackslash{}bf N\} \textbackslash{}cdot \textbackslash{}nabla u\+\_\+0 \textbackslash{}f\$ for the normal direction specified by the vector \textbackslash{}f\$ \{\textbackslash{}bf N\} = (1,0)$^\wedge$T. \textbackslash{}f\$ \textbackslash{}dontinclude two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+namespace \textbackslash{}until end of namespace $<$HR$>$ $<$HR$>$ \textbackslash{}section \mbox{\hyperlink{two__d__poisson__flux__bc_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}} The driver code The driver code is very similar to that for the $<$A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$pure Dirichlet problem\+:$<$/A$>$ We set up the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}, check its integrity and define the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} parameters. Following this, we solve the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} for a number of \textbackslash{}f\$ \textbackslash{}alpha \textbackslash{}f\$ values and document the solution. \textbackslash{}dontinclude two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+main \textbackslash{}until end of \mbox{\hyperlink{two__d__poisson__flux__bc_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}} $<$HR$>$ $<$HR$>$ \textbackslash{}section \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} The \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} class The \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} class is virtually identical to that used for the $<$A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$pure Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}$<$/A$>$\+: The only difference is that the class now contains an additional private data member, \textbackslash{}c \mbox{\hyperlink{classFluxPoissonProblem_a1ee0cfcbc307252430a3a5ba7ab7fd6e}{Flux\+Poisson\+Problem\+::\+Npoisson\+\_\+elements}}, which stores the number of 2D \char`\"{}bulk\char`\"{} elements in the mesh, and an additional private member function \textbackslash{}c \mbox{\hyperlink{classFluxPoissonProblem_a542ce9cc1c4e17eae68d51d2e13ac0c3}{Flux\+Poisson\+Problem\+::create\+\_\+flux\+\_\+elements}}(...). pwd \textbackslash{}dontinclude two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+cc \textbackslash{}skipline start\+\_\+of\+\_\+problem\+\_\+class \textbackslash{}until end of \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} class \mbox{[}See the discussion of the $<$A H\+R\+EF=\char`\"{}../../../poisson/one\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$ 1D Poisson \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}$<$/A$>$ for a more detailed discussion of the function type Poisson\+Equations$<$2$>$\+::Poisson\+Source\+Fct\+Pt.\mbox{]} $<$HR$>$ $<$HR$>$ \textbackslash{}section constructor The Problem constructor The first part of the \textbackslash{}c Problem constructor is identical to that used for the $<$A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$pure Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}$<$/A$>$\+: We create a 2D Mesh consisting of 4x4 quadrilateral Poisson elements\+: \textbackslash{}skipline start\+\_\+of\+\_\+constructor \textbackslash{}until \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a7c73c0d381a5a4a7df3d1c1e0e1e7d0c}{mesh\+\_\+pt}} Before continuing, we store the number of 2D \char`\"{}bulk\char`\"{} Poisson elements in the variable \textbackslash{}c Flux\+Poisson\+Problem\+::\+Npoisson\+\_\+element\+: \textbackslash{}skipline Store \textbackslash{}until Npoisson Now, we need to apply the prescribed-\/flux boundary condition along the Neumann boundary \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{Neumann\} \textbackslash{}f\$. The documentation for the \textbackslash{}c Simple\+Rectangular\+Quad\+Mesh shows that this boundary is mesh boundary 1. The necessary steps are performed by the function \textbackslash{}c create\+\_\+flux\+\_\+elements(..), described in the section \textbackslash{}ref create\+\_\+flux below. \textbackslash{}skipline Create prescribed \textbackslash{}until create\+\_\+flux The rest of the constructor is very similar to its counterpart in the $<$A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson/html/index.\+html\char`\"{}$>$pure Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}}$<$/A$>$. First we apply Dirichlet \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} on the remaining boundaries by pinning the nodal values. Next, we finish the \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} setup by looping over all \char`\"{}bulk\char`\"{} Poisson elements and set the pointer to the source function. Since we have added the \textbackslash{}c Poisson\+Flux\+Elements to the \textbackslash{}c Mesh, only the first \textbackslash{}c Npoisson\+\_\+element elements are \char`\"{}bulk\char`\"{} elements and the loop is restricted to these. We then perform a second loop over the \textbackslash{}c Poisson\+Flux\+Elements which need to be passed the pointer to the prescribed-\/flux function \textbackslash{}c \mbox{\hyperlink{namespaceTanhSolnForPoisson_a0e99ccf27df36f28f091de6d57484172}{Tanh\+Soln\+For\+Poisson\+::prescribed\+\_\+flux\+\_\+on\+\_\+fixed\+\_\+x\+\_\+boundary}}(...). Finally, we generate the equation numbering scheme. \textbackslash{}skipline Set the boundary \textbackslash{}until end of constructor $<$HR$>$ $<$HR$>$ \textbackslash{}section create\+\_\+flux Creating the flux elements \textbackslash{}c oomph-\/lib provides an element type \textbackslash{}c Poisson\+Flux\+Element, which allows the application of Neumann (flux) boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} along the \char`\"{}faces\char`\"{} of higher-\/dimensional \char`\"{}bulk\char`\"{} Poisson elements. \textbackslash{}c Poisson\+Flux\+Elements are templated by the type of the corresponding higher-\/dimensional \char`\"{}bulk\char`\"{} element, so that a \textbackslash{}c Poisson\+Flux\+Element$<$Q\+Poisson\+Element$<$2,3$>$ $>$ is a one-\/dimensional three-\/node element that applies Neumann boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} along the one-\/dimensional edge of a nine-\/node quadrilateral Poisson element. Similarly, a \textbackslash{}c Poisson\+Flux\+Element$<$Q\+Poisson\+Element$<$3,2$>$ $>$ is a two-\/dimensional quadrilateral four-\/node element that applies Neumann boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} along the two-\/dimensional face of a eight-\/node brick-\/shaped Poisson element}



Definition at line 210 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a4db815975fe5a6bb5ab498ab0b08182e}\label{two__d__poisson__flux__bc_8txt_a4db815975fe5a6bb5ab498ab0b08182e}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!close@{close}}
\index{close@{close}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{close()}{close()}}
{\footnotesize\ttfamily some\+\_\+file close (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a7af92336b728ac7ac4c4e00db8416246}\label{two__d__poisson__flux__bc_8txt_a7af92336b728ac7ac4c4e00db8416246}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!constant@{constant}}
\index{constant@{constant}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{constant()}{constant()}}
{\footnotesize\ttfamily etc The constructor of the c Poisson\+Flux\+Element takes two and are located next to mesh boundary and along this boundary the element s coordinate f s\+\_\+0 f has a constant (\begin{DoxyParamCaption}\item[{maximum}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_aa1b732f59a1563bf877837102dbc1462}\label{two__d__poisson__flux__bc_8txt_aa1b732f59a1563bf877837102dbc1462}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!difficult@{difficult}}
\index{difficult@{difficult}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{difficult()}{difficult()}}
{\footnotesize\ttfamily etc The constructor of the c Poisson\+Flux\+Element takes two and are located next to mesh boundary and along this boundary the element s coordinate f s\+\_\+0 f has a the determination of the face index can be more difficult (\begin{DoxyParamCaption}\item[{or at least very}]{tedious }\end{DoxyParamCaption})}

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_aa0179aaad42ada3cc81a968b2f120161}\label{two__d__poisson__flux__bc_8txt_aa0179aaad42ada3cc81a968b2f120161}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!hand@{hand}}
\index{hand@{hand}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{hand()}{hand()}}
{\footnotesize\ttfamily see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by hand (\begin{DoxyParamCaption}\item[{excluding the \textbackslash{}c}]{Poisson\+Flux\+Elements }\end{DoxyParamCaption})}

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a7c73c0d381a5a4a7df3d1c1e0e1e7d0c}\label{two__d__poisson__flux__bc_8txt_a7c73c0d381a5a4a7df3d1c1e0e1e7d0c}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!mesh\_pt@{mesh\_pt}}
\index{mesh\_pt@{mesh\_pt}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{mesh\_pt()}{mesh\_pt()}}
{\footnotesize\ttfamily mesh\+\_\+pt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) -\/$>$  compute\+\_\+error(some\+\_\+file, \mbox{\hyperlink{namespaceTanhSolnForPoisson_af7896e9c18ce6438c73ae2a875e8b7de}{Tanh\+Soln\+For\+Poisson\+::get\+\_\+exact\+\_\+u}}, \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}}, \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a3bb09fda90c0006dbfa90d31248da3db}{norm}})}



Referenced by Flux\+Poisson\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::actions\+\_\+before\+\_\+newton\+\_\+solve(), Flux\+Poisson\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::create\+\_\+flux\+\_\+elements(), Flux\+Poisson\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::doc\+\_\+solution(), and Flux\+Poisson\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::\+Flux\+Poisson\+Problem().

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_af77a465e0d1816259c8ab5349a359efd}\label{two__d__poisson__flux__bc_8txt_af77a465e0d1816259c8ab5349a359efd}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!open@{open}}
\index{open@{open}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{open()}{open()}}
{\footnotesize\ttfamily some\+\_\+file open (\begin{DoxyParamCaption}\item[{filename}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a462d003ce9bafedfd4d5eab9bf2d7f0c}\label{two__d__poisson__flux__bc_8txt_a462d003ce9bafedfd4d5eab9bf2d7f0c}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!our@{our}}
\index{our@{our}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{our()}{our()}}
{\footnotesize\ttfamily see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by or a suitable \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}} measure would have to be defined in the c Poisson\+Flux\+Elements We do not pursue either approach here because the difficulty is a direct consequence of our (\begin{DoxyParamCaption}\item[{questionable}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a844fc4763d586f380d443a31d47359d9}\label{two__d__poisson__flux__bc_8txt_a844fc4763d586f380d443a31d47359d9}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!sprintf@{sprintf}}
\index{sprintf@{sprintf}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{sprintf()}{sprintf()}}
{\footnotesize\ttfamily sprintf (\begin{DoxyParamCaption}\item[{filename}]{,  }\item[{\char`\"{}\%s/\mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}}\%i.\+dat\char`\"{}}]{,  }\item[{doc\+\_\+info.}]{directory).\+c\+\_\+str(,  }\item[{doc\+\_\+info.}]{number() }\end{DoxyParamCaption})}



Referenced by Flux\+Poisson\+Problem$<$ E\+L\+E\+M\+E\+N\+T $>$\+::doc\+\_\+solution().



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_ad8c4bb14a8307f2f39780b9b5b3d93ad}\label{two__d__poisson__flux__bc_8txt_ad8c4bb14a8307f2f39780b9b5b3d93ad}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!arguments@{arguments}}
\index{arguments@{arguments}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{arguments}{arguments}}
{\footnotesize\ttfamily etc The constructor of the c Poisson\+Flux\+Element takes two arguments}



Definition at line 222 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}\label{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!conditions@{conditions}}
\index{conditions@{conditions}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{conditions}{conditions}}
{\footnotesize\ttfamily mainpage Demo we demonstrate how to solve a Poisson \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}{problem}} with Neumann boundary conditions}



Definition at line 4 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}\label{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!error@{error}}
\index{error@{error}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{error}{error}}
{\footnotesize\ttfamily endcode in c doc\+\_\+solution (...). What happens when you run the code? The code\textquotesingle{}s behaviour illustrates a general convention in \textbackslash{}c oomph-\/lib if the function is not the virtual broken function throws an error}



Definition at line 338 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}\label{two__d__poisson__flux__bc_8txt_a0022af7faa293cc1cbc15fe75d43838a}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!g\_0@{g\_0}}
\index{g\_0@{g\_0}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{g\_0}{g\_0}}
{\footnotesize\ttfamily see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by or a suitable \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}} measure would have to be defined in the c Poisson\+Flux\+Elements We do not pursue either approach here because the difficulty is a direct consequence of the practice introduces additional difficulties in refineable problems and we shall demonstrate$<$A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc2/html/index.\+html\char`\"{}$>$ an alternative approach in another example$<$/A$>$ skipline start\+\_\+of\+\_\+doc until end of doc$<$HR$>$$<$HR$>$ section exercises Exercises and Comments but leave the nodes on the Neumann boundary un pinned Compare the computational result to those obtained when you set the prescribed flux to f g\+\_\+0}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= 0 \(\backslash\)f\$. Does \textcolor{keyword}{this} make sense? }
\DoxyCodeLine{   [Hint: Remember the \textcolor{stringliteral}{"natural"} boundary \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a387aa3469e52ef3b0f77f88ca600d05d}{conditions}} \textcolor{keywordflow}{for}}
\DoxyCodeLine{   Poisson\textcolor{stringliteral}{'s equation].}}
\DoxyCodeLine{\textcolor{stringliteral}{-\/\# Try to compute the error of the computed solution by}}
\DoxyCodeLine{\textcolor{stringliteral}{   re-\/instating the global error checking procedure}}
\DoxyCodeLine{\textcolor{stringliteral}{   \(\backslash\)code}}
\DoxyCodeLine{\textcolor{stringliteral}{   }}
\DoxyCodeLine{\textcolor{stringliteral}{   }}
\DoxyCodeLine{\textcolor{stringliteral}{   double error}}

\end{DoxyCode}


Definition at line 298 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_ab25a8a9873224dd0667732bbde3a41aa}\label{two__d__poisson__flux__bc_8txt_ab25a8a9873224dd0667732bbde3a41aa}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!Incidentally@{Incidentally}}
\index{Incidentally@{Incidentally}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{Incidentally}{Incidentally}}
{\footnotesize\ttfamily endcode in c doc\+\_\+solution (...). What happens when you run the code? The code\textquotesingle{}s behaviour illustrates a general convention in \textbackslash{}c oomph-\/lib if the function is not the virtual broken function throws an allowing a traceback in a debugger to find out where the broken function was called from We note that this practice is not universally approved of in the C community but we believe it to have its place in situations such as the one described here n n Incidentally}



Definition at line 344 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a3bb09fda90c0006dbfa90d31248da3db}\label{two__d__poisson__flux__bc_8txt_a3bb09fda90c0006dbfa90d31248da3db}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!norm@{norm}}
\index{norm@{norm}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{norm}{norm}}
{\footnotesize\ttfamily see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by or a suitable \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}} measure would have to be defined in the c Poisson\+Flux\+Elements We do not pursue either approach here because the difficulty is a direct consequence of the practice introduces additional difficulties in refineable problems and we shall demonstrate$<$A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc2/html/index.\+html\char`\"{}$>$ an alternative approach in another example$<$/A$>$ skipline start\+\_\+of\+\_\+doc until end of doc$<$HR$>$$<$HR$>$ section exercises Exercises and Comments but leave the nodes on the Neumann boundary un pinned Compare the computational result to those obtained when you set the prescribed flux to f norm}



Definition at line 306 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_ad57194365c985b13bf163eb3693b62ef}\label{two__d__poisson__flux__bc_8txt_ad57194365c985b13bf163eb3693b62ef}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!overloaded@{overloaded}}
\index{overloaded@{overloaded}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{overloaded}{overloaded}}
{\footnotesize\ttfamily endcode in c doc\+\_\+solution (...). What happens when you run the code? The code\textquotesingle{}s behaviour illustrates a general convention in \textbackslash{}c oomph-\/lib if the function is not overloaded}



Definition at line 314 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}\label{two__d__poisson__flux__bc_8txt_a4074baada03976c061d5672f4237cca5}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!problem@{problem}}
\index{problem@{problem}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{problem}{problem}}
{\footnotesize\ttfamily mainpage Demo problem}



Definition at line 3 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.



Referenced by main().

\mbox{\Hypertarget{two__d__poisson__flux__bc_8txt_a1542fa0f99d318313858c9bb4403dd71}\label{two__d__poisson__flux__bc_8txt_a1542fa0f99d318313858c9bb4403dd71}} 
\index{two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}!zero@{zero}}
\index{zero@{zero}!two\_d\_poisson\_flux\_bc.txt@{two\_d\_poisson\_flux\_bc.txt}}
\doxysubsubsection{\texorpdfstring{zero}{zero}}
{\footnotesize\ttfamily see the section ref exercises for a more detailed discussion of broken virtual functions Error checking would therefore have to be implemented by or a suitable \mbox{\hyperlink{two__d__poisson__flux__bc_8txt_a6c0114d61baf5bb53ca063e763b7517a}{error}} measure would have to be defined in the c Poisson\+Flux\+Elements We do not pursue either approach here because the difficulty is a direct consequence of the practice introduces additional difficulties in refineable problems and we shall demonstrate$<$A H\+R\+EF=\char`\"{}../../../poisson/two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc2/html/index.\+html\char`\"{}$>$ an alternative approach in another example$<$/A$>$ skipline start\+\_\+of\+\_\+doc until end of doc$<$HR$>$$<$HR$>$ section exercises Exercises and Comments but leave the nodes on the Neumann boundary un pinned Compare the computational result to those obtained when you set the prescribed flux to zero}



Definition at line 298 of file two\+\_\+d\+\_\+poisson\+\_\+flux\+\_\+bc.\+txt.

