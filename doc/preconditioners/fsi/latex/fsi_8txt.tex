\hypertarget{fsi_8txt}{}\doxysection{fsi.\+txt File Reference}
\label{fsi_8txt}\index{fsi.txt@{fsi.txt}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
mainpage oomph lib s fluid structure \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} (F\+SI) \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} The purpose of \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} tutorial is to show how to use \textbackslash{}c oomph-\/lib \textquotesingle{}s F\+SI \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} for the efficient monolithic solution of fluid-\/structure interaction problems. We illustrate the use of the \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} for the collapsible channel problem described in the$<$ a href
\item 
n Next we identify the meshes that contain the fluid and solid elements \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} information is required by c oomph lib s block preconditioning framework to identify the types of the various degrees of freedom in the \mbox{\hyperlink{fsi_8txt_a406d12650934a59b08777d3dc08700f2}{Jacobian}} matrix Identifying the fluid elements is straightforward as they are already contained in a \mbox{\hyperlink{fsi_8txt_ae9587fbec5cdde3d14be852a7bdea2ac}{distinct}} (sub-\/) mesh
\item 
n The linear systems involving the fluid block are \mbox{\hyperlink{fsi_8txt_a7b3a4305e86f1c56c6178940dc93486e}{solved}} (approximately) by \textbackslash{}c oomph-\/lib \textquotesingle{}s Least-\/Squares-\/Commutator Navier-\/Stokes \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} \textbackslash{}c Navier\+Stokes\+L\+S\+C\+Preconditioner
\item 
n The linear systems involving the fluid block are discussed in$<$ a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ another tutorial$<$/a $>$ The behaviour of \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} (sub-\/) \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} may be customised too. For instance
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} arises through the fluid loading on the wall c oomph lib s algebraic node update strategy ensures that the \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} \mbox{\hyperlink{fsi_8txt_a712156b6acd5bdcc8656c6e89a759069}{matrices}} are very sparse The maximum fill level for the examples presented in$<$ a href=\char`\"{}http\+: Hazel \textbackslash{}\& Boyle\textquotesingle{}s (2008) paper $<$/a$>$is about 3\% and such (relatively) large values only arose in computations with very coarse meshes; the much finer meshes usedin typical production runs resulted in much sparser matrices.\+We showed in an earlier paper \mbox{[}$<$a href=\char`\"{}http\+:for the fully-\/coupled solution of large-\/displacement fluid-\/structureinteraction problems\char`\"{}. Computer Methods in Applied Mechanics and\+Engineering \textbackslash{}b 193, 1-\/23, (2004)$<$/a$>$\mbox{]} that the use of block-\/triangular approximations to the global \mbox{\hyperlink{fsi_8txt_a406d12650934a59b08777d3dc08700f2}{Jacobian}} matrix, obtained by neglecting the fluid-\/solid or solid-\/fluid \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} blocks,\textbackslash{}\mbox{\hyperlink{fsi_8txt_ab253f3ff083204a1344dc536991a3192}{f}}\mbox{[}\{\textbackslash{}cal P\}\+\_\+1 = \textbackslash{}left(\textbackslash{}begin\{array\}\{cc$\vert$c\}\{\textbackslash{}bf F\} \& \{\textbackslash{}bf G\} \& \{\textbackslash{}bf 0\} \textbackslash{}\textbackslash{}\{\textbackslash{}bf D\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf 0\} \textbackslash{}\textbackslash{}\textbackslash{}hline\{\textbackslash{}bf C\}\+\_\+\{su\} \& \{\textbackslash{}bf C\}\+\_\+\{sp\} \& \{\textbackslash{}bf S\} \textbackslash{}end\{array\}\textbackslash{}right)\textbackslash{}mbox\{\textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \} \{\textbackslash{}cal P\}\+\_\+2 = \textbackslash{}left(\textbackslash{}begin\{array\}\{cc$\vert$c\}\{\textbackslash{}bf F\} \& \{\textbackslash{}bf G\} \& \{\textbackslash{}bf C\}\+\_\+\{us\} \textbackslash{}\textbackslash{}\{\textbackslash{}bf D\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf C\}\+\_\+\{ps\} \textbackslash{}\textbackslash{}\textbackslash{}hline\{\textbackslash{}bf 0\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf S\} \textbackslash{}end\{array\}\textbackslash{}right)\textbackslash{}mbox\{\textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \} \{\textbackslash{}cal P\}\+\_\+3 = \textbackslash{}left(\textbackslash{}begin\{array\}\{cc$\vert$c\}\{\textbackslash{}bf F\} \& \{\textbackslash{}bf G\} \& \{\textbackslash{}bf 0\} \textbackslash{}\textbackslash{}\{\textbackslash{}bf D\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf 0\} \textbackslash{}\textbackslash{}\textbackslash{}hline\{\textbackslash{}bf 0\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf S\} \textbackslash{}end\{array\}\textbackslash{}right)\textbackslash{}\mbox{\hyperlink{fsi_8txt_ab253f3ff083204a1344dc536991a3192}{f}}\mbox{]}in the Newton method seriously degrades its performance, resultingin the loss of its quadratic convergence and thus one of its the mostattractive features. However, the block-\/triangular approximations were shown to be excellent preconditioners for the solution of the linear systemby Krylov subspace methods. Becauseof their block-\/triangular structure, each application of thepreconditioners involves linear solves with each of the twosingle-\/physics systems (@R\mbox{[}fluid\mbox{]}@) and (@R\mbox{[}solid\mbox{]}@), and matrix-\/vector products with the retained \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} matrices. The current implementation of the F\+SI \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} within \textbackslash{}coomph-\/lib employs Elman, Silvester \textbackslash{}\& Wathen\textquotesingle{}s \`{}\`{}least squarescommutator\textquotesingle{}\textquotesingle{} (L\+SC) \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}}, $<$a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$discussed in another tutorial$<$/a$>$ to approximately solve the linearsystem involving the fluid matrix (@R\mbox{[}fluid\mbox{]}@).$<$HR$>$$<$HR$>$\textbackslash{}section example An example\+To demonstrate how to use the \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}}, here arethe relevant extracts from the $<$A H\+R\+EF=\char`\"{}../../../../demo\+\_\+drivers/\mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}}/fsi\+\_\+channel\+\_\+seg\+\_\+and\+\_\+precond/fsi\+\_\+chan\+\_\+precond\+\_\+driver.\+cc\char`\"{}$>$driver code $<$code$>$fsi\+\_\+chan\+\_\+precond\+\_\+driver.\+cc$<$/code$>$$<$/A$>$which solves the collapsible channel problem discussed in$<$a href=\char`\"{}../../../interaction/fsi\+\_\+channel\+\_\+segregated\+\_\+solver/html/index.\+html\char`\"{}$>$another tutorial.$<$/a$>$ As explained in the $<$a href=\char`\"{}../../../linear\+\_\+solvers/html/index.\+html\char`\"{}$>$Linear\+Solvers Tutorial$<$/A$>$ switching to an iterative linear solveris typically performed in the \textbackslash{}c Problem constructor and involvesa few straightforward steps\+:-\/\# $<$b$>$Create an instance of the Iterative\+Linear\+Solver and pass it to the Problem$<$/b$>$ \textbackslash{}n\textbackslash{}n We create an instance of \textbackslash{}c G\+M\+R\+ES, \textbackslash{}n\textbackslash{}n \textbackslash{}dontinclude fsi\+\_\+chan\+\_\+precond\+\_\+driver.\+cc \textbackslash{}skipline Build \textbackslash{}until new G\+M\+R\+ES \textbackslash{}n set the maximum number of iterations to 100, and increase the G\+M\+R\+ES convergence tolerance to \textbackslash{}f\$ 10$^\wedge$\{-\/6\} \textbackslash{}f\$ as experiments showed \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} to give the fastest overall solve times; see \textbackslash{}ref comm\+\_\+ex. \textbackslash{}n\textbackslash{}n \textbackslash{}until iterative\+\_\+linear\+\_\+solver\+\_\+pt-\/$>$tolerance() \textbackslash{}n Finally, we pass the pointer to the iterative linear solver to the problem.\textbackslash{}n\textbackslash{}n \textbackslash{}skipline \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}}-\/$>$ linear\+\_\+solver n n Iterative\+Linear\+Solver$<$/b$>$ n n We start by creating an instance of the F\+SI \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} n n skipline until F\+S\+I\+Preconditioner$\ast$ \mbox{\hyperlink{fsi_8txt_a74da23730d99ddd48951640ea09874a6}{prec\+\_\+pt}} =new F\+S\+I\+Preconditioner(\mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}})
\item 
n Next we identify the meshes that contain the fluid and solid elements \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} information is required by c oomph lib s block preconditioning framework to identify the types of the various degrees of freedom in the \mbox{\hyperlink{fsi_8txt_a406d12650934a59b08777d3dc08700f2}{Jacobian}} matrix Identifying the fluid elements is straightforward as they are already contained in a accessible via the member function c bulk\+\_\+mesh\+\_\+pt() see the brief discussion of \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} in$<$ a href=\char`\"{}../../../interaction/fsi\+\_\+channel\+\_\+segregated\+\_\+solver/html/index.\+html\char`\"{}$>$ another tutorial$<$/a $>$ We classify the external pressure as a solid mechanics degree of freedom and therefore add the c Displacement\+Control\+Element to a combined solid mesh(constructed from a vector of pointers to its constituent sub-\/meshes) n The preconditioner is now fully functional and we pass a pointer to it to the \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}}
\item 
n The c F\+S\+I\+Preconditioner allows preconditioning to be performed with either one of the three block triangular approximations to the \mbox{\hyperlink{fsi_8txt_a406d12650934a59b08777d3dc08700f2}{Jacobian}}
\item 
n which retains the \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} \mbox{\hyperlink{fsi_8txt_a712156b6acd5bdcc8656c6e89a759069}{matrices}} \mbox{\hyperlink{fsi_8txt_ab253f3ff083204a1344dc536991a3192}{f}}
\item 
n which suppresses all the \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} \mbox{\hyperlink{fsi_8txt_a712156b6acd5bdcc8656c6e89a759069}{matrices}}
\item 
n The linear systems involving the fluid block are discussed in$<$ a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ another tutorial$<$/a $>$ The behaviour of to employ the c Hypre A\+MG solver to solve the linear systems involving the pressure Schur complement matrix we use the procedure discussed$<$ a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ \mbox{\hyperlink{fsi_8txt_ae6d21ed195992366b4df300b17f6d7b3}{earlier$<$/a $>$}}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{fsi_8txt_ae9587fbec5cdde3d14be852a7bdea2ac}\label{fsi_8txt_ae9587fbec5cdde3d14be852a7bdea2ac}} 
\index{fsi.txt@{fsi.txt}!distinct@{distinct}}
\index{distinct@{distinct}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{distinct()}{distinct()}}
{\footnotesize\ttfamily n Next we identify the meshes that contain the fluid and solid elements \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} information is required by c oomph lib s block preconditioning framework to identify the types of the various degrees of freedom in the \mbox{\hyperlink{fsi_8txt_a406d12650934a59b08777d3dc08700f2}{Jacobian}} matrix Identifying the fluid elements is straightforward as they are already contained in a distinct (\begin{DoxyParamCaption}\item[{sub-\/}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}\label{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}} 
\index{fsi.txt@{fsi.txt}!interaction@{interaction}}
\index{interaction@{interaction}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{interaction()}{interaction()}}
{\footnotesize\ttfamily mainpage oomph lib s fluid structure interaction (\begin{DoxyParamCaption}\item[{F\+SI}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{fsi_8txt_a7b3a4305e86f1c56c6178940dc93486e}\label{fsi_8txt_a7b3a4305e86f1c56c6178940dc93486e}} 
\index{fsi.txt@{fsi.txt}!solved@{solved}}
\index{solved@{solved}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{solved()}{solved()}}
{\footnotesize\ttfamily n The linear systems involving the fluid block are solved (\begin{DoxyParamCaption}\item[{approximately}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}\label{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}} 
\index{fsi.txt@{fsi.txt}!this@{this}}
\index{this@{this}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{this()}{this()}}
{\footnotesize\ttfamily n The linear systems involving the fluid block are discussed in$<$a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ another tutorial$<$/a$>$ The behaviour of this (\begin{DoxyParamCaption}\item[{sub-\/}]{ }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{fsi_8txt_ae6d21ed195992366b4df300b17f6d7b3}\label{fsi_8txt_ae6d21ed195992366b4df300b17f6d7b3}} 
\index{fsi.txt@{fsi.txt}!earlier$<$/a $>$@{earlier$<$/a $>$}}
\index{earlier$<$/a $>$@{earlier$<$/a $>$}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{earlier$<$/a $>$}{earlier</a >}}
{\footnotesize\ttfamily n The linear systems involving the fluid block are discussed in$<$a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ another tutorial$<$/a$>$ The behaviour of to employ the c Hypre A\+MG solver to solve the linear systems involving the pressure Schur complement matrix we use the procedure discussed$<$a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ earlier$<$/a $>$}



Definition at line 305 of file fsi.\+txt.

\mbox{\Hypertarget{fsi_8txt_ab253f3ff083204a1344dc536991a3192}\label{fsi_8txt_ab253f3ff083204a1344dc536991a3192}} 
\index{fsi.txt@{fsi.txt}!f@{f}}
\index{f@{f}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{f}{f}}
{\footnotesize\ttfamily n The linear systems involving the fluid block are discussed in$<$ a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ another tutorial$<$/a $>$ The behaviour of to employ the c Hypre A\+MG solver to solve the linear systems involving the pressure Schur complement matrix f}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{\(\backslash\)bf C\}\_\{*s\} \mbox{\hyperlink{fsi_8txt_ab253f3ff083204a1344dc536991a3192}{\(\backslash\)f}}\$ that represent}
\DoxyCodeLine{      the effect of the solid onto the fluid:}
\DoxyCodeLine{      \(\backslash\)n\(\backslash\)n}
\DoxyCodeLine{      \(\backslash\)dontinclude fsi\_chan\_precond\_driver.cc
      \(\backslash\)skipline 
      \(\backslash\)until  \mbox{\hyperlink{fsi_8txt_a74da23730d99ddd48951640ea09874a6}{prec\_pt}}-\/>use\_block\_triangular\_version\_with\_solid\_on\_fluid()}

\end{DoxyCode}


Definition at line 265 of file fsi.\+txt.

\mbox{\Hypertarget{fsi_8txt_a406d12650934a59b08777d3dc08700f2}\label{fsi_8txt_a406d12650934a59b08777d3dc08700f2}} 
\index{fsi.txt@{fsi.txt}!Jacobian@{Jacobian}}
\index{Jacobian@{Jacobian}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{Jacobian}{Jacobian}}
{\footnotesize\ttfamily n The c F\+S\+I\+Preconditioner allows preconditioning to be performed with either one of the three block triangular approximations to the Jacobian}



Definition at line 261 of file fsi.\+txt.

\mbox{\Hypertarget{fsi_8txt_a712156b6acd5bdcc8656c6e89a759069}\label{fsi_8txt_a712156b6acd5bdcc8656c6e89a759069}} 
\index{fsi.txt@{fsi.txt}!matrices@{matrices}}
\index{matrices@{matrices}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{matrices}{matrices}}
{\footnotesize\ttfamily n which suppresses all the \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} matrices}



Definition at line 277 of file fsi.\+txt.

\mbox{\Hypertarget{fsi_8txt_a74da23730d99ddd48951640ea09874a6}\label{fsi_8txt_a74da23730d99ddd48951640ea09874a6}} 
\index{fsi.txt@{fsi.txt}!prec\_pt@{prec\_pt}}
\index{prec\_pt@{prec\_pt}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{prec\_pt}{prec\_pt}}
{\footnotesize\ttfamily \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} arises through the fluid loading on the wall c oomph lib s algebraic node update strategy ensures that the \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} \mbox{\hyperlink{fsi_8txt_a712156b6acd5bdcc8656c6e89a759069}{matrices}} are very sparse The maximum fill level for the examples presented in$<$a href=\char`\"{}http\+: Hazel \textbackslash{}\& Boyle\textquotesingle{}s (2008) paper $<$/a$>$is about 3\% and such (relatively) large values only arose in computations with very coarse meshes; the much finer meshes usedin typical production runs resulted in much sparser matrices.\+We showed in an earlier paper \mbox{[}$<$a href=\char`\"{}http\+:for the fully-\/coupled solution of large-\/displacement fluid-\/structureinteraction problems\char`\"{}. Computer Methods in Applied Mechanics and\+Engineering \textbackslash{}b 193, 1-\/23, (2004)$<$/a$>$\mbox{]} that the use of block-\/triangular approximations to the global \mbox{\hyperlink{fsi_8txt_a406d12650934a59b08777d3dc08700f2}{Jacobian}} matrix, obtained by neglecting the fluid-\/solid or solid-\/fluid \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} blocks,\textbackslash{}\mbox{\hyperlink{fsi_8txt_ab253f3ff083204a1344dc536991a3192}{f}}\mbox{[}\{\textbackslash{}cal P\}\+\_\+1 = \textbackslash{}left(\textbackslash{}begin\{array\}\{cc$\vert$c\}\{\textbackslash{}bf F\} \& \{\textbackslash{}bf G\} \& \{\textbackslash{}bf 0\} \textbackslash{}\textbackslash{}\{\textbackslash{}bf D\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf 0\} \textbackslash{}\textbackslash{}\textbackslash{}hline\{\textbackslash{}bf C\}\+\_\+\{su\} \& \{\textbackslash{}bf C\}\+\_\+\{sp\} \& \{\textbackslash{}bf S\} \textbackslash{}end\{array\}\textbackslash{}right)\textbackslash{}mbox\{\textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \} \{\textbackslash{}cal P\}\+\_\+2 = \textbackslash{}left(\textbackslash{}begin\{array\}\{cc$\vert$c\}\{\textbackslash{}bf F\} \& \{\textbackslash{}bf G\} \& \{\textbackslash{}bf C\}\+\_\+\{us\} \textbackslash{}\textbackslash{}\{\textbackslash{}bf D\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf C\}\+\_\+\{ps\} \textbackslash{}\textbackslash{}\textbackslash{}hline\{\textbackslash{}bf 0\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf S\} \textbackslash{}end\{array\}\textbackslash{}right)\textbackslash{}mbox\{\textbackslash{} \textbackslash{} and \textbackslash{} \textbackslash{} \} \{\textbackslash{}cal P\}\+\_\+3 = \textbackslash{}left(\textbackslash{}begin\{array\}\{cc$\vert$c\}\{\textbackslash{}bf F\} \& \{\textbackslash{}bf G\} \& \{\textbackslash{}bf 0\} \textbackslash{}\textbackslash{}\{\textbackslash{}bf D\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf 0\} \textbackslash{}\textbackslash{}\textbackslash{}hline\{\textbackslash{}bf 0\} \& \{\textbackslash{}bf 0\} \& \{\textbackslash{}bf S\} \textbackslash{}end\{array\}\textbackslash{}right)\textbackslash{}\mbox{\hyperlink{fsi_8txt_ab253f3ff083204a1344dc536991a3192}{f}}\mbox{]}in the Newton method seriously degrades its performance, resultingin the loss of its quadratic convergence and thus one of its the mostattractive features. However, the block-\/triangular approximations were shown to be excellent preconditioners for the solution of the linear systemby Krylov subspace methods. Becauseof their block-\/triangular structure, each application of thepreconditioners involves linear solves with each of the twosingle-\/physics systems (@R\mbox{[}fluid\mbox{]}@) and (@R\mbox{[}solid\mbox{]}@), and matrix-\/vector products with the retained \mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}} matrices. The current implementation of the F\+SI \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} within \textbackslash{}coomph-\/lib employs Elman, Silvester \textbackslash{}\& Wathen\textquotesingle{}s \`{}\`{}least squarescommutator\textquotesingle{}\textquotesingle{} (L\+SC) \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}}, $<$a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$discussed in another tutorial$<$/a$>$ to approximately solve the linearsystem involving the fluid matrix (@R\mbox{[}fluid\mbox{]}@).$<$HR$>$$<$HR$>$\textbackslash{}section example An example\+To demonstrate how to use the \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}}, here arethe relevant extracts from the $<$A H\+R\+EF=\char`\"{}../../../../demo\+\_\+drivers/\mbox{\hyperlink{fsi_8txt_ab0b35e161c605d5efbb9eef76300832a}{interaction}}/fsi\+\_\+channel\+\_\+seg\+\_\+and\+\_\+precond/fsi\+\_\+chan\+\_\+precond\+\_\+driver.\+cc\char`\"{}$>$driver code $<$code$>$fsi\+\_\+chan\+\_\+precond\+\_\+driver.\+cc$<$/code$>$$<$/A$>$which solves the collapsible channel problem discussed in$<$a href=\char`\"{}../../../interaction/fsi\+\_\+channel\+\_\+segregated\+\_\+solver/html/index.\+html\char`\"{}$>$another tutorial.$<$/a$>$ As explained in the $<$a href=\char`\"{}../../../linear\+\_\+solvers/html/index.\+html\char`\"{}$>$Linear\+Solvers Tutorial$<$/A$>$ switching to an iterative linear solveris typically performed in the \textbackslash{}c Problem constructor and involvesa few straightforward steps\+:-\/\# $<$b$>$Create an instance of the Iterative\+Linear\+Solver and pass it to the Problem$<$/b$>$ \textbackslash{}n\textbackslash{}n We create an instance of \textbackslash{}c G\+M\+R\+ES, \textbackslash{}n\textbackslash{}n \textbackslash{}dontinclude fsi\+\_\+chan\+\_\+precond\+\_\+driver.\+cc \textbackslash{}skipline Build \textbackslash{}until new G\+M\+R\+ES \textbackslash{}n set the maximum number of iterations to 100, and increase the G\+M\+R\+ES convergence tolerance to \textbackslash{}f\$ 10$^\wedge$\{-\/6\} \textbackslash{}f\$ as experiments showed \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} to give the fastest overall solve times; see \textbackslash{}ref comm\+\_\+ex. \textbackslash{}n\textbackslash{}n \textbackslash{}until iterative\+\_\+linear\+\_\+solver\+\_\+pt-\/$>$tolerance() \textbackslash{}n Finally, we pass the pointer to the iterative linear solver to the problem.\textbackslash{}n\textbackslash{}n \textbackslash{}skipline \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}}-\/$>$ linear\+\_\+solver n n Iterative\+Linear\+Solver$<$/b$>$ n n We start by creating an instance of the F\+SI \mbox{\hyperlink{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}{preconditioner}} n n skipline until F\+S\+I\+Preconditioner$\ast$ prec\+\_\+pt =new F\+S\+I\+Preconditioner(\mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}})}



Definition at line 209 of file fsi.\+txt.

\mbox{\Hypertarget{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}\label{fsi_8txt_ace0030d347128660e1c78b8c79cc5626}} 
\index{fsi.txt@{fsi.txt}!preconditioner@{preconditioner}}
\index{preconditioner@{preconditioner}!fsi.txt@{fsi.txt}}
\doxysubsubsection{\texorpdfstring{preconditioner}{preconditioner}}
{\footnotesize\ttfamily n Next we identify the meshes that contain the fluid and solid elements \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} information is required by c oomph lib s block preconditioning framework to identify the types of the various degrees of freedom in the \mbox{\hyperlink{fsi_8txt_a406d12650934a59b08777d3dc08700f2}{Jacobian}} matrix Identifying the fluid elements is straightforward as they are already contained in a accessible via the member function c bulk\+\_\+mesh\+\_\+pt () see the brief discussion of \mbox{\hyperlink{fsi_8txt_a1692deb755c5ee0148d1f93f3a9a3f4c}{this}} in$<$a href=\char`\"{}../../../interaction/fsi\+\_\+channel\+\_\+segregated\+\_\+solver/html/index.\+html\char`\"{}$>$ another tutorial$<$/a$>$ We classify the external pressure as a solid mechanics degree of freedom and therefore add the c Displacement\+Control\+Element to a combined solid mesh (constructed from a vector of pointers to its constituent sub-\/meshes) n The preconditioner is now fully functional and we pass a pointer to it to the preconditioner}



Definition at line 230 of file fsi.\+txt.

