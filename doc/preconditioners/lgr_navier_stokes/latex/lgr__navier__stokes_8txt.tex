\hypertarget{lgr__navier__stokes_8txt}{}\doxysection{lgr\+\_\+navier\+\_\+stokes.\+txt File Reference}
\label{lgr__navier__stokes_8txt}\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{lgr__navier__stokes_8txt_ac131914a186803ddf7a4d7fddfa83547}{Omega}} = \mbox{[}0, 1\mbox{]}$^\wedge$2\textbackslash{}f\$ by the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}} transformation \textbackslash{}f\mbox{[}R(\textbackslash{}alpha)=\textbackslash{}left(\textbackslash{}begin\{array\}\{cc\} \{\textbackslash{}cos(\textbackslash{}alpha)\} \&\{-\/\textbackslash{}sin(\textbackslash{}alpha)\} \textbackslash{}\textbackslash{} \{\textbackslash{}sin(\textbackslash{}alpha)\} \&\{\textbackslash{}cos(\textbackslash{}alpha)\} \textbackslash{}end\{array\} \textbackslash{}right), \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnrotation\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$\textbackslash{}alpha\textbackslash{}f\$ is the angle of rotation. The figure below show the flow field(velocity vectors and pressure contours) for a unit square domain rotated by an angle of \textbackslash{}f\$\textbackslash{}alpha=30$^\wedge$\textbackslash{}circ \textbackslash{}f\$ and a Reynolds number of \textbackslash{}f\$ Re=100 \textbackslash{}f\$. The flow is driven by a prescribed parabolic boundary condition. @I w 0.\+4\textbackslash{}textwidth Sim\+Ang30\+Rey100\+Noel4 \char`\"{}Velocity field and pressure contours.\char`\"{} For convenience, we present the boundary conditions for the non-\/rotated unit square \textbackslash{}f\$\textbackslash{}alpha=0$^\wedge$\{\textbackslash{}circ\}\textbackslash{}f\$. In order to obtain the boundary conditions for \textbackslash{}f\$\textbackslash{}alpha \textbackslash{}ne 0$^\wedge$\textbackslash{}circ\textbackslash{}f\$, we only have to apply the rotation( @R\mbox{[}eqnrotation\mbox{]}@). The flow is driven by imposing a parabolic velocity profile along the inflow boundary \textbackslash{}f\$\textbackslash{}\+Omega\+\_\+\+I\textbackslash{}f\$. Along the characteristic boundary, \textbackslash{}f\$\textbackslash{}\+Omega\+\_\+\+C\textbackslash{}f\$, the no-\/slip condition \textbackslash{}f \$u\+\_\+i=0\textbackslash{}f\$, \textbackslash{}f \$i=1, 2\textbackslash{}f\$, is prescribed. We impose \`{}parallel outflow\textquotesingle{} along the outlet \textbackslash{}f\$\textbackslash{}\+Omega\+\_\+\+O\textbackslash{}f\$ by insisting that \textbackslash{}f\mbox{[}\{\textbackslash{}bf u\}\textbackslash{}cdot \{\textbackslash{}bf t\}\+\_\+\{\}=0 \textbackslash{}mbox\{\textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} on \$\textbackslash{}Omega\+\_\+\{O\}\$,\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnbcpostrong\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$ \{\textbackslash{}bf t\}\textbackslash{}f\$ is the tangent vector at each discrete point on the boundary \textbackslash{}f\$ \textbackslash{}Omega\+\_\+\{O\}\textbackslash{}f\$. We weakly enforce the flow constraint by augmenting the Navier-\/Stokes momentum residual equation(introduced in the$<$ a href=\char`\"{}../../../navier\+\_\+stokes/rayleigh\+\_\+traction\+\_\+channel/html/index.\+html\char`\"{}$>$ Unsteady flow in a 2D channel, driven by an applied traction$<$/a $>$ tutorial) with a Lagrange multiplier term so that it becomes \textbackslash{}f\mbox{[}r\+\_\+\{il\}$^\wedge$\{u\}=\textbackslash{}int\+\_\+\textbackslash{}\+Omega \textbackslash{}left\mbox{[}Re \textbackslash{}left(St\textbackslash{}frac\{\textbackslash{}partial u\+\_\+i\}\{\textbackslash{}partial t\}+u\+\_\+j\textbackslash{}frac\{\textbackslash{}partial u\+\_\+i\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}right) \textbackslash{}psi\+\_\+l+\textbackslash{}tau\+\_\+\{ij\}\textbackslash{}frac\{\textbackslash{}partial \textbackslash{}psi\+\_\+l\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}right\mbox{]} d\textbackslash{}\+Omega -\/ \textbackslash{}int\+\_\+\{\textbackslash{}partial\textbackslash{}\+Omega\} \textbackslash{}tau\+\_\+\{ij\} n\+\_\+j\textbackslash{}psi\+\_\+l dS+\textbackslash{}delta \textbackslash{}Pi\+\_\+\{constraint\}=0, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnaugmentedresu\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\mbox{[}\textbackslash{}Pi\+\_\+\{constraint\}=\textbackslash{}int\+\_\+\{\textbackslash{}partial \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_ac131914a186803ddf7a4d7fddfa83547}{Omega}}\} \textbackslash{}lambda u\+\_\+i t\+\_\+i dS, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnlgrterm\mbox{]}@ \textbackslash{}f\mbox{]} and \textbackslash{}f\$\textbackslash{}lambda\textbackslash{}f\$ is the Lagrange multiplier. Upon taking the first variation of the constraint with respect to the unknown velocity and the Lagrange multiplier, the residual form of the constrained momentum equation is \textbackslash{}f\mbox{[}r\+\_\+\{il\}$^\wedge$\{u\}=\textbackslash{}int\+\_\+\textbackslash{}\+Omega \textbackslash{}left\mbox{[}Re \textbackslash{}left(St\textbackslash{}frac\{\textbackslash{}partial u\+\_\+i\}\{\textbackslash{}partial t\}+u\+\_\+j\textbackslash{}frac\{\textbackslash{}partial u\+\_\+i\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}right) \textbackslash{}psi\+\_\+l+\textbackslash{}tau\+\_\+\{ij\}\textbackslash{}frac\{\textbackslash{}partial \textbackslash{}psi\+\_\+l\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}right\mbox{]} d\textbackslash{}\+Omega -\/ \textbackslash{}int\+\_\+\{\textbackslash{}partial\textbackslash{}\+Omega\} \textbackslash{}tau\+\_\+\{ij\} n\+\_\+j\textbackslash{}psi\+\_\+l dS+\textbackslash{}int\+\_\+\{\textbackslash{}partial\textbackslash{}\+Omega\} \textbackslash{}lambda\textbackslash{}psi\+\_\+l t\+\_\+i=0. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnaugmentedresufirstvar\mbox{]}@ \textbackslash{}f\mbox{]} The weak formulation of( @R\mbox{[}eqnbcpostrong\mbox{]}@) is simply \textbackslash{}f\mbox{[}r\+\_\+\{l\}$^\wedge$\{\textbackslash{}lambda\}=\textbackslash{}int\+\_\+\textbackslash{}\+Omega u\+\_\+i t\+\_\+i \textbackslash{}psi$^\wedge$\textbackslash{}lambda dS=0, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnweakconstraint\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$\textbackslash{}psi$^\wedge$\textbackslash{}lambda\textbackslash{}f\$ is a suitable basis function. Equation( @R\mbox{[}eqnaugmentedresufirstvar\mbox{]}@) reveals that the Lagrange multipliers act as the(negative) tangential traction \textbackslash{}f\$(\textbackslash{}lambda=-\/\{\textbackslash{}mathbf\{n\}\}$^\wedge$T\{\textbackslash{}mathbf\{\textbackslash{}tau\}\}\{\textbackslash{}mathbf\{t\}\})\textbackslash{}f\$ that enforce the parallel flow across the boundary \textbackslash{}f\$\textbackslash{}partial\textbackslash{}\+Omega\+\_\+\{O\}\textbackslash{}f\$. We discretise this constraint by attaching \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Impose\+Parallel\+Outflow\+Elements to the boundaries of the \char`\"{}bulk\char`\"{} Navier-\/Stokes elements that are adjacent to \textbackslash{}f\$ \textbackslash{}partial \textbackslash{}Omega\+\_\+O \textbackslash{}f\$ as shown in the$<$ a href=\char`\"{}../../../navier\+\_\+stokes/vmtk\+\_\+fluid/html/index.\+html\char`\"{}$>$ Steady finite-\/Reynolds-\/number flow through an iliac bifurcation$<$/a $>$ tutorial, also see the$<$ a href=\char`\"{}../../../solid/prescribed\+\_\+displ\+\_\+lagr\+\_\+mult/html/index.\+html\char`\"{}$>$ Deformation of a solid by a prescribed boundary motion$<$/a $>$ tutorial which employs a similar technique used to enforce prescribed boundary displacements in solid mechanics problems. We discretise the Navier-\/Stokes equations using \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} oomph-\/lib \textquotesingle{}s \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Q\+Taylor\+Hood\+Elements, see the$<$ a href=\char`\"{}../../../navier\+\_\+stokes/driven\+\_\+cavity/html/index.\+html\char`\"{}$>$ 2D Driven Cavity Problem$<$/a $>$ tutorial for more information. The discretised \mbox{\hyperlink{lgr__navier__stokes_8txt_a97c15a2ef3a561d44eb919d9439e722d}{problem}} therefore contains the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}} types of discrete unknowns\+:-\/ The fluid degrees of freedom(velocity and pressure).\textbackslash{}n\textbackslash{}n -\/ The nodal values representing the components of the(vector-\/valued) Lagrange multipliers. These only exist for the nodes on \textbackslash{}f\$ \textbackslash{}partial \textbackslash{}Omega\+\_\+\+O\textbackslash{}f\$.(The nodes are re-\/sized to accommodate the additional unknowns when the \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Impose\+Parallel\+Outflow\+Elements are attached to the bulk elements.) . The preconditioner requires a further sub-\/division of these degrees of freedom into the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}} categories\+:-\/ the unconstrained velocity in the x-\/direction -\/ the unconstrained velocity in the y-\/direction -\/\mbox{[}the unconstrained velocity in the z-\/direction(only in 3D)\mbox{]} -\/ the constrained velocity in the x-\/direction -\/ the constrained velocity in the y-\/direction -\/\mbox{[}the constrained velocity in the z-\/direction(only in 3D)\mbox{]} -\/ the Lagrange multiplier at the constrained nodes -\/\mbox{[}the other Lagrange multiplier at the constrained nodes(only in 3D)\mbox{]}. . For a 2D \mbox{\hyperlink{lgr__navier__stokes_8txt_a97c15a2ef3a561d44eb919d9439e722d}{problem}}, the linear system to be solved in the course of the Newton iteration can then be(formally) re-\/ordered into the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}} \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}} structure\+:\textbackslash{}f\mbox{[}\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{ccccc$\vert$\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \{ F\+\_\+\{\textbackslash{}rm xx\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm xy\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm x\}$^\wedge$\{T\}\}\&\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}$^\wedge$\{T\}\}\&\{ M\+\_\+\{\textbackslash{}rm x\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}rm yx\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm yy\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{T\}\}\&\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}$^\wedge$\{T\}\}\&\{ M\+\_\+\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \{ B\+\_\+\{\textbackslash{}rm x\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm y\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\textbackslash{}\textbackslash{} \textbackslash{}hline \&\{ M\+\_\+\{\textbackslash{}rm x\}\}\&\&\{ M\+\_\+\{\textbackslash{}rm y\}\}\&\&\textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}Delta \textbackslash{}mathbf\{U\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{U\}\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{U\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{U\}\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{P\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}Lambda\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}=-\/ \textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm p\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm \textbackslash{}Lambda\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}linear\+\_\+system\mbox{]}@ \textbackslash{}f\mbox{]} Here the vectors \textbackslash{}f\$\{\textbackslash{}bf U\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$, \textbackslash{}f\$\{\textbackslash{}bf U\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$, \textbackslash{}f\$\{\textbackslash{}bf P\}\textbackslash{}f\$ and \textbackslash{}f\$\{\textbackslash{}bf \textbackslash{}Lambda\}\textbackslash{}f\$ contain the \textbackslash{}f \$x\textbackslash{}f\$ and \textbackslash{}f \$y\textbackslash{}f\$ components of the velocity unknowns, the pressure unknowns and Lagrange multipliers unknowns, respectively. The overbars identify the unknown nodal positions that are constrained by the Lagrange multiplier. The matrices \textbackslash{}f \$M\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$ and \textbackslash{}f \$M\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$ are mass-\/like matrices whose entries are formed from products of the basis functions multiplied by a component of the tangent vector at each discrete point on \textbackslash{}f\$\textbackslash{}partial\textbackslash{}\+Omega\+\_\+\{O\}\textbackslash{}f\$, for example, \textbackslash{}f\$\mbox{[}M\+\_\+\{\{\textbackslash{}rm x\}\}\mbox{]}\+\_\+\{ij\}=\textbackslash{}int\+\_\+\{\textbackslash{}partial \textbackslash{}Omega\+\_\+\{O\}\} t\+\_\+x \{\textbackslash{}psi\+\_\+i\} \textbackslash{} \{\textbackslash{}psi\+\_\+j\} \textbackslash{} dS \textbackslash{}f\$. Denote \textbackslash{}f\mbox{[}J\+\_\+\{\textbackslash{}rm NS\}=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{ccccc\} \{ F\+\_\+\{\textbackslash{}rm xx\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm xy\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm x\}$^\wedge$\{T\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}$^\wedge$\{T\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}rm yx\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm yy\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{T\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}$^\wedge$\{T\}\}\textbackslash{}\textbackslash{} \{ B\+\_\+\{\textbackslash{}rm x\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm y\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}, \textbackslash{} \textbackslash{} \textbackslash{} L=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{ccccc\} \&\{M\+\_\+\{\textbackslash{}rm x\}\}\&\&\{ M\+\_\+\{\textbackslash{}rm x\}\} \&\textbackslash{}end\{array\} \textbackslash{}right\mbox{]}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{X\}\+\_\+\{\textbackslash{}rm NS\}=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}Delta \textbackslash{}mathbf\{U\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{U\}\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{U\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{U\}\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{P\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]},\textbackslash{}mbox\{\textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm NS\}=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm p\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{}f\mbox{]} Then we can re-\/write( @R\mbox{[}linear\+\_\+system\mbox{]}@) as \textbackslash{}f\mbox{[}\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{cc\} \{ J\+\_\+\{\textbackslash{}rm NS\}\}\&L$^\wedge$\{T\}\textbackslash{}\textbackslash{} L \&\textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}Delta \textbackslash{}mathbf\{X\}\+\_\+\{\textbackslash{}rm NS\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}Lambda\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}=-\/ \textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm NS\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm \textbackslash{}Lambda\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}linear\+\_\+system\+\_\+small\mbox{]}@ \textbackslash{}f\mbox{]} We have shown that \textbackslash{}f\mbox{[}P=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{cc\} \{ J\+\_\+\{\textbackslash{}rm NS\}\}+L$^\wedge$\{T\}W$^\wedge$\{-\/1\} L \&\textbackslash{}\textbackslash{} \&W \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}prec\+\_\+ideal\+\_\+small\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f \$W=\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}LL$^\wedge$\{T\}\textbackslash{}f\$ is an optimal preconditioner for the linear system( @R\mbox{[}linear\+\_\+system\+\_\+small\mbox{]}@) if we set \textbackslash{}f\$ \textbackslash{}sigma=\textbackslash{}$\vert$F\textbackslash{}$\vert$\+\_\+\{\textbackslash{}infty\} \textbackslash{}f\$ where \textbackslash{}f \$F\textbackslash{}f\$ is the compound \textbackslash{}f \$4\textbackslash{}times 4\textbackslash{}f\$ top-\/left \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}} \textbackslash{}f\mbox{[}F=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{ccccc\} \{ F\+\_\+\{\textbackslash{}rm xx\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm xy\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}rm yx\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm yy\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}f\mbox{]} in the Jacobian matrix. Application of the preconditioner \textbackslash{}f \$P\textbackslash{}f\$ requires the repeated solution of linear systems involving the diagonal blocks \textbackslash{}f\$\{J\+\_\+\{\textbackslash{}rm NS\}\}+L$^\wedge$\{T\}W$^\wedge$\{-\/1\} L\textbackslash{}f\$ and \textbackslash{}f \$W\textbackslash{}f\$. The matrix \textbackslash{}f \$W$^\wedge$\{-\/1\}=\textbackslash{}sigma(LL$^\wedge$\{T\})$^\wedge$\{-\/1\}=\textbackslash{}sigma(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\textbackslash{}f\$ is dense and will cause the addition of dense sub-\/matrices to the Jacobian matrix\+:\textbackslash{}f\mbox{[}\textbackslash{}sigma L$^\wedge$\{T\}(LL$^\wedge$\{T\})$^\wedge$\{-\/1\}L=\textbackslash{}sigma \textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{ccccc\} \textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \textbackslash{}\textbackslash{} \textbackslash{}cal O \&\{M\+\_\+\{\textbackslash{}rm x\}\}(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\{M\+\_\+\{\textbackslash{}rm x\}\}\&\textbackslash{}cal O \&\{M\+\_\+\{\textbackslash{}rm x\}\}(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\{M\+\_\+\{\textbackslash{}rm y\}\}\&\textbackslash{}cal O \textbackslash{}\textbackslash{} \textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \textbackslash{}\textbackslash{} \textbackslash{}cal O \&\{M\+\_\+\{\textbackslash{}rm y\}\}(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\{M\+\_\+\{\textbackslash{}rm x\}\}\&\textbackslash{}cal O \&\{M\+\_\+\{\textbackslash{}rm y\}\}(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\{M\+\_\+\{\textbackslash{}rm y\}\}\&\textbackslash{}cal O\textbackslash{}\textbackslash{} \textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{}f\mbox{]} Numerical experiments show that an efficient implementation can be obtained by replacing \textbackslash{}f \$W\textbackslash{}f\$ by its diagonal approximation \textbackslash{}f\$\textbackslash{}widehat\{W\}=\textbackslash{}mbox\{diag\}(M\+\_\+\{\textbackslash{}rm x\}$^\wedge$\{2\}+M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\})\textbackslash{}f\$. Then the inversion of \textbackslash{}f \$W\textbackslash{}f\$ is straight forward and the addition of \textbackslash{}f \$L$^\wedge$\{T\}\{\textbackslash{}widehat\{W\}\}$^\wedge$\{-\/1\}L\textbackslash{}f\$ to the Jacobian does not significantly increase the number of non-\/zero entries in the matrix \textbackslash{}f \$J\+\_\+\{\textbackslash{}rm NS\}\textbackslash{}f\$. Denote the efficient implementation by \textbackslash{}f\mbox{[}\textbackslash{}tilde\{P\}=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{cc\} \{ \textbackslash{}tilde\{J\}\+\_\+\{\textbackslash{}rm NS\}\}\&\textbackslash{}\textbackslash{} \&\textbackslash{}widehat\{W\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}prec\+\_\+eff\+\_\+small\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$\textbackslash{}tilde\{J\}\+\_\+\{\textbackslash{}rm NS\}=J\+\_\+\{\textbackslash{}rm NS\}+L$^\wedge$\{T\}\{\textbackslash{}widehat\{W\}\}$^\wedge$\{-\/1\}L\textbackslash{}f\$ is the augmented Navier-\/Stokes Jacobian matrix. In our implementation of the preconditioner, the linear system involving \textbackslash{}f\$\textbackslash{}tilde\{J\}\+\_\+\{\textbackslash{}rm NS\}\textbackslash{}f\$ can either be solved \char`\"{}exactly\char`\"{}, using \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Super\+LU(in its incarnation as an exact preconditioner
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
mainpage Demo the outflow boundary of the demo \mbox{\hyperlink{lgr__navier__stokes_8txt_a97c15a2ef3a561d44eb919d9439e722d}{problem}} (discussed below) are not aligned with any coordinate planes. Parallel outflow is therefore enforced by a Lagrange multiplier method
\item 
The L\+SC preconditioner is discussed in$<$ a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ another tutorial$<$/A $>$ n n$<$/b $>$ n n skipline Pass the preconditioner to the solver until \mbox{\hyperlink{lgr__navier__stokes_8txt_a1edfdbc47106d414eebfac6ad6e696d0}{linear\+\_\+solver\+\_\+pt}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
mainpage Demo \mbox{\hyperlink{lgr__navier__stokes_8txt_a4074baada03976c061d5672f4237cca5}{problem}}
\item 
this is the \mbox{\hyperlink{lgr__navier__stokes_8txt_a429237fd3d890f48380541a9fb4a766d}{default}} or by any other c Preconditioner(interpreted as an \char`\"{}inexact solver\char`\"{}) specified via the access function \textbackslash{}code Lagrange\+Enforced\+Flow\+Preconditioner n n meshes$<$/b $>$ n n The c Lagrange\+Enforce\+Flow\+Preconditioner takes a pointer of meshes It is important that the bulk mesh is in position \mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}
\item 
By \mbox{\hyperlink{lgr__navier__stokes_8txt_a429237fd3d890f48380541a9fb4a766d}{default}}
\item 
By \mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Super\+L\+U\+Preconditioner is used for all subsidiary block solves To use the L\+SC preconditioner to approximately solve the sub block system involving the momentum \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}}
\item 
By \mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Super\+L\+U\+Preconditioner is used for all subsidiary \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}} solves To use the L\+SC preconditioner to approximately solve the sub \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}} system involving the momentum we invoke the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}}
\end{DoxyCompactItemize}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{lgr__navier__stokes_8txt_ac131914a186803ddf7a4d7fddfa83547}\label{lgr__navier__stokes_8txt_ac131914a186803ddf7a4d7fddfa83547}} 
\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}!Omega@{Omega}}
\index{Omega@{Omega}!lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsubsection{\texorpdfstring{Omega}{Omega}}
{\footnotesize\ttfamily using \mbox{\hyperlink{lgr__navier__stokes_8txt_ac131914a186803ddf7a4d7fddfa83547}{Omega}} =  \mbox{[}0,1\mbox{]}$^\wedge$2\textbackslash{}f\$ by the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}} transformation \textbackslash{}f\mbox{[} R(\textbackslash{}alpha)= \textbackslash{}left( \textbackslash{}begin\{array\}\{cc\} \{\textbackslash{}cos(\textbackslash{}alpha)\} \& \{-\/\textbackslash{}sin(\textbackslash{}alpha)\} \textbackslash{}\textbackslash{} \{\textbackslash{}sin(\textbackslash{}alpha)\} \& \{\textbackslash{}cos(\textbackslash{}alpha)\} \textbackslash{}end\{array\} \textbackslash{}right), \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnrotation\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$\textbackslash{}alpha\textbackslash{}f\$ is the angle of rotation. The figure below show the flow field (velocity vectors and pressure contours) for a unit square domain rotated by an angle of \textbackslash{}f\$\textbackslash{}alpha=30$^\wedge$\textbackslash{}circ \textbackslash{}f\$ and a Reynolds number of \textbackslash{}f\$ Re = 100 \textbackslash{}f\$. The flow is driven by a prescribed parabolic boundary condition. @I w 0.\+4\textbackslash{}textwidth Sim\+Ang30\+Rey100\+Noel4 \char`\"{}Velocity field and pressure contours.\char`\"{} For convenience, we present the boundary conditions for the non-\/rotated unit square \textbackslash{}f\$\textbackslash{}alpha = 0$^\wedge$\{\textbackslash{}circ\}\textbackslash{}f\$. In order to obtain the boundary conditions for \textbackslash{}f\$\textbackslash{}alpha \textbackslash{}ne 0$^\wedge$\textbackslash{}circ\textbackslash{}f\$, we only have to apply the rotation (@R\mbox{[}eqnrotation\mbox{]}@). The flow is driven by imposing a parabolic velocity profile along the inflow boundary \textbackslash{}f\$\textbackslash{}\+Omega\+\_\+\+I\textbackslash{}f\$. Along the characteristic boundary, \textbackslash{}f\$\textbackslash{}\+Omega\+\_\+\+C\textbackslash{}f\$, the no-\/slip condition \textbackslash{}f\$u\+\_\+i = 0\textbackslash{}f\$, \textbackslash{}f\$i = 1,2\textbackslash{}f\$, is prescribed. We impose \`{}parallel outflow\textquotesingle{} along the outlet \textbackslash{}f\$\textbackslash{}\+Omega\+\_\+\+O\textbackslash{}f\$ by insisting that \textbackslash{}f\mbox{[} \{\textbackslash{}bf u\}\textbackslash{}cdot \{\textbackslash{}bf t\}\+\_\+\{\} = 0 \textbackslash{}mbox\{\textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} on \$\textbackslash{}Omega\+\_\+\{O\}\$,\} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnbcpostrong\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$ \{\textbackslash{}bf t\}\textbackslash{}f\$ is the tangent vector at each discrete point on the boundary \textbackslash{}f\$ \textbackslash{}Omega\+\_\+\{O\}\textbackslash{}f\$. We weakly enforce the flow constraint by augmenting the Navier-\/Stokes momentum residual equation (introduced in the $<$a href=\char`\"{}../../../navier\+\_\+stokes/rayleigh\+\_\+traction\+\_\+channel/html/index.\+html\char`\"{}$>$ Unsteady flow in a 2D channel, driven by an applied traction$<$/a$>$ tutorial) with a Lagrange multiplier term so that it becomes \textbackslash{}f\mbox{[} r\+\_\+\{il\}$^\wedge$\{u\} = \textbackslash{}int\+\_\+\textbackslash{}\+Omega \textbackslash{}left\mbox{[} Re \textbackslash{}left( St\textbackslash{}frac\{\textbackslash{}partial u\+\_\+i\}\{\textbackslash{}partial t\} + u\+\_\+j\textbackslash{}frac\{\textbackslash{}partial u\+\_\+i\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}right) \textbackslash{}psi\+\_\+l + \textbackslash{}tau\+\_\+\{ij\}\textbackslash{}frac\{\textbackslash{}partial \textbackslash{}psi\+\_\+l\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}right\mbox{]} d\textbackslash{}\+Omega -\/ \textbackslash{}int\+\_\+\{\textbackslash{}partial\textbackslash{}\+Omega\} \textbackslash{}tau\+\_\+\{ij\} n\+\_\+j\textbackslash{}psi\+\_\+l dS + \textbackslash{}delta \textbackslash{}Pi\+\_\+\{constraint\} = 0, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnaugmentedresu\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\mbox{[} \textbackslash{}Pi\+\_\+\{constraint\} = \textbackslash{}int\+\_\+\{\textbackslash{}partial \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_ac131914a186803ddf7a4d7fddfa83547}{Omega}}\} \textbackslash{}lambda u\+\_\+i t\+\_\+i dS, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnlgrterm\mbox{]}@ \textbackslash{}f\mbox{]} and \textbackslash{}f\$\textbackslash{}lambda\textbackslash{}f\$ is the Lagrange multiplier. Upon taking the first variation of the constraint with respect to the unknown velocity and the Lagrange multiplier, the residual form of the constrained momentum equation is \textbackslash{}f\mbox{[} r\+\_\+\{il\}$^\wedge$\{u\} = \textbackslash{}int\+\_\+\textbackslash{}\+Omega \textbackslash{}left\mbox{[} Re \textbackslash{}left( St\textbackslash{}frac\{\textbackslash{}partial u\+\_\+i\}\{\textbackslash{}partial t\} + u\+\_\+j\textbackslash{}frac\{\textbackslash{}partial u\+\_\+i\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}right) \textbackslash{}psi\+\_\+l + \textbackslash{}tau\+\_\+\{ij\}\textbackslash{}frac\{\textbackslash{}partial \textbackslash{}psi\+\_\+l\}\{\textbackslash{}partial x\+\_\+j\} \textbackslash{}right\mbox{]} d\textbackslash{}\+Omega -\/ \textbackslash{}int\+\_\+\{\textbackslash{}partial\textbackslash{}\+Omega\} \textbackslash{}tau\+\_\+\{ij\} n\+\_\+j\textbackslash{}psi\+\_\+l dS + \textbackslash{}int\+\_\+\{\textbackslash{}partial\textbackslash{}\+Omega\} \textbackslash{}lambda\textbackslash{}psi\+\_\+l t\+\_\+i = 0. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnaugmentedresufirstvar\mbox{]}@ \textbackslash{}f\mbox{]} The weak formulation of (@R\mbox{[}eqnbcpostrong\mbox{]}@) is simply \textbackslash{}f\mbox{[} r\+\_\+\{l\}$^\wedge$\{\textbackslash{}lambda\} = \textbackslash{}int\+\_\+\textbackslash{}\+Omega u\+\_\+i t\+\_\+i \textbackslash{}psi$^\wedge$\textbackslash{}lambda dS = 0, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}eqnweakconstraint\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$\textbackslash{}psi$^\wedge$\textbackslash{}lambda\textbackslash{}f\$ is a suitable basis function. Equation (@R\mbox{[}eqnaugmentedresufirstvar\mbox{]}@) reveals that the Lagrange multipliers act as the (negative) tangential traction \textbackslash{}f\$(\textbackslash{}lambda = -\/\{\textbackslash{}mathbf\{n\}\}$^\wedge$T\{\textbackslash{}mathbf\{\textbackslash{}tau\}\}\{\textbackslash{}mathbf\{t\}\})\textbackslash{}f\$ that enforce the parallel flow across the boundary \textbackslash{}f\$\textbackslash{}partial\textbackslash{}\+Omega\+\_\+\{O\}\textbackslash{}f\$. We discretise this constraint by attaching \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Impose\+Parallel\+Outflow\+Elements to the boundaries of the \char`\"{}bulk\char`\"{} Navier-\/Stokes elements that are adjacent to \textbackslash{}f\$ \textbackslash{}partial \textbackslash{}Omega\+\_\+O \textbackslash{}f\$ as shown in the $<$a href=\char`\"{}../../../navier\+\_\+stokes/vmtk\+\_\+fluid/html/index.\+html\char`\"{}$>$ Steady finite-\/Reynolds-\/number flow through an iliac bifurcation$<$/a$>$ tutorial, also see the $<$a href=\char`\"{}../../../solid/prescribed\+\_\+displ\+\_\+lagr\+\_\+mult/html/index.\+html\char`\"{}$>$ Deformation of a solid by a prescribed boundary motion $<$/a$>$ tutorial which employs a similar technique used to enforce prescribed boundary displacements in solid mechanics problems. We discretise the Navier-\/Stokes equations using \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} oomph-\/lib\textquotesingle{}s \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Q\+Taylor\+Hood\+Elements, see the $<$a href=\char`\"{}../../../navier\+\_\+stokes/driven\+\_\+cavity/html/index.\+html\char`\"{}$>$ 2D Driven Cavity Problem$<$/a$>$ tutorial for more information. The discretised \mbox{\hyperlink{lgr__navier__stokes_8txt_a97c15a2ef3a561d44eb919d9439e722d}{problem}} therefore contains the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}} types of discrete unknowns\+: -\/ The fluid degrees of freedom (velocity and pressure).\textbackslash{}n\textbackslash{}n -\/ The nodal values representing the components of the (vector-\/valued) Lagrange multipliers. These only exist for the nodes on \textbackslash{}f\$ \textbackslash{}partial \textbackslash{}Omega\+\_\+\+O\textbackslash{}f\$. (The nodes are re-\/sized to accommodate the additional unknowns when the \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Impose\+Parallel\+Outflow\+Elements are attached to the bulk elements.) . The preconditioner requires a further sub-\/division of these degrees of freedom into the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}} categories\+: -\/ the unconstrained velocity in the x-\/direction -\/ the unconstrained velocity in the y-\/direction -\/ \mbox{[}the unconstrained velocity in the z-\/direction (only in 3D)\mbox{]} -\/ the constrained velocity in the x-\/direction -\/ the constrained velocity in the y-\/direction -\/ \mbox{[}the constrained velocity in the z-\/direction (only in 3D)\mbox{]} -\/ the Lagrange multiplier at the constrained nodes -\/ \mbox{[}the other Lagrange multiplier at the constrained nodes (only in 3D)\mbox{]}. . For a 2D \mbox{\hyperlink{lgr__navier__stokes_8txt_a97c15a2ef3a561d44eb919d9439e722d}{problem}}, the linear system to be solved in the course of the Newton iteration can then be (formally) re-\/ordered into the \mbox{\hyperlink{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}{following}} \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}} structure\+: \textbackslash{}f\mbox{[} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{ccccc$\vert$\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \{ F\+\_\+\{\textbackslash{}rm xx\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm xy\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm x\}$^\wedge$\{T\}\}\&\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}$^\wedge$\{T\}\}\&\{ M\+\_\+\{\textbackslash{}rm x\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}rm yx\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm yy\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{T\}\}\&\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}$^\wedge$\{T\}\}\&\{ M\+\_\+\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \{ B\+\_\+\{\textbackslash{}rm x\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm y\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\textbackslash{}\textbackslash{} \textbackslash{}hline \&\{ M\+\_\+\{\textbackslash{}rm x\}\}\&\&\{ M\+\_\+\{\textbackslash{}rm y\}\}\&\& \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}Delta \textbackslash{}mathbf\{U\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{U\}\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{U\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{U\}\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{P\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}Lambda\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} = -\/ \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm p\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm \textbackslash{}Lambda\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}linear\+\_\+system\mbox{]}@ \textbackslash{}f\mbox{]} Here the vectors \textbackslash{}f\$\{\textbackslash{}bf U\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$, \textbackslash{}f\$\{\textbackslash{}bf U\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$, \textbackslash{}f\$\{\textbackslash{}bf P\}\textbackslash{}f\$ and \textbackslash{}f\$\{\textbackslash{}bf \textbackslash{}Lambda\}\textbackslash{}f\$ contain the \textbackslash{}f\$x\textbackslash{}f\$ and \textbackslash{}f\$y\textbackslash{}f\$ components of the velocity unknowns, the pressure unknowns and Lagrange multipliers unknowns, respectively. The overbars identify the unknown nodal positions that are constrained by the Lagrange multiplier. The matrices \textbackslash{}f\$\+M\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$ and \textbackslash{}f\$\+M\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$ are mass-\/like matrices whose entries are formed from products of the basis functions multiplied by a component of the tangent vector at each discrete point on \textbackslash{}f\$\textbackslash{}partial\textbackslash{}\+Omega\+\_\+\{O\}\textbackslash{}f\$, for example, \textbackslash{}f\$\mbox{[}M\+\_\+\{\{\textbackslash{}rm x\}\}\mbox{]}\+\_\+\{ij\} = \textbackslash{}int\+\_\+\{\textbackslash{}partial \textbackslash{}Omega\+\_\+\{O\}\} t\+\_\+x \{\textbackslash{}psi\+\_\+i\} \textbackslash{} \{\textbackslash{}psi\+\_\+j\} \textbackslash{} dS \textbackslash{}f\$. Denote \textbackslash{}f\mbox{[} J\+\_\+\{\textbackslash{}rm NS\} = \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{ccccc\} \{ F\+\_\+\{\textbackslash{}rm xx\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm xy\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm x\}$^\wedge$\{T\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}$^\wedge$\{T\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}rm yx\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm yy\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{T\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}$^\wedge$\{T\}\}\textbackslash{}\textbackslash{} \{ B\+\_\+\{\textbackslash{}rm x\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ B\+\_\+\{\textbackslash{}rm y\}\}\&\{ B\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}, \textbackslash{} \textbackslash{} \textbackslash{} L = \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{ccccc\} \&\{M\+\_\+\{\textbackslash{}rm x\}\}\& \&\{ M\+\_\+\{\textbackslash{}rm x\}\} \& \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{X\}\+\_\+\{\textbackslash{}rm NS\} = \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}Delta \textbackslash{}mathbf\{U\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{U\}\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{U\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{U\}\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{P\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]},\textbackslash{}mbox\{\textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and \} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm NS\} = \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm p\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{}f\mbox{]} Then we can re-\/write (@R\mbox{[}linear\+\_\+system\mbox{]}@) as \textbackslash{}f\mbox{[} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cc\} \{ J\+\_\+\{\textbackslash{}rm NS\}\}\&L$^\wedge$\{T\}\textbackslash{}\textbackslash{} L\& \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}Delta \textbackslash{}mathbf\{X\}\+\_\+\{\textbackslash{}rm NS\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}Lambda\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} = -\/ \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}}\} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm NS\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm \textbackslash{}Lambda\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}linear\+\_\+system\+\_\+small\mbox{]}@ \textbackslash{}f\mbox{]} We have shown that \textbackslash{}f\mbox{[} P= \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cc\} \{ J\+\_\+\{\textbackslash{}rm NS\}\} + L$^\wedge$\{T\}W$^\wedge$\{-\/1\} L\& \textbackslash{}\textbackslash{} \& W \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}prec\+\_\+ideal\+\_\+small\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$W = \textbackslash{}frac\{1\}\{\textbackslash{}sigma\}LL$^\wedge$\{T\}\textbackslash{}f\$ is an optimal preconditioner for the linear system (@R\mbox{[}linear\+\_\+system\+\_\+small\mbox{]}@) if we set \textbackslash{}f\$ \textbackslash{}sigma=\textbackslash{}$\vert$F\textbackslash{}$\vert$\+\_\+\{\textbackslash{}infty\} \textbackslash{}f\$ where \textbackslash{}f\$\+F\textbackslash{}f\$ is the compound \textbackslash{}f\$4\textbackslash{}times 4\textbackslash{}f\$ top-\/left \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}} \textbackslash{}f\mbox{[} F = \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{ccccc\} \{ F\+\_\+\{\textbackslash{}rm xx\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm xy\}\}\&\{ F\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}rm yx\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}rm yy\}\}\&\{ F\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\textbackslash{}\textbackslash{} \{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\}\&\{ F\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}f\mbox{]} in the Jacobian matrix. Application of the preconditioner \textbackslash{}f\$\+P\textbackslash{}f\$ requires the repeated solution of linear systems involving the diagonal blocks \textbackslash{}f\$\{J\+\_\+\{\textbackslash{}rm NS\}\} + L$^\wedge$\{T\}W$^\wedge$\{-\/1\} L\textbackslash{}f\$ and \textbackslash{}f\$\+W\textbackslash{}f\$. The matrix \textbackslash{}f\$W$^\wedge$\{-\/1\} = \textbackslash{}sigma (LL$^\wedge$\{T\})$^\wedge$\{-\/1\} = \textbackslash{}sigma (\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\textbackslash{}f\$ is dense and will cause the addition of dense sub-\/matrices to the Jacobian matrix\+: \textbackslash{}f\mbox{[} \textbackslash{}sigma L$^\wedge$\{T\}(LL$^\wedge$\{T\})$^\wedge$\{-\/1\}L = \textbackslash{}sigma \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{ccccc\} \textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \textbackslash{}\textbackslash{} \textbackslash{}cal O\&\{M\+\_\+\{\textbackslash{}rm x\}\}(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\{M\+\_\+\{\textbackslash{}rm x\}\}\&\textbackslash{}cal O \&\{M\+\_\+\{\textbackslash{}rm x\}\}(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\{M\+\_\+\{\textbackslash{}rm y\}\}\&\textbackslash{}cal O \textbackslash{}\textbackslash{} \textbackslash{}cal O\&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \textbackslash{}\textbackslash{} \textbackslash{}cal O\&\{M\+\_\+\{\textbackslash{}rm y\}\}(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\{M\+\_\+\{\textbackslash{}rm x\}\}\&\textbackslash{}cal O \&\{M\+\_\+\{\textbackslash{}rm y\}\}(\{M\+\_\+\{\textbackslash{}rm x\}\}$^\wedge$\{2\}+\{M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\}\})$^\wedge$\{-\/1\}\{M\+\_\+\{\textbackslash{}rm y\}\}\& \textbackslash{}cal O\textbackslash{}\textbackslash{} \textbackslash{}cal O\&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \&\textbackslash{}cal O \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{}f\mbox{]} Numerical experiments show that an efficient implementation can be obtained by replacing \textbackslash{}f\$\+W\textbackslash{}f\$ by its diagonal approximation \textbackslash{}f\$\textbackslash{}widehat\{W\} = \textbackslash{}mbox\{diag\}(M\+\_\+\{\textbackslash{}rm x\}$^\wedge$\{2\}+M\+\_\+\{\textbackslash{}rm y\}$^\wedge$\{2\})\textbackslash{}f\$. Then the inversion of \textbackslash{}f\$\+W\textbackslash{}f\$ is straight forward and the addition of \textbackslash{}f\$L$^\wedge$\{T\}\{\textbackslash{}widehat\{W\}\}$^\wedge$\{-\/1\}L\textbackslash{}f\$ to the Jacobian does not significantly increase the number of non-\/zero entries in the matrix \textbackslash{}f\$\+J\+\_\+\{\textbackslash{}rm NS\}\textbackslash{}f\$. Denote the efficient implementation by \textbackslash{}f\mbox{[} \textbackslash{}tilde\{P\} = \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cc\} \{ \textbackslash{}tilde\{J\}\+\_\+\{\textbackslash{}rm NS\}\}\& \textbackslash{}\textbackslash{} \& \textbackslash{}widehat\{W\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}, \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @E\mbox{[}prec\+\_\+eff\+\_\+small\mbox{]}@ \textbackslash{}f\mbox{]} where \textbackslash{}f\$\textbackslash{}tilde\{J\}\+\_\+\{\textbackslash{}rm NS\} =J\+\_\+\{\textbackslash{}rm NS\}+ L$^\wedge$\{T\}\{\textbackslash{}widehat\{W\}\}$^\wedge$\{-\/1\}L\textbackslash{}f\$ is the augmented Navier-\/Stokes Jacobian matrix. In our implementation of the preconditioner, the linear system involving \textbackslash{}f\$\textbackslash{}tilde\{J\}\+\_\+\{\textbackslash{}rm NS\}\textbackslash{}f\$ can either be solved \char`\"{}exactly\char`\"{}, using \textbackslash{}\mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Super\+LU (in its incarnation as an exact preconditioner}



Definition at line 355 of file lgr\+\_\+navier\+\_\+stokes.\+txt.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{lgr__navier__stokes_8txt_a1edfdbc47106d414eebfac6ad6e696d0}\label{lgr__navier__stokes_8txt_a1edfdbc47106d414eebfac6ad6e696d0}} 
\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}!linear\_solver\_pt@{linear\_solver\_pt}}
\index{linear\_solver\_pt@{linear\_solver\_pt}!lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsubsection{\texorpdfstring{linear\_solver\_pt()}{linear\_solver\_pt()}}
{\footnotesize\ttfamily The L\+SC preconditioner is discussed in$<$a href=\char`\"{}../../lsc\+\_\+navier\+\_\+stokes/html/index.\+html\char`\"{}$>$ another tutorial$<$/A$>$ n n$<$/b$>$ n n skipline Pass the preconditioner to the solver until linear\+\_\+solver\+\_\+pt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{lgr__navier__stokes_8txt_a97c15a2ef3a561d44eb919d9439e722d}\label{lgr__navier__stokes_8txt_a97c15a2ef3a561d44eb919d9439e722d}} 
\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}!problem@{problem}}
\index{problem@{problem}!lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsubsection{\texorpdfstring{problem()}{problem()}}
{\footnotesize\ttfamily mainpage Demo the outflow boundary of the demo problem (\begin{DoxyParamCaption}\item[{discussed}]{below }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}\label{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}} 
\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}!block@{block}}
\index{block@{block}!lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsubsection{\texorpdfstring{block}{block}}
{\footnotesize\ttfamily By \mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Super\+L\+U\+Preconditioner is used for all subsidiary block solves To use the L\+SC preconditioner to approximately solve the sub block system involving the momentum block}



Definition at line 405 of file lgr\+\_\+navier\+\_\+stokes.\+txt.

\mbox{\Hypertarget{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}\label{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}} 
\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}!c@{c}}
\index{c@{c}!lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsubsection{\texorpdfstring{c}{c}}
{\footnotesize\ttfamily this is the \mbox{\hyperlink{lgr__navier__stokes_8txt_a429237fd3d890f48380541a9fb4a766d}{default}} or by any other c Preconditioner (interpreted as an \char`\"{}inexact solver\char`\"{}) specified via the access function \textbackslash{}code Lagrange\+Enforced\+Flow\+Preconditioner n n meshes$<$/b$>$ n n The c Lagrange\+Enforce\+Flow\+Preconditioner takes a pointer of meshes It is important that the bulk mesh is in position c}



Definition at line 356 of file lgr\+\_\+navier\+\_\+stokes.\+txt.

\mbox{\Hypertarget{lgr__navier__stokes_8txt_a429237fd3d890f48380541a9fb4a766d}\label{lgr__navier__stokes_8txt_a429237fd3d890f48380541a9fb4a766d}} 
\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}!default@{default}}
\index{default@{default}!lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsubsection{\texorpdfstring{default}{default}}
{\footnotesize\ttfamily By default}



Definition at line 403 of file lgr\+\_\+navier\+\_\+stokes.\+txt.

\mbox{\Hypertarget{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}\label{lgr__navier__stokes_8txt_ae21d0e8035b920d37467483a2b1ac04a}} 
\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}!following@{following}}
\index{following@{following}!lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsubsection{\texorpdfstring{following}{following}}
{\footnotesize\ttfamily By \mbox{\hyperlink{lgr__navier__stokes_8txt_a9fe48f37eb1da14c81bb9bb3910ccfc1}{c}} Super\+L\+U\+Preconditioner is used for all subsidiary \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}} solves To use the L\+SC preconditioner to approximately solve the sub \mbox{\hyperlink{lgr__navier__stokes_8txt_a62f0a458352206719cb3775c6648fbfa}{block}} system involving the momentum we invoke the following}



Definition at line 407 of file lgr\+\_\+navier\+\_\+stokes.\+txt.

\mbox{\Hypertarget{lgr__navier__stokes_8txt_a4074baada03976c061d5672f4237cca5}\label{lgr__navier__stokes_8txt_a4074baada03976c061d5672f4237cca5}} 
\index{lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}!problem@{problem}}
\index{problem@{problem}!lgr\_navier\_stokes.txt@{lgr\_navier\_stokes.txt}}
\doxysubsubsection{\texorpdfstring{problem}{problem}}
{\footnotesize\ttfamily mainpage Demo problem}



Definition at line 7 of file lgr\+\_\+navier\+\_\+stokes.\+txt.

