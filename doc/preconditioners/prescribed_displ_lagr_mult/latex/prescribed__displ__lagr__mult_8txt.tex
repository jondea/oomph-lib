\hypertarget{prescribed__displ__lagr__mult_8txt}{}\doxysection{prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt File Reference}
\label{prescribed__displ__lagr__mult_8txt}\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}} = \char`\"{}http\+: 10.\+1016/j.\+jcp.\+2012.\+07.\+001$<$/a$>$ $<$/center$>$ $<$HR$>$ $<$HR$>$ \textbackslash{}section model Theory\+: Problem formulation, \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} resulting linear system and \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner We refer to $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}../../../solid/prescribed\+\_\+displ\+\_\+lagr\+\_\+mult/html/index.\+html\char`\"{}$>$ another tutorial$<$/a$>$ for a detailed description of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} setup and its discretisation. Briefly, we consider \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} deformation of an elastic solid body whose shape is parametrised by Lagrangian coordinates \textbackslash{}f\$ \textbackslash{}xi$^\wedge$i \textbackslash{}f\$. A part of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} body\textquotesingle{}s boundary, \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{prescr\}\textbackslash{}f\$, (which is parametrised by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} boundary coordinate \textbackslash{}f\$ \textbackslash{}zeta\textbackslash{}f\$) is displaced to a new position given by \textbackslash{}f\$ \{\textbackslash{}bf R\}\+\_\+\{prescr\}(\textbackslash{}zeta) \textbackslash{}f\$ while \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} other boundaries are held in a fixed position (as in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} sketch below) or are subject to traction boundary conditions. @I w 0.\+75\textbackslash{}textwidth sketch \char`\"{}Sketch of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} typical problem. \char`\"{} We discretise \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} using \textbackslash{}c Solid\+Elements in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} bulk of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} domain and employ lower-\/dimensional \textbackslash{}c Face\+Elements to impose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint along \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{prescr\}\textbackslash{}f\$. The \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} therefore contains \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} following \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}{types}} of discrete unknowns\+: -\/ The nodal positions (which are stored as positional \textbackslash{}c Data at each \textbackslash{}c Solid\+Node). \textbackslash{}n\textbackslash{}n -\/ The nodal values representing \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} components of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} (vector-\/valued) Lagrange multipliers. These only exist for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} nodes on \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{prescr\}\textbackslash{}f\$. (The nodes are re-\/sized to accommodate \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} additional unknowns when \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \textbackslash{}c Face\+Elements are attached to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} bulk elements.) . The preconditioner requires a further sub-\/division of these degrees of freedom into \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} following categories\+: -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained nodes -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} y-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained nodes -\/ \mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} z-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained nodes (only in 3D)\mbox{]} -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} y-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes -\/ \mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} z-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes (only in 3D)\mbox{]} -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier at \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} y-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier at \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes -\/ \mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} z-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier at \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes (only in 3D)\mbox{]}. . For a 2D \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}}, \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear system to be solved in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} course of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Newton iteration can then be (formally) re-\/ordered into \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} following block structure\+: \textbackslash{}f\mbox{[} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cccc$\vert$cc\} \{ E\+\_\+\{\textbackslash{}rm xx\}\}\&\{ E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ E\+\_\+\{\textbackslash{}rm xy\}\}\&\{ E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\&\textbackslash{}\textbackslash{} \{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}\}\&\textbackslash{}\textbackslash{} \{ E\+\_\+\{\textbackslash{}rm yx\}\}\&\{ E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ E\+\_\+\{\textbackslash{}rm yy\}\}\&\{ E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\&\textbackslash{}\textbackslash{} \{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\&\{ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \textbackslash{}hline \&\{ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}\}\&\&\&\textbackslash{}\textbackslash{} \&\&\&\{ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}\}\&\& \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{c\} \textbackslash{}Delta \textbackslash{}mathbf\{X\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{X\}\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{X\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{X\}\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{L\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{L\}\+\_\+\{\textbackslash{}rm y\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} = -\/ \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{c\} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm l\+\_\+x\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm l\+\_\+y\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}\mbox{[}linear\+\_\+system\mbox{]}@ \textbackslash{}f\mbox{]} Here \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} vectors \textbackslash{}f\$\{\textbackslash{}bf X\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$, \textbackslash{}f\$\{\textbackslash{}bf X\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$, \textbackslash{}f\$\{\textbackslash{}bf L\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$ and \textbackslash{}f\$\{\textbackslash{}bf L\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$ contain \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \textbackslash{}f\$x\textbackslash{}f\$ and \textbackslash{}f\$y\textbackslash{}f\$ components of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unknown nodal positions and Lagrange multipliers, respectively. The overbars identify \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unknown nodal positions that are constrained by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier. The \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}} \textbackslash{}f\$\+M\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$ and \textbackslash{}f\$\+M\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$ are mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}} whose entries are formed from products of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} basis functions, \textbackslash{}f\$\mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\{\textbackslash{}rm x\}\}\mbox{]}\+\_\+\{ij\}=\mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\{\textbackslash{}rm y\}\}\mbox{]}\+\_\+\{ij\} = \textbackslash{}int\+\_\+\{\textbackslash{}partial D\+\_\+\{\textbackslash{}rm prescr\}\} \{\textbackslash{}psi\+\_\+i\} \textbackslash{} \{\textbackslash{}psi\+\_\+j\} \textbackslash{} dS \textbackslash{}f\$. $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}http\+:\+Muddle, Mihajlovic \&Heil(2012)$<$/a $>$ show that \textbackslash{}f\mbox{[}\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\}=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{cccc$\vert$cc\} E\+\_\+\{\textbackslash{}rm xx\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm xy\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\&\&\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}+\textbackslash{}sigma I \&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\&\&\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}rm yx\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm yy\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\&\&\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}+\textbackslash{}sigma I \&\&\textbackslash{}\textbackslash{} \textbackslash{}hline \&\&\&\&\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}$^\wedge$2 \&\textbackslash{}\textbackslash{} \&\&\&\&\&\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}$^\wedge$2\textbackslash{}\textbackslash{} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}\mbox{[}P\+\_\+ps\mbox{]}@ \textbackslash{}f\mbox{]} is an optimal preconditioner for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear system( @R\mbox{[}linear\+\_\+system\mbox{]}@) if we set \textbackslash{}f\$ \textbackslash{}sigma=\textbackslash{}$\vert$E\textbackslash{}$\vert$\+\_\+\{\textbackslash{}infty\} \textbackslash{}f\$ where \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}} \textbackslash{}f\$ is \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} compound 4x4 top-\/left block \textbackslash{}f\mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{cccc\} E\+\_\+\{\textbackslash{}rm xx\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm xy\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\} \&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\} \textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}rm yx\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm yy\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}f\mbox{]} in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Jacobian matrix. The application of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner(i.\+e. \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solution of linear systems of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} form \textbackslash{}f\$ \{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{} \{\textbackslash{}bf x\}=\{\textbackslash{}bf y\} \textbackslash{}f\$ for \textbackslash{}f\$ \{\textbackslash{}bf x\} \textbackslash{}f\$) requires three linear solves\+:\+One involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} compound 4x4 top-\/left block in \textbackslash{}f\$ \{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$, \textbackslash{}f\mbox{[}E\+\_\+\{\textbackslash{}rm PS\}=\textbackslash{}left\mbox{[}\textbackslash{}begin\{array\}\{cccc\} E\+\_\+\{\textbackslash{}rm xx\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm xy\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}+\textbackslash{}sigma I \&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\} \textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}rm yx\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm yy\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}+\textbackslash{}sigma I \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}f\mbox{]} and two involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} two squared mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}}, \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}$^\wedge$2 \textbackslash{}f\$ and \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}$^\wedge$2 \textbackslash{}f\$. Numerical experiments in$<$ a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}http\+: Muddle, Mihajlovic \& Heil (2012) $<$/a$>$ show that an efficient implementation of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner is obtained by replacing \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ block in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner \textbackslash{}f\$ \{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ by its upper block-\/triangular approximation, corresponding to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner \textbackslash{}f\mbox{[} \textbackslash{}widetilde\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\}=\textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cccc$\vert$cc\} E\+\_\+\{xx\}\&E\+\_\+\{x\textbackslash{}bar\{x\}\}\&E\+\_\+\{xy\}\&E\+\_\+\{x\textbackslash{}bar\{y\}\}\&\&\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{x\}x\}\&E\+\_\+\{\textbackslash{}bar\{x\}\textbackslash{}bar\{x\}\}+\textbackslash{}sigma I\&E\+\_\+\{\textbackslash{}bar\{x\}y\}\&E\+\_\+\{\textbackslash{}bar\{x\}\textbackslash{}bar\{y\}\}\&\&\textbackslash{}\textbackslash{} \&\&E\+\_\+\{yy\}\&E\+\_\+\{y\textbackslash{}bar\{y\}\}\&\&\textbackslash{}\textbackslash{} \&\&E\+\_\+\{\textbackslash{}bar\{y\}y\}\&E\+\_\+\{\textbackslash{}bar\{y\}\textbackslash{}bar\{y\}\}+\textbackslash{}sigma I\&\&\textbackslash{}\textbackslash{} \textbackslash{}hline \&\&\&\&\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}M\+\_\+x$^\wedge$2\&\textbackslash{}\textbackslash{} \&\&\&\&\&\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}M\+\_\+y$^\wedge$2\textbackslash{}\textbackslash{} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}\mbox{[}P\+\_\+ps\+\_\+tilde\mbox{]}@ \textbackslash{}f\mbox{]} Furthermore, a fully optimal preconditioner (in which \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solve times scale linearly with \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of unknowns) can be obtained by\+: -\/ approximately solving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} subsidiary linear systems involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} diagonal blocks \textbackslash{}f\mbox{[} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cc\} E\+\_\+\{xx\}\&E\+\_\+\{x\textbackslash{}bar\{x\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{x\}x\}\&E\+\_\+\{\textbackslash{}bar\{x\}\textbackslash{}bar\{x\}\}+\textbackslash{}sigma I\textbackslash{}\textbackslash{} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}mbox\{\textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and\textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cc\} E\+\_\+\{yy\}\&E\+\_\+\{y\textbackslash{}bar\{y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{y\}y\}\&E\+\_\+\{\textbackslash{}bar\{y\}\textbackslash{}bar\{y\}\}+\textbackslash{}sigma I\textbackslash{}\textbackslash{} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}f\mbox{]} in (@R\mbox{[}P\+\_\+ps\+\_\+tilde\mbox{]}@) by performing a fixed number of algebraic multigrid (A\+MG) cycles, . and by -\/ approximately solving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} subsidiary linear systems involving \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}$^\wedge$2 \textbackslash{}f\$ and \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}$^\wedge$2 \textbackslash{}f\$ by two consecutive linear solves involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}} themselves. Following Wathen \mbox{[}A. Wathen, \char`\"{}Realistic eigenvalue bounds for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Galerkin mass matrix\char`\"{}, I\+MA Journal of Numerical Analysis 7 (1987) 449-\/457\mbox{]}, $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}http\+:\+Muddle, Mihajlovic \&Heil(2012)$<$/a $>$ suggest employing CG, preconditioned by diagonal scaling, as \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solver for these systems. This solver converges so rapidly that a fixed number of four CG iterations suffices to compute \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solution to sufficient accuracy so that \textbackslash{}f\$ \textbackslash{}widetilde\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ can be treated as a constant preconditioner. . With these approximations, \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} computational cost of one application of \textbackslash{}f\$ \textbackslash{}widetilde\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ is linear in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of unknowns. The optimality of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner can therefore be assessed by demonstrating that \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of G\+M\+R\+ES iterations remains constant under mesh refinement.$<$ HR $>$$<$ HR $>$ \textbackslash{}section implementation Implementation and use of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner The preconditioner described above is implemented within \textbackslash{}c oomph-\/lib \textquotesingle{}s(parallel) block preconditioning framework which is described in$<$ a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}../../../mpi/block\+\_\+preconditioners/html/index.\+html\char`\"{}$>$ another tutorial$<$/a $>$. For \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} purpose of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} implementation, we decompose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioning matrix into \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} 2x2 \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} blocks indicated by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} vertical and horizontal lines in( @R\mbox{[}P\+\_\+ps\mbox{]}@) and( @R\mbox{[}P\+\_\+ps\+\_\+tilde\mbox{]}@). The application of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner requires \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} classification of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unknowns into \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} six(in 2D) different \char`\"{}dof \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}{types}}\char`\"{} discussed above. This is done on an element-\/by-\/element basis(since only \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} elements \char`\"{}know\char`\"{} what their nodal degrees of freedom correspond to) by implementing/overloading \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} functions -\/ \textbackslash{}c Generalised\+Element\+::ndof\+\_\+types(...) which returns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of dof \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}{types}} classified by that element. -\/ \textbackslash{}c Generalised\+Element\+::get\+\_\+block\+\_\+numbers\+\_\+for\+\_\+unknowns(...) which associates each degree of freedom(identified by its global equation number) with \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} dof type within its block. \textbackslash{}n\textbackslash{}n . For a 2D \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} enumeration of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} dofs is chosen as follows. The \textbackslash{}c Solid\+Elements classify only \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} nodal positions and sub-\/divide them into those that are constrained and not constrained by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement boundary condition so that within that block -\/ dof type 0 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained x-\/nodal coordinates, -\/ dof type 1 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained y-\/nodal coordinates, -\/ dof type 2 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained x-\/nodal coordinates, -\/ dof type 3 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained y-\/nodal coordinates. . The \textbackslash{}c Face\+Elements that apply \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint classify \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multipliers so that within that block -\/ dof type 0 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier, -\/ dof type 1 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} y-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier,. with \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} obvious generalisation to 3D.$<$ HR $>$$<$ HR $>$ \textbackslash{}section results Results We examine \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} performance of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} test \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} discussed in$<$ a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}../../../solid/prescribed\+\_\+displ\+\_\+lagr\+\_\+mult/html/index.\+html\char`\"{}$>$another tutorial$<$/a $>$\+:The upper surface of a unit square is subjected to a prescribed displacement that is imposed by Lagrange multipliers. The first of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} two tables below shows \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} G\+M\+R\+ES iteration counts(averaged over all linear solves performed in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} course of all Newton iterations) as a function of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} mesh refinement(represented by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} total number of unknowns) for different implementations of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner. -\/$<$ b $>$\char`\"{}Super\+LU\char`\"{}$<$/b $>$ corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} exact implementation of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ in which \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear systems involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} matrix \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ and \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} two squared mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}}, \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}$^\wedge$2 \textbackslash{}f\$ and \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}$^\wedge$2 \textbackslash{}f\$, are solved by Super\+L\+U. -\/$<$ b $>$\char`\"{}Upper triangular \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}\char`\"{}$<$/b $>$ corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} case in which \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ is replaced by its upper block-\/triangular approximation(corresponding to \textbackslash{}f\$ \textbackslash{}tilde\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$) but \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} four linear solves(two involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} diagonal blocks of \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
Hypre CG$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$/T\+A\+B\+LE $>$$<$/C\+E\+N\+T\+ER $>$$<$ C\+E\+N\+T\+ER $>$$<$ b $>$ c n\+\_\+dof for different implementations of the preconditioner$<$/C\+E\+N\+T\+ER $>$$<$ HR $>$ As the G\+M\+R\+ES iteration counts are small and mesh independent for the exact implementation of the preconditioner Replacing \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} (costly) exact solves by(faster) approximate solves leads to a modest increase in the(absolute) number of G\+M\+R\+ES iterations
\item 
Hypre CG$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$/T\+A\+B\+LE $>$$<$/C\+E\+N\+T\+ER $>$$<$ C\+E\+N\+T\+ER $>$$<$ b $>$ c n\+\_\+dof for different implementations of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner$<$/C\+E\+N\+T\+ER $>$$<$ HR $>$$<$ HR $>$$<$ HR $>$ section modifications Modifications to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} driver code Most of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} driver code is unchanged from \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} implementation discussed in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}}$<$ a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}../../../solid/prescribed\+\_\+displ\+\_\+lagr\+\_\+mult/html/index.\+html\char`\"{}$>$ original tutorial$<$/a $>$ We therefore only discuss \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} modifications required to employ preconditioned G\+M\+R\+ES as \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear solver for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Newton method$<$ HR $>$ subsection \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a131ba418ab194d0027e1c1c195fc9498}{reclass}} (Re-\/) classification of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} dof \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}{types}} As discussed above(and in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} more detailed$<$ a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
mainpage Demo \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}}
\item 
mainpage Demo e \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_adc9c71264c8fd28ea9b51353f707ef7a}{g}}
\item 
two involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} squared mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}}
\item 
two involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} squared mass f \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}
\item 
Hypre CG$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$/T\+A\+B\+LE $>$$<$/C\+E\+N\+T\+ER $>$$<$ C\+E\+N\+T\+ER $>$$<$ b $>$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_afd8da19e3e7a77e806ce7697a3f884a3}{Table}}
\item 
Hypre CG$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$/T\+A\+B\+LE $>$$<$/C\+E\+N\+T\+ER $>$$<$ C\+E\+N\+T\+ER $>$$<$ b $>$ c n\+\_\+dof for different implementations of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner$<$/C\+E\+N\+T\+ER $>$$<$ HR $>$ As \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ac57c5b9778010f1451d572bd585bcaa5}{expected}}
\item 
Hypre CG$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$/T\+A\+B\+LE $>$$<$/C\+E\+N\+T\+ER $>$$<$ C\+E\+N\+T\+ER $>$$<$ b $>$ c n\+\_\+dof for different implementations of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner$<$/C\+E\+N\+T\+ER $>$$<$ HR $>$ As \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} G\+M\+R\+ES iteration counts are small and mesh independent for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} exact implementation of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner Replacing while retaining virtual their mesh independence under sufficiently strong mesh refinement The benefit of switching to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} approximate solves becomes apparent in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} next table which shows \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} average cpu times required for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solution of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear systems by G\+M\+R\+ES For sufficiently fine discretisations \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} larger number of G\+M\+R\+ES iterations for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} inexact solves is more than compensated for by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} much lower cost of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioning operations The final implementation yields cpu times that are proportional to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of unknowns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} hallmark of an optimal solver$<$ HR $>$$<$ C\+E\+N\+T\+ER $>$$<$ T\+A\+B\+LE $>$$<$ TR $>$$<$ TD $>$$<$ C\+O\+DE $>$ n\+\_\+dof$<$/C\+O\+DE $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$ TR $>$$<$ TD $>$ Super\+LU$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$ TR $>$$<$ TD $>$ Upper triangular E$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$ TR $>$$<$ TD $>$ Upper triangular \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}
\item 
c Node\+::nvalue() returns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of values actually stored at a \textbackslash{}c Node -\/-\/ if this exceeds \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} value returned by \textbackslash{}c Finite\+Element The c Impose\+Displacement\+By\+Lagrange\+Multiplier\+Elements which we use to impose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint already label \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x and y\mbox{[}and, in 3D, z-\/\mbox{]} component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multipliers as dof \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}{types}}
\item 
c Node\+::nvalue() returns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of values actually stored at a \textbackslash{}c Node -\/-\/ if this exceeds \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} value returned by \textbackslash{}c Finite\+Element The c Impose\+Displacement\+By\+Lagrange\+Multiplier\+Elements which we use to impose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint already label \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x and y\mbox{[}and, in 3D, z-\/\mbox{]} component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multipliers as dof as required by our preconditioner Therefore no modification is required$<$ HR $>$ subsection driver Modifications to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} code The \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} code only requires minor \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ad96c337c66344dce050f1f887be694db}{changes}}
\item 
c Node\+::nvalue() returns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of values actually stored at a \textbackslash{}c Node -\/-\/ if this exceeds \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} value returned by \textbackslash{}c Finite\+Element The c Impose\+Displacement\+By\+Lagrange\+Multiplier\+Elements which we use to impose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint already label \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x and y\mbox{[}and, in 3D, z-\/\mbox{]} component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multipliers as dof as required by our preconditioner Therefore no modification is required$<$ HR $>$ subsection driver Modifications to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} code The \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} code only requires minor all associated with \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} specification of different solver options Since we provide \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} option to use Hypre and Trilinos \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a8c3099b6591d9f1ca3c845994f62b2a2}{solvers}}
\end{DoxyCompactItemize}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}\label{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!href@{href}}
\index{href@{href}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{href}{href}}
{\footnotesize\ttfamily using \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}} =  \char`\"{}http\+: 10.\+1016/j.\+jcp.\+2012.\+07.\+001$<$/a$>$ $<$/center$>$ $<$HR$>$ $<$HR$>$ \textbackslash{}section model Theory\+: Problem formulation, \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} resulting linear system and \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner We refer to $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}../../../solid/prescribed\+\_\+displ\+\_\+lagr\+\_\+mult/html/index.\+html\char`\"{}$>$ another tutorial$<$/a$>$ for a detailed description of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} setup and its discretisation. Briefly, we consider \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} deformation of an elastic solid body whose shape is parametrised by Lagrangian coordinates \textbackslash{}f\$ \textbackslash{}xi$^\wedge$i \textbackslash{}f\$. A part of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} body\textquotesingle{}s boundary, \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{prescr\}\textbackslash{}f\$, (which is parametrised by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} boundary coordinate \textbackslash{}f\$ \textbackslash{}zeta\textbackslash{}f\$) is displaced to a new position given by \textbackslash{}f\$ \{\textbackslash{}bf R\}\+\_\+\{prescr\}(\textbackslash{}zeta) \textbackslash{}f\$ while \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} other boundaries are held in a fixed position (as in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} sketch below) or are subject to traction boundary conditions. @I w 0.\+75\textbackslash{}textwidth sketch \char`\"{}Sketch of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} typical problem. \char`\"{} We discretise \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} using \textbackslash{}c Solid\+Elements in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} bulk of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} domain and employ lower-\/dimensional \textbackslash{}c Face\+Elements to impose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint along \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{prescr\}\textbackslash{}f\$. The \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} therefore contains \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} following \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}{types}} of discrete unknowns\+: -\/ The nodal positions (which are stored as positional \textbackslash{}c Data at each \textbackslash{}c Solid\+Node). \textbackslash{}n\textbackslash{}n -\/ The nodal values representing \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} components of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} (vector-\/valued) Lagrange multipliers. These only exist for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} nodes on \textbackslash{}f\$ \textbackslash{}partial D\+\_\+\{prescr\}\textbackslash{}f\$. (The nodes are re-\/sized to accommodate \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} additional unknowns when \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \textbackslash{}c Face\+Elements are attached to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} bulk elements.) . The preconditioner requires a further sub-\/division of these degrees of freedom into \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} following categories\+: -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained nodes -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} y-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained nodes -\/ \mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} z-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained nodes (only in 3D)\mbox{]} -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} y-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes -\/ \mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} z-\/coordinates of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes (only in 3D)\mbox{]} -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier at \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes -\/ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} y-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier at \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes -\/ \mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} z-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier at \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained nodes (only in 3D)\mbox{]}. . For a 2D \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}}, \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear system to be solved in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} course of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Newton iteration can then be (formally) re-\/ordered into \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} following block structure\+: \textbackslash{}f\mbox{[} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cccc$\vert$cc\} \{ E\+\_\+\{\textbackslash{}rm xx\}\}\&\{ E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ E\+\_\+\{\textbackslash{}rm xy\}\}\&\{ E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\&\textbackslash{}\textbackslash{} \{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\{ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}\}\&\textbackslash{}\textbackslash{} \{ E\+\_\+\{\textbackslash{}rm yx\}\}\&\{ E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ E\+\_\+\{\textbackslash{}rm yy\}\}\&\{ E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\&\textbackslash{}\textbackslash{} \{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\}\&\{ E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\}\&\&\{ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \textbackslash{}hline \&\{ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}\}\&\&\&\textbackslash{}\textbackslash{} \&\&\&\{ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}\}\&\& \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{c\} \textbackslash{}Delta \textbackslash{}mathbf\{X\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{X\}\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{X\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{\textbackslash{}overline\{X\}\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{L\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}Delta \textbackslash{}mathbf\{L\}\+\_\+\{\textbackslash{}rm y\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} = -\/ \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{c\} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm l\+\_\+x\}\textbackslash{}\textbackslash{} \textbackslash{}mathbf\{r\}\+\_\+\{\textbackslash{}rm l\+\_\+y\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}\mbox{[}linear\+\_\+system\mbox{]}@ \textbackslash{}f\mbox{]} Here \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} vectors \textbackslash{}f\$\{\textbackslash{}bf X\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$, \textbackslash{}f\$\{\textbackslash{}bf X\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$, \textbackslash{}f\$\{\textbackslash{}bf L\}\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$ and \textbackslash{}f\$\{\textbackslash{}bf L\}\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$ contain \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \textbackslash{}f\$x\textbackslash{}f\$ and \textbackslash{}f\$y\textbackslash{}f\$ components of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unknown nodal positions and Lagrange multipliers, respectively. The overbars identify \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unknown nodal positions that are constrained by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier. The \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}} \textbackslash{}f\$\+M\+\_\+\{\textbackslash{}rm x\}\textbackslash{}f\$ and \textbackslash{}f\$\+M\+\_\+\{\textbackslash{}rm y\}\textbackslash{}f\$ are mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}} whose entries are formed from products of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} basis functions, \textbackslash{}f\$\mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\{\textbackslash{}rm x\}\}\mbox{]}\+\_\+\{ij\}=\mbox{[}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\{\textbackslash{}rm y\}\}\mbox{]}\+\_\+\{ij\} = \textbackslash{}int\+\_\+\{\textbackslash{}partial D\+\_\+\{\textbackslash{}rm prescr\}\} \{\textbackslash{}psi\+\_\+i\} \textbackslash{} \{\textbackslash{}psi\+\_\+j\} \textbackslash{} dS \textbackslash{}f\$. $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}http\+: Muddle, Mihajlovic \& Heil (2012) $<$/a$>$ show that \textbackslash{}f\mbox{[} \{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\}=\textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cccc$\vert$cc\} E\+\_\+\{\textbackslash{}rm xx\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm xy\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\&\&\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}+\textbackslash{}sigma I\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\}\&\&\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}rm yx\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm yy\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\&\&\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}+\textbackslash{}sigma I\&\&\textbackslash{}\textbackslash{} \textbackslash{}hline \&\&\&\&\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}$^\wedge$2\&\textbackslash{}\textbackslash{} \&\&\&\&\&\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}$^\wedge$2\textbackslash{}\textbackslash{} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}\mbox{[}P\+\_\+ps\mbox{]}@ \textbackslash{}f\mbox{]} is an optimal preconditioner for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear system (@R\mbox{[}linear\+\_\+system\mbox{]}@) if we set \textbackslash{}f\$ \textbackslash{}sigma=\textbackslash{}$\vert$E\textbackslash{}$\vert$\+\_\+\{\textbackslash{}infty\} \textbackslash{}f\$ where \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}} \textbackslash{}f\$ is \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} compound 4x4 top-\/left block \textbackslash{}f\mbox{[} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}} = \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cccc\} E\+\_\+\{\textbackslash{}rm xx\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm xy\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\} \&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\} \textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}rm yx\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm yy\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\& E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}f\mbox{]} in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Jacobian matrix. The application of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner (i.\+e. \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solution of linear systems of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} form \textbackslash{}f\$ \{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{} \{\textbackslash{}bf x\} = \{\textbackslash{}bf y\} \textbackslash{}f\$ for \textbackslash{}f\$ \{\textbackslash{}bf x\} \textbackslash{}f\$) requires three linear solves\+: One involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} compound 4x4 top-\/left block in \textbackslash{}f\$ \{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$, \textbackslash{}f\mbox{[} E\+\_\+\{\textbackslash{}rm PS\}= \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cccc\} E\+\_\+\{\textbackslash{}rm xx\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm xy\}\&E\+\_\+\{\textbackslash{}rm x\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm x\}\}+\textbackslash{}sigma I\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm x\}\textbackslash{}bar\{\textbackslash{}rm y\}\} \textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}rm yx\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm x\}\}\&E\+\_\+\{\textbackslash{}rm yy\}\&E\+\_\+\{\textbackslash{}rm y\textbackslash{}bar\{\textbackslash{}rm y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm x\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm x\}\}\& E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}rm y\}\&E\+\_\+\{\textbackslash{}bar\{\textbackslash{}rm y\}\textbackslash{}bar\{\textbackslash{}rm y\}\}+\textbackslash{}sigma I \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}f\mbox{]} and two involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} two squared mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}}, \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}$^\wedge$2 \textbackslash{}f\$ and \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}$^\wedge$2 \textbackslash{}f\$. Numerical experiments in $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}http\+: Muddle, Mihajlovic \& Heil (2012) $<$/a$>$ show that an efficient implementation of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner is obtained by replacing \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ block in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner \textbackslash{}f\$ \{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ by its upper block-\/triangular approximation, corresponding to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner \textbackslash{}f\mbox{[} \textbackslash{}widetilde\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\}=\textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cccc$\vert$cc\} E\+\_\+\{xx\}\&E\+\_\+\{x\textbackslash{}bar\{x\}\}\&E\+\_\+\{xy\}\&E\+\_\+\{x\textbackslash{}bar\{y\}\}\&\&\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{x\}x\}\&E\+\_\+\{\textbackslash{}bar\{x\}\textbackslash{}bar\{x\}\}+\textbackslash{}sigma I\&E\+\_\+\{\textbackslash{}bar\{x\}y\}\&E\+\_\+\{\textbackslash{}bar\{x\}\textbackslash{}bar\{y\}\}\&\&\textbackslash{}\textbackslash{} \&\&E\+\_\+\{yy\}\&E\+\_\+\{y\textbackslash{}bar\{y\}\}\&\&\textbackslash{}\textbackslash{} \&\&E\+\_\+\{\textbackslash{}bar\{y\}y\}\&E\+\_\+\{\textbackslash{}bar\{y\}\textbackslash{}bar\{y\}\}+\textbackslash{}sigma I\&\&\textbackslash{}\textbackslash{} \textbackslash{}hline \&\&\&\&\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}M\+\_\+x$^\wedge$2\&\textbackslash{}\textbackslash{} \&\&\&\&\&\textbackslash{}frac\{1\}\{\textbackslash{}sigma\}M\+\_\+y$^\wedge$2\textbackslash{}\textbackslash{} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]}. \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} @\mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}\mbox{[}P\+\_\+ps\+\_\+tilde\mbox{]}@ \textbackslash{}f\mbox{]} Furthermore, a fully optimal preconditioner (in which \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solve times scale linearly with \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of unknowns) can be obtained by\+: -\/ approximately solving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} subsidiary linear systems involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} diagonal blocks \textbackslash{}f\mbox{[} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cc\} E\+\_\+\{xx\}\&E\+\_\+\{x\textbackslash{}bar\{x\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{x\}x\}\&E\+\_\+\{\textbackslash{}bar\{x\}\textbackslash{}bar\{x\}\}+\textbackslash{}sigma I\textbackslash{}\textbackslash{} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}mbox\{\textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} and\textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \textbackslash{} \} \textbackslash{}left\mbox{[} \textbackslash{}begin\{array\}\{cc\} E\+\_\+\{yy\}\&E\+\_\+\{y\textbackslash{}bar\{y\}\}\textbackslash{}\textbackslash{} E\+\_\+\{\textbackslash{}bar\{y\}y\}\&E\+\_\+\{\textbackslash{}bar\{y\}\textbackslash{}bar\{y\}\}+\textbackslash{}sigma I\textbackslash{}\textbackslash{} \textbackslash{}end\{array\} \textbackslash{}right\mbox{]} \textbackslash{}f\mbox{]} in (@R\mbox{[}P\+\_\+ps\+\_\+tilde\mbox{]}@) by performing a fixed number of algebraic multigrid (A\+MG) cycles, . and by -\/ approximately solving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} subsidiary linear systems involving \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}$^\wedge$2 \textbackslash{}f\$ and \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}$^\wedge$2 \textbackslash{}f\$ by two consecutive linear solves involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}} themselves. Following Wathen \mbox{[}A. Wathen, \char`\"{}Realistic eigenvalue bounds for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Galerkin mass matrix\char`\"{}, I\+MA Journal of Numerical Analysis 7 (1987) 449-\/457\mbox{]}, $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}http\+: Muddle, Mihajlovic \& Heil (2012) $<$/a$>$ suggest employing CG, preconditioned by diagonal scaling, as \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solver for these systems. This solver converges so rapidly that a fixed number of four CG iterations suffices to compute \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solution to sufficient accuracy so that \textbackslash{}f\$ \textbackslash{}widetilde\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ can be treated as a constant preconditioner. . With these approximations, \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} computational cost of one application of \textbackslash{}f\$ \textbackslash{}widetilde\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ is linear in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of unknowns. The optimality of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner can therefore be assessed by demonstrating that \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of G\+M\+R\+ES iterations remains constant under mesh refinement. $<$HR$>$ $<$HR$>$ \textbackslash{}section implementation Implementation and use of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner The preconditioner described above is implemented within \textbackslash{}c oomph-\/lib\textquotesingle{}s (parallel) block preconditioning framework which is described in $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}../../../mpi/block\+\_\+preconditioners/html/index.\+html\char`\"{}$>$ another tutorial$<$/a$>$. For \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} purpose of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} implementation, we decompose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioning matrix into \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} 2x2 \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} blocks indicated by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} vertical and horizontal lines in (@R\mbox{[}P\+\_\+ps\mbox{]}@) and (@R\mbox{[}P\+\_\+ps\+\_\+tilde\mbox{]}@). The application of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner requires \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} classification of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unknowns into \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} six (in 2D) different \char`\"{}dof \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}{types}}\char`\"{} discussed above. This is done on an element-\/by-\/element basis (since only \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} elements \char`\"{}know\char`\"{} what their nodal degrees of freedom correspond to) by implementing/overloading \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} functions -\/ \textbackslash{}c Generalised\+Element\+::ndof\+\_\+types(...) which returns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of dof \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}{types}} classified by that element. -\/ \textbackslash{}c Generalised\+Element\+::get\+\_\+block\+\_\+numbers\+\_\+for\+\_\+unknowns(...) which associates each degree of freedom (identified by its global equation number) with \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} dof type within its block. \textbackslash{}n\textbackslash{}n . For a 2D \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} enumeration of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} dofs is chosen as follows. The \textbackslash{}c Solid\+Elements classify only \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} nodal positions and sub-\/divide them into those that are constrained and not constrained by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement boundary condition so that within that block -\/ dof type 0 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained x-\/nodal coordinates, -\/ dof type 1 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} unconstrained y-\/nodal coordinates, -\/ dof type 2 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained x-\/nodal coordinates, -\/ dof type 3 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} constrained y-\/nodal coordinates. . The \textbackslash{}c Face\+Elements that apply \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint classify \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multipliers so that within that block -\/ dof type 0 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier, -\/ dof type 1 corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} y-\/component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multiplier, . with \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} obvious generalisation to 3D. $<$HR$>$ $<$HR$>$ \textbackslash{}section results Results We examine \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} performance of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} test \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}{problem}} discussed in $<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}../../../solid/prescribed\+\_\+displ\+\_\+lagr\+\_\+mult/html/index.\+html\char`\"{}$>$another tutorial$<$/a$>$\+: The upper surface of a unit square is subjected to a prescribed displacement that is imposed by Lagrange multipliers. The first of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} two tables below shows \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} G\+M\+R\+ES iteration counts (averaged over all linear solves performed in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} course of all Newton iterations) as a function of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} mesh refinement (represented by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} total number of unknowns) for different implementations of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner. -\/ $<$b$>$\char`\"{}Super\+LU\char`\"{}$<$/b$>$ corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} exact implementation of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ in which \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear systems involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} matrix \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ and \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} two squared mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}}, \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm x\}$^\wedge$2 \textbackslash{}f\$ and \textbackslash{}f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\+\_\+}}\{\textbackslash{}rm y\}$^\wedge$2 \textbackslash{}f\$, are solved by Super\+L\+U. -\/ $<$b$>$\char`\"{}Upper triangular \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}\char`\"{}$<$/b$>$ corresponds to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} case in which \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$ is replaced by its upper block-\/triangular approximation (corresponding to \textbackslash{}f\$ \textbackslash{}tilde\{\textbackslash{}cal P\}\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$) but \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} four linear solves (two involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} diagonal blocks of \textbackslash{}f\$ E\+\_\+\{\textbackslash{}rm PS\} \textbackslash{}f\$}



Definition at line 311 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_a131ba418ab194d0027e1c1c195fc9498}\label{prescribed__displ__lagr__mult_8txt_a131ba418ab194d0027e1c1c195fc9498}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!reclass@{reclass}}
\index{reclass@{reclass}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{reclass()}{reclass()}}
{\footnotesize\ttfamily Hypre CG$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$/TR$>$$<$/T\+A\+B\+LE$>$$<$/C\+E\+N\+T\+ER$>$$<$C\+E\+N\+T\+ER$>$$<$b$>$ c n\+\_\+dof for different implementations of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner$<$/C\+E\+N\+T\+ER$>$$<$HR$>$$<$HR$>$$<$HR$>$ section modifications Modifications to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} driver code Most of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} driver code is unchanged from \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} implementation discussed in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}}$<$a \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a405e4ca90ca08ae8f712a3c537390a7c}{href}}=\char`\"{}../../../solid/prescribed\+\_\+displ\+\_\+lagr\+\_\+mult/html/index.\+html\char`\"{}$>$ original tutorial$<$/a$>$ We therefore only discuss \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} modifications required to employ preconditioned G\+M\+R\+ES as \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear solver for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Newton method$<$HR$>$ subsection reclass (\begin{DoxyParamCaption}\item[{Re-\/}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}\label{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!the@{the}}
\index{the@{the}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{the()}{the()}}
{\footnotesize\ttfamily Hypre CG$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$/TR$>$$<$/T\+A\+B\+LE$>$$<$/C\+E\+N\+T\+ER$>$$<$C\+E\+N\+T\+ER$>$$<$b$>$ c n\+\_\+dof for different implementations of the preconditioner$<$/C\+E\+N\+T\+ER$>$$<$HR$>$ As the G\+M\+R\+ES iteration counts are small and mesh independent for the exact implementation of the preconditioner Replacing the (\begin{DoxyParamCaption}\item[{costly}]{ }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_ad96c337c66344dce050f1f887be694db}\label{prescribed__displ__lagr__mult_8txt_ad96c337c66344dce050f1f887be694db}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!changes@{changes}}
\index{changes@{changes}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{changes}{changes}}
{\footnotesize\ttfamily c Node\+::nvalue () returns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of values actually stored at a \textbackslash{}c Node -\/-\/ if this exceeds \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} value returned by \textbackslash{}c Finite\+Element The c Impose\+Displacement\+By\+Lagrange\+Multiplier\+Elements which we use to impose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint already label \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x and y \mbox{[}and, in 3D, z-\/\mbox{]} component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multipliers as dof as required by our preconditioner Therefore no modification is required$<$HR$>$ subsection driver Modifications to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} code The \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} code only requires minor changes}



Definition at line 431 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}\label{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!E@{E}}
\index{E@{E}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{E}{E}}
{\footnotesize\ttfamily Hypre CG$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$/TR$>$$<$/T\+A\+B\+LE$>$$<$/C\+E\+N\+T\+ER$>$$<$C\+E\+N\+T\+ER$>$$<$b$>$ c n\+\_\+dof for different implementations of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner$<$/C\+E\+N\+T\+ER$>$$<$HR$>$ As \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} G\+M\+R\+ES iteration counts are small and mesh independent for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} exact implementation of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner Replacing while retaining virtual their mesh independence under sufficiently strong mesh refinement The benefit of switching to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} approximate solves becomes apparent in \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} next table which shows \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} average cpu times required for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} solution of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} linear systems by G\+M\+R\+ES For sufficiently fine discretisations \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} larger number of G\+M\+R\+ES iterations for \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} inexact solves is more than compensated for by \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} much lower cost of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioning operations The final implementation yields cpu times that are proportional to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of unknowns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} hallmark of an optimal solver$<$HR$>$$<$C\+E\+N\+T\+ER$>$$<$T\+A\+B\+LE$>$$<$TR$>$$<$TD$>$$<$C\+O\+DE$>$ n\+\_\+dof$<$/C\+O\+DE$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$/TR$>$$<$TR$>$$<$TD$>$ Super\+LU$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$/TR$>$$<$TR$>$$<$TD$>$ Upper triangular E$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$/TR$>$$<$TR$>$$<$TD$>$ Upper triangular E}



Definition at line 356 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_ac57c5b9778010f1451d572bd585bcaa5}\label{prescribed__displ__lagr__mult_8txt_ac57c5b9778010f1451d572bd585bcaa5}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!expected@{expected}}
\index{expected@{expected}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{expected}{expected}}
{\footnotesize\ttfamily Hypre CG$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$TD$>$$<$/TD$>$$<$/TR$>$$<$/T\+A\+B\+LE$>$$<$/C\+E\+N\+T\+ER$>$$<$C\+E\+N\+T\+ER$>$$<$b$>$ c n\+\_\+dof for different implementations of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner$<$/C\+E\+N\+T\+ER$>$$<$HR$>$ As expected}



Definition at line 335 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_adc9c71264c8fd28ea9b51353f707ef7a}\label{prescribed__displ__lagr__mult_8txt_adc9c71264c8fd28ea9b51353f707ef7a}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!g@{g}}
\index{g@{g}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{g}{g}}
{\footnotesize\ttfamily mainpage Demo e g}



Definition at line 8 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}\label{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!M\_@{M\_}}
\index{M\_@{M\_}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{M\_}{M\_}}
{\footnotesize\ttfamily two involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} squared mass f M\+\_\+}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{\(\backslash\)rm x\}\string^2 \(\backslash\)f\$ and \(\backslash\)f\$ \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a52114c729dd56a272dc5f6b0ffd36416}{M\_}}\{\(\backslash\)rm y\}\string^2 \(\backslash\)f\$), are performed by SuperLU.}
\DoxyCodeLine{-\/ <b>\textcolor{stringliteral}{"Upper triangular E; Hypre/CG"}</b> are \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} results obtained when \textcolor{keyword}{using}}
\DoxyCodeLine{  \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} same block approximation of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} preconditioner, but \textcolor{keyword}{using} }
\DoxyCodeLine{  two AMG cycles (performed with Hypre) \textcolor{keywordflow}{for} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} approximate solution}
\DoxyCodeLine{  of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} diagonal blocks of \(\backslash\)f\$ E\_\{\(\backslash\)rm PS\} \(\backslash\)f\$, and diagonally}
\DoxyCodeLine{  preconditioned CG as \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} approximate solver \textcolor{keywordflow}{for} \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} mass \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}{matrices}}.}
\DoxyCodeLine{.}
\DoxyCodeLine{}
\DoxyCodeLine{<HR>}
\DoxyCodeLine{<CENTER><TABLE>}
\DoxyCodeLine{<TR> <TD> <CODE>n\_dof</CODE> </TD> <TD> 798 </TD> <TD> 3198 </TD> <TD> 12798 </TD> <TD> 51198 </TD> <TD> 204798 </TD>  </TR>}
\DoxyCodeLine{<TR><TD>SuperLU </TD> <TD> 8.1 </TD> <TD> 8.1 </TD> <TD> 8.3 </TD> <TD> 8.3 </TD> <TD> 8.3 </TD>  </TR>}
\DoxyCodeLine{<TR><TD>Upper triangular \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}</TD> <TD> 24.9 </TD> <TD> 26.9 </TD> <TD> 28.4 </TD> <TD> 28.7 </TD> <TD> 28.9 </TD>  </TR>}
\DoxyCodeLine{<TR><TD>Upper triangular \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_a1fd791a35e5f41934843ddbee6ff65e2}{E}}}

\end{DoxyCode}


Definition at line 312 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}\label{prescribed__displ__lagr__mult_8txt_aebbe7d9927a145b69b885759da7f7d03}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!matrices@{matrices}}
\index{matrices@{matrices}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{matrices}{matrices}}
{\footnotesize\ttfamily two involving \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} squared mass matrices}



Definition at line 311 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}\label{prescribed__displ__lagr__mult_8txt_a4074baada03976c061d5672f4237cca5}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!problem@{problem}}
\index{problem@{problem}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{problem}{problem}}
{\footnotesize\ttfamily mainpage Demo problem}



Definition at line 8 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.



Referenced by main().

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_a8c3099b6591d9f1ca3c845994f62b2a2}\label{prescribed__displ__lagr__mult_8txt_a8c3099b6591d9f1ca3c845994f62b2a2}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!solvers@{solvers}}
\index{solvers@{solvers}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{solvers}{solvers}}
{\footnotesize\ttfamily c Node\+::nvalue () returns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of values actually stored at a \textbackslash{}c Node -\/-\/ if this exceeds \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} value returned by \textbackslash{}c Finite\+Element The c Impose\+Displacement\+By\+Lagrange\+Multiplier\+Elements which we use to impose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint already label \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x and y \mbox{[}and, in 3D, z-\/\mbox{]} component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multipliers as dof as required by our preconditioner Therefore no modification is required$<$HR$>$ subsection driver Modifications to \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} code The \mbox{\hyperlink{prescribed__displ__lagr__mult__precond_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}} code only requires minor all associated with \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} specification of different solver options Since we provide \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} option to use Hypre and Trilinos solvers}



Definition at line 440 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_afd8da19e3e7a77e806ce7697a3f884a3}\label{prescribed__displ__lagr__mult_8txt_afd8da19e3e7a77e806ce7697a3f884a3}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!Table@{Table}}
\index{Table@{Table}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{Table}{Table}}
{\footnotesize\ttfamily Hypre CG$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$ TD $>$$<$/TD $>$$<$/TR $>$$<$/T\+A\+B\+LE $>$$<$/C\+E\+N\+T\+ER $>$$<$ C\+E\+N\+T\+ER $>$$<$ b $>$ Table}



Definition at line 330 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

\mbox{\Hypertarget{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}\label{prescribed__displ__lagr__mult_8txt_ab8b6820b8cafc4421f7547b0da6563c7}} 
\index{prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}!types@{types}}
\index{types@{types}!prescribed\_displ\_lagr\_mult.txt@{prescribed\_displ\_lagr\_mult.txt}}
\doxysubsubsection{\texorpdfstring{types}{types}}
{\footnotesize\ttfamily c Node\+::nvalue () returns \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} number of values actually stored at a \textbackslash{}c Node -\/-\/ if this exceeds \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} value returned by \textbackslash{}c Finite\+Element The c Impose\+Displacement\+By\+Lagrange\+Multiplier\+Elements which we use to impose \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} displacement constraint already label \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} x and y \mbox{[}and, in 3D, z-\/\mbox{]} component of \mbox{\hyperlink{prescribed__displ__lagr__mult_8txt_ab8b40917eda026da4cc056cf8dfdfe69}{the}} Lagrange multipliers as dof types}



Definition at line 419 of file prescribed\+\_\+displ\+\_\+lagr\+\_\+mult.\+txt.

