\hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{}\doxysection{oomph\+::P\+Refineable\+Q\+Element$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$ Class Template Reference}
\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}


p-\/refineable version of Refineable\+Q\+Element$<$2,\+I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1\+D$>$.  




{\ttfamily \#include $<$hp\+\_\+refineable\+\_\+elements.\+h$>$}

Inheritance diagram for oomph\+::P\+Refineable\+Q\+Element$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.299120cm]{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_ab944f5fb0b3e712d696ea2c33ac09a16}{P\+Refineable\+Q\+Element}} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a4f90a667998d7826a7be2b089ac76c03}{$\sim$\+P\+Refineable\+Q\+Element}} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a8f5e49dc263238c79f8f924fdb6d035d}{initial\+\_\+setup}} (\mbox{\hyperlink{classoomph_1_1Tree}{Tree}} $\ast$const \&adopted\+\_\+father\+\_\+pt=0, const unsigned \&\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_af5792fe3ee774090f759b0a7dac6fddc}{initial\+\_\+p\+\_\+order}}=0)
\begin{DoxyCompactList}\small\item\em Initial setup of element (set the correct p-\/order and integration scheme) If an adopted father is specified, information from this is used instead of using the father found from the tree. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a1bb8bcd4562fcdfbac80f4db0f38ed76}{pre\+\_\+build}} (\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}} $\ast$\&mesh\+\_\+pt, \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$ $>$ \&new\+\_\+node\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Pre-\/build (search father for required nodes which may already exist) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_aa74bd994a95736da7c0c92297959b026}{p\+\_\+refine}} (const int \&inc, \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}} $\ast$const \&mesh\+\_\+pt, \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{Generalised\+Element}} $\ast$const \&clone\+\_\+pt)
\begin{DoxyCompactList}\small\item\em p-\/refine the element (refine if inc$>$0, unrefine if inc$<$0). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a2ec50a2b731e5e8b969f116606cab6ca}{shape}} (const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&\mbox{\hyperlink{the__data__structure_8txt_acdf437512dc428cd2c5e8b3aa8b92896}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} \&psi) const
\begin{DoxyCompactList}\small\item\em Overload the shape functions. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a068e2fc2edfe459b07c373d8d1546c51}{dshape\+\_\+local}} (const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&\mbox{\hyperlink{the__data__structure_8txt_acdf437512dc428cd2c5e8b3aa8b92896}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} \&psi, \mbox{\hyperlink{classoomph_1_1DShape}{D\+Shape}} \&dpsi) const
\begin{DoxyCompactList}\small\item\em Derivatives of shape functions for \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{P\+Refineable\+Q\+Element$<$\+D\+I\+M$>$}} \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a4960e6e81844b8387096c3f1679055ef}{d2shape\+\_\+local}} (const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&\mbox{\hyperlink{the__data__structure_8txt_acdf437512dc428cd2c5e8b3aa8b92896}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} \&psi, \mbox{\hyperlink{classoomph_1_1DShape}{D\+Shape}} \&dpsids, \mbox{\hyperlink{classoomph_1_1DShape}{D\+Shape}} \&d2psids) const
\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a73d08f7b72685de1d8dd9ac30b8ddfec}{further\+\_\+setup\+\_\+hanging\+\_\+nodes}} ()
\begin{DoxyCompactList}\small\item\em Perform additional hanging node procedures for variables that are not interpolated by all nodes (e.\+g. lower order interpolations for the pressure in Taylor Hood). ~\newline
 \end{DoxyCompactList}\item 
unsigned \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_ad272711d69364c090fd332937ac6428c}{nnode\+\_\+1d}} () const
\begin{DoxyCompactList}\small\item\em Returns the number of nodes along each edge of the element. Overloaded to return the (variable) p-\/order rather than the template argument. \end{DoxyCompactList}\item 
unsigned \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_af5792fe3ee774090f759b0a7dac6fddc}{initial\+\_\+p\+\_\+order}} () const
\begin{DoxyCompactList}\small\item\em Get the initial P\+\_\+order. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$ \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a50a41c20cf1ab02ed17e1b74f571fd22}{get\+\_\+node\+\_\+at\+\_\+local\+\_\+coordinate}} (const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&\mbox{\hyperlink{the__data__structure_8txt_acdf437512dc428cd2c5e8b3aa8b92896}{s}}) const
\begin{DoxyCompactList}\small\item\em Return the node at the specified local coordinate. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$ \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_aaaef5f28edec53e201f87c3c9f2c0f61}{node\+\_\+created\+\_\+by\+\_\+neighbour}} (const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&s\+\_\+fraction, bool \&is\+\_\+periodic)
\item 
\mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$ \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_abe1f777a74c6996aaa3cfbdb2dee1c72}{node\+\_\+created\+\_\+by\+\_\+son\+\_\+of\+\_\+neighbour}} (const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&s\+\_\+fraction, bool \&is\+\_\+periodic)
\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a30e312b39ead5fbea0839bd5b9a8dea3}{local\+\_\+coordinate\+\_\+of\+\_\+node}} (const unsigned \&\mbox{\hyperlink{the__data__structure_8txt_af88b2d950fae19ab641bd1690e08445c}{n}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&\mbox{\hyperlink{the__data__structure_8txt_acdf437512dc428cd2c5e8b3aa8b92896}{s}}) const
\begin{DoxyCompactList}\small\item\em Get local coordinates of node j in the element; vector sets its own size. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a2ba8be38964ccde650ff649a78a49a34}{local\+\_\+fraction\+\_\+of\+\_\+node}} (const unsigned \&\mbox{\hyperlink{the__data__structure_8txt_af88b2d950fae19ab641bd1690e08445c}{n}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&s\+\_\+fraction)
\begin{DoxyCompactList}\small\item\em Get the local fractino of node j in the element. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_af8b496db53a5d54b058f58f320e803f4}{local\+\_\+one\+\_\+d\+\_\+fraction\+\_\+of\+\_\+node}} (const unsigned \&n1d, const unsigned \&\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})
\begin{DoxyCompactList}\small\item\em The local one-\/d fraction is the same. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a53d48e7e3310a02a315562ed628bd4b5}{rebuild\+\_\+from\+\_\+sons}} (\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}} $\ast$\&mesh\+\_\+pt)
\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a1ceeaf2697c7924870a7e606240ada38}{check\+\_\+integrity}} (double \&max\+\_\+error)
\begin{DoxyCompactList}\small\item\em Check the integrity of interpolated values across element boundaries. Note\+: with the mortar method, continuity is enforced weakly across non-\/ conforming element boundaries, so it makes no sense to check the continuity of interpolated values across these boundaries. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_abf33572d0ba9cd9bf06ca137256c422d}{quad\+\_\+hang\+\_\+helper}} (const int \&value\+\_\+id, const int \&my\+\_\+edge, std\+::ofstream \&output\+\_\+hangfile)
\begin{DoxyCompactList}\small\item\em Set up hanging node information. Overloaded to implement the mortar method rather than constrained approximation. This enforces continuity weakly via an integral matching condition at non-\/conforming element boundaries. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$\newline
class oomph\+::\+P\+Refineable\+Q\+Element$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1\+D $>$}

p-\/refineable version of Refineable\+Q\+Element$<$2,\+I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1\+D$>$. 

Definition at line 139 of file hp\+\_\+refineable\+\_\+elements.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_ab944f5fb0b3e712d696ea2c33ac09a16}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_ab944f5fb0b3e712d696ea2c33ac09a16}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!PRefineableQElement@{PRefineableQElement}}
\index{PRefineableQElement@{PRefineableQElement}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{PRefineableQElement()}{PRefineableQElement()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{P\+Refineable\+Q\+Element}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 



Definition at line 146 of file hp\+\_\+refineable\+\_\+elements.\+h.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a4f90a667998d7826a7be2b089ac76c03}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a4f90a667998d7826a7be2b089ac76c03}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!````~PRefineableQElement@{$\sim$PRefineableQElement}}
\index{````~PRefineableQElement@{$\sim$PRefineableQElement}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{$\sim$PRefineableQElement()}{~PRefineableQElement()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
virtual \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::$\sim$\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{P\+Refineable\+Q\+Element}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Destructor. 



Definition at line 150 of file hp\+\_\+refineable\+\_\+elements.\+h.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a1ceeaf2697c7924870a7e606240ada38}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a1ceeaf2697c7924870a7e606240ada38}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!check\_integrity@{check\_integrity}}
\index{check\_integrity@{check\_integrity}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{check\_integrity()}{check\_integrity()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::check\+\_\+integrity (\begin{DoxyParamCaption}\item[{double \&}]{max\+\_\+error }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Check the integrity of interpolated values across element boundaries. Note\+: with the mortar method, continuity is enforced weakly across non-\/ conforming element boundaries, so it makes no sense to check the continuity of interpolated values across these boundaries. 

Check inter-\/element continuity of
\begin{DoxyItemize}
\item nodal positions
\item (nodally) interpolated function values Overloaded to not check differences in the value. Mortaring doesn\textquotesingle{}t enforce strong continuity between elements. 
\end{DoxyItemize}

Implements \mbox{\hyperlink{classoomph_1_1RefineableElement_ae665f2d2eb0b6410ddcb101caa80922a}{oomph\+::\+Refineable\+Element}}.



Definition at line 3669 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Quad\+Tree\+Names\+::E, e, oomph\+::\+Quad\+Tree\+::gteq\+\_\+edge\+\_\+neighbour(), i, oomph\+::\+Finite\+Element\+::interpolated\+\_\+x(), oomph\+::\+Tree\+Root\+::is\+\_\+neighbour\+\_\+periodic(), oomph\+::\+Finite\+Element\+::macro\+\_\+elem\+\_\+pt(), oomph\+::\+Quad\+Tree\+Names\+::N, oomph\+::\+Refineable\+Element\+::ncont\+\_\+interpolated\+\_\+values(), oomph\+::\+Refineable\+Element\+::nodes\+\_\+built(), oomph\+::\+Tree\+::nsons(), oomph\+::\+Tree\+::object\+\_\+pt(), oomph\+::oomph\+\_\+info, oomph\+::\+Tree\+::root\+\_\+pt(), oomph\+::\+Quad\+Tree\+Names\+::S, s, t, values, oomph\+::\+Quad\+Tree\+Names\+::W, and oomph\+::\+Node\+::x().

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a4960e6e81844b8387096c3f1679055ef}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a4960e6e81844b8387096c3f1679055ef}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!d2shape\_local@{d2shape\_local}}
\index{d2shape\_local@{d2shape\_local}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{d2shape\_local()}{d2shape\_local()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::d2shape\+\_\+local (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s,  }\item[{\mbox{\hyperlink{classoomph_1_1Shape}{Shape}} \&}]{psi,  }\item[{\mbox{\hyperlink{classoomph_1_1DShape}{D\+Shape}} \&}]{dpsids,  }\item[{\mbox{\hyperlink{classoomph_1_1DShape}{D\+Shape}} \&}]{d2psids }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}

Second derivatives of shape functions for \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{P\+Refineable\+Q\+Element$<$\+D\+I\+M$>$}} d2psids(i,0) = $ d^2 \psi_j / d s^2 $ 

Reimplemented from \mbox{\hyperlink{classoomph_1_1FiniteElement_a53e5051582d9da07b9d35da9debd0cd7}{oomph\+::\+Finite\+Element}}.



Definition at line 3123 of file hp\+\_\+refineable\+\_\+elements.\+cc.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a068e2fc2edfe459b07c373d8d1546c51}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a068e2fc2edfe459b07c373d8d1546c51}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!dshape\_local@{dshape\_local}}
\index{dshape\_local@{dshape\_local}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{dshape\_local()}{dshape\_local()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::dshape\+\_\+local (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s,  }\item[{\mbox{\hyperlink{classoomph_1_1Shape}{Shape}} \&}]{psi,  }\item[{\mbox{\hyperlink{classoomph_1_1DShape}{D\+Shape}} \&}]{dpsi }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Derivatives of shape functions for \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{P\+Refineable\+Q\+Element$<$\+D\+I\+M$>$}} 



Reimplemented from \mbox{\hyperlink{classoomph_1_1FiniteElement_a9db1456b827131c21a991ac9fedf4b0c}{oomph\+::\+Finite\+Element}}.



Definition at line 2958 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+One\+Dimensional\+Legendre\+Shape$<$ N\+N\+O\+D\+E\+\_\+1\+D $>$\+::calculate\+\_\+nodal\+\_\+positions(), i, and s.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a73d08f7b72685de1d8dd9ac30b8ddfec}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a73d08f7b72685de1d8dd9ac30b8ddfec}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!further\_setup\_hanging\_nodes@{further\_setup\_hanging\_nodes}}
\index{further\_setup\_hanging\_nodes@{further\_setup\_hanging\_nodes}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{further\_setup\_hanging\_nodes()}{further\_setup\_hanging\_nodes()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::further\+\_\+setup\+\_\+hanging\+\_\+nodes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Perform additional hanging node procedures for variables that are not interpolated by all nodes (e.\+g. lower order interpolations for the pressure in Taylor Hood). ~\newline
 



Implements \mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_a01e1eb063dd2c98ebb42d87959ca6b88}{oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$}}.



Definition at line 177 of file hp\+\_\+refineable\+\_\+elements.\+h.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a50a41c20cf1ab02ed17e1b74f571fd22}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a50a41c20cf1ab02ed17e1b74f571fd22}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!get\_node\_at\_local\_coordinate@{get\_node\_at\_local\_coordinate}}
\index{get\_node\_at\_local\_coordinate@{get\_node\_at\_local\_coordinate}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{get\_node\_at\_local\_coordinate()}{get\_node\_at\_local\_coordinate()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
\mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$ \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::get\+\_\+node\+\_\+at\+\_\+local\+\_\+coordinate (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Return the node at the specified local coordinate. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{oomph\+::\+Finite\+Element}}.



Definition at line 1305 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Orthpoly\+::gll\+\_\+nodes(), i, n, oomph\+::\+Finite\+Element\+::\+Node\+\_\+location\+\_\+tolerance, and s.



Referenced by p\+\_\+refine().

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_af5792fe3ee774090f759b0a7dac6fddc}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_af5792fe3ee774090f759b0a7dac6fddc}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!initial\_p\_order@{initial\_p\_order}}
\index{initial\_p\_order@{initial\_p\_order}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{initial\_p\_order()}{initial\_p\_order()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
unsigned \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::initial\+\_\+p\+\_\+order (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Get the initial P\+\_\+order. 



Implements \mbox{\hyperlink{classoomph_1_1PRefineableElement_a6babd48e981414ad54cbfc1d89977f43}{oomph\+::\+P\+Refineable\+Element}}.



Definition at line 185 of file hp\+\_\+refineable\+\_\+elements.\+h.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a8f5e49dc263238c79f8f924fdb6d035d}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a8f5e49dc263238c79f8f924fdb6d035d}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!initial\_setup@{initial\_setup}}
\index{initial\_setup@{initial\_setup}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{initial\_setup()}{initial\_setup()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::initial\+\_\+setup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1Tree}{Tree}} $\ast$const \&}]{adopted\+\_\+father\+\_\+pt = {\ttfamily 0},  }\item[{const unsigned \&}]{initial\+\_\+p\+\_\+order = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Initial setup of element (set the correct p-\/order and integration scheme) If an adopted father is specified, information from this is used instead of using the father found from the tree. 

Set the correct p-\/order of the element based on that of its father. Then construct an integration scheme of the correct order. If an adopted father is specified, information from this is used instead of using the father found from the tree. 

Reimplemented from \mbox{\hyperlink{classoomph_1_1RefineableElement_a61ae74d94be7abc7231f34f3322f8e13}{oomph\+::\+Refineable\+Element}}.



Definition at line 1617 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Tree\+::object\+\_\+pt(), and oomph\+::\+P\+Refineable\+Element\+::p\+\_\+order().

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a30e312b39ead5fbea0839bd5b9a8dea3}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a30e312b39ead5fbea0839bd5b9a8dea3}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!local\_coordinate\_of\_node@{local\_coordinate\_of\_node}}
\index{local\_coordinate\_of\_node@{local\_coordinate\_of\_node}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{local\_coordinate\_of\_node()}{local\_coordinate\_of\_node()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::local\+\_\+coordinate\+\_\+of\+\_\+node (\begin{DoxyParamCaption}\item[{const unsigned \&}]{n,  }\item[{\mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Get local coordinates of node j in the element; vector sets its own size. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1FiniteElement_a22bc4ee35e4f948d8d7fba18c7b4f4c4}{oomph\+::\+Finite\+Element}}.



Definition at line 1204 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+One\+Dimensional\+Legendre\+Shape$<$ N\+N\+O\+D\+E\+\_\+1\+D $>$\+::calculate\+\_\+nodal\+\_\+positions(), n, oomph\+::\+One\+Dimensional\+Legendre\+Shape$<$ N\+N\+O\+D\+E\+\_\+1\+D $>$\+::nodal\+\_\+position(), and s.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a2ba8be38964ccde650ff649a78a49a34}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a2ba8be38964ccde650ff649a78a49a34}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!local\_fraction\_of\_node@{local\_fraction\_of\_node}}
\index{local\_fraction\_of\_node@{local\_fraction\_of\_node}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{local\_fraction\_of\_node()}{local\_fraction\_of\_node()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::local\+\_\+fraction\+\_\+of\+\_\+node (\begin{DoxyParamCaption}\item[{const unsigned \&}]{n,  }\item[{\mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s\+\_\+fraction }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Get the local fractino of node j in the element. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1FiniteElement_a41640b9a9e5f6461cd8ebb8218502b07}{oomph\+::\+Finite\+Element}}.



Definition at line 1257 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References n.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_af8b496db53a5d54b058f58f320e803f4}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_af8b496db53a5d54b058f58f320e803f4}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!local\_one\_d\_fraction\_of\_node@{local\_one\_d\_fraction\_of\_node}}
\index{local\_one\_d\_fraction\_of\_node@{local\_one\_d\_fraction\_of\_node}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{local\_one\_d\_fraction\_of\_node()}{local\_one\_d\_fraction\_of\_node()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
double \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::local\+\_\+one\+\_\+d\+\_\+fraction\+\_\+of\+\_\+node (\begin{DoxyParamCaption}\item[{const unsigned \&}]{n1d,  }\item[{const unsigned \&}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



The local one-\/d fraction is the same. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1FiniteElement_adb8ec7d2ceda37528c2d4542d572edf4}{oomph\+::\+Finite\+Element}}.



Definition at line 1266 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+One\+Dimensional\+Legendre\+Shape$<$ N\+N\+O\+D\+E\+\_\+1\+D $>$\+::calculate\+\_\+nodal\+\_\+positions(), and oomph\+::\+One\+Dimensional\+Legendre\+Shape$<$ N\+N\+O\+D\+E\+\_\+1\+D $>$\+::nodal\+\_\+position().

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_ad272711d69364c090fd332937ac6428c}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_ad272711d69364c090fd332937ac6428c}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!nnode\_1d@{nnode\_1d}}
\index{nnode\_1d@{nnode\_1d}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{nnode\_1d()}{nnode\_1d()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
unsigned \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::nnode\+\_\+1d (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Returns the number of nodes along each edge of the element. Overloaded to return the (variable) p-\/order rather than the template argument. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1FiniteElement_ab65c7a94dda80c1876a09ac12be4e39c}{oomph\+::\+Finite\+Element}}.



Definition at line 182 of file hp\+\_\+refineable\+\_\+elements.\+h.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_aaaef5f28edec53e201f87c3c9f2c0f61}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_aaaef5f28edec53e201f87c3c9f2c0f61}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!node\_created\_by\_neighbour@{node\_created\_by\_neighbour}}
\index{node\_created\_by\_neighbour@{node\_created\_by\_neighbour}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{node\_created\_by\_neighbour()}{node\_created\_by\_neighbour()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
\mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$ \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::node\+\_\+created\+\_\+by\+\_\+neighbour (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s\+\_\+fraction,  }\item[{bool \&}]{is\+\_\+periodic }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

If a neighbouring element has already created a node at a position corresponding to the local fractional position within the present element, s\+\_\+fraction, return a pointer to that node. If not, return N\+U\+LL (0). If the node is periodic the flag is\+\_\+periodic will be true 

Reimplemented from \mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_acf706049e7394cafa3d5f979222b907e}{oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$}}.



Definition at line 1370 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Quad\+Tree\+Names\+::E, oomph\+::\+Finite\+Element\+::get\+\_\+node\+\_\+at\+\_\+local\+\_\+coordinate(), i, oomph\+::\+Quad\+Tree\+Names\+::N, oomph\+::\+Tree\+::object\+\_\+pt(), oomph\+::\+Quad\+Tree\+Names\+::S, s, and oomph\+::\+Quad\+Tree\+Names\+::W.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_abe1f777a74c6996aaa3cfbdb2dee1c72}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_abe1f777a74c6996aaa3cfbdb2dee1c72}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!node\_created\_by\_son\_of\_neighbour@{node\_created\_by\_son\_of\_neighbour}}
\index{node\_created\_by\_son\_of\_neighbour@{node\_created\_by\_son\_of\_neighbour}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{node\_created\_by\_son\_of\_neighbour()}{node\_created\_by\_son\_of\_neighbour()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
\mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$ \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::node\+\_\+created\+\_\+by\+\_\+son\+\_\+of\+\_\+neighbour (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s\+\_\+fraction,  }\item[{bool \&}]{is\+\_\+periodic }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

If a neighbouring element\textquotesingle{}s son has already created a node at a position corresponding to the local fractional position within the present element, s\+\_\+fraction, return a pointer to that node. If not, return N\+U\+LL (0). If the node is periodic the flag is\+\_\+periodic will be true 

Reimplemented from \mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_ae989507794716d3ab8d0d2fd32dce28f}{oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$}}.



Definition at line 1475 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Quad\+Tree\+Names\+::E, i, oomph\+::\+Quad\+Tree\+Names\+::N, oomph\+::\+Quad\+Tree\+Names\+::\+NE, oomph\+::\+Tree\+::nsons(), oomph\+::\+Quad\+Tree\+Names\+::\+NW, oomph\+::\+Tree\+::object\+\_\+pt(), oomph\+::\+Quad\+Tree\+Names\+::S, s, oomph\+::\+Quad\+Tree\+Names\+::\+SE, oomph\+::\+Tree\+::son\+\_\+pt(), oomph\+::\+Quad\+Tree\+Names\+::\+SW, and oomph\+::\+Quad\+Tree\+Names\+::W.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_aa74bd994a95736da7c0c92297959b026}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_aa74bd994a95736da7c0c92297959b026}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!p\_refine@{p\_refine}}
\index{p\_refine@{p\_refine}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{p\_refine()}{p\_refine()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::p\+\_\+refine (\begin{DoxyParamCaption}\item[{const int \&}]{inc,  }\item[{\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}} $\ast$const \&}]{mesh\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{Generalised\+Element}} $\ast$const \&}]{clone\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



p-\/refine the element (refine if inc$>$0, unrefine if inc$<$0). 

p-\/refine the element inc times. (If inc$<$0 then p-\/unrefinement is performed.) 

Implements \mbox{\hyperlink{classoomph_1_1PRefineableElement_a706db9352965197a215405f620b3cedc}{oomph\+::\+P\+Refineable\+Element}}.



Definition at line 1935 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Mesh\+::add\+\_\+boundary\+\_\+node(), oomph\+::\+Mesh\+::add\+\_\+node\+\_\+pt(), boundaries, oomph\+::\+Mesh\+::boundary\+\_\+coordinate\+\_\+exists(), oomph\+::\+Quad\+Tree\+Names\+::E, oomph\+::\+Macro\+Element\+Node\+Update\+Element\+Base\+::geom\+\_\+object\+\_\+pt(), oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$\+::get\+\_\+bcs(), oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$\+::get\+\_\+boundaries(), oomph\+::\+Refineable\+Element\+::get\+\_\+interpolated\+\_\+values(), get\+\_\+node\+\_\+at\+\_\+local\+\_\+coordinate(), oomph\+::\+Finite\+Element\+::get\+\_\+x(), i, oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$\+::interpolated\+\_\+zeta\+\_\+on\+\_\+edge(), oomph\+::\+Quad\+Tree\+Names\+::N, n, oomph\+::\+Node\+::ndim(), oomph\+::\+Finite\+Element\+::nnode(), oomph\+::\+Finite\+Element\+::node\+\_\+pt(), oomph\+::\+Node\+::nposition\+\_\+type(), oomph\+::\+Time\+Stepper\+::ntstorage(), oomph\+::\+Data\+::nvalue(), oomph\+::\+Tree\+::\+O\+M\+E\+GA, oomph\+::\+P\+Refineable\+Element\+::p\+\_\+order(), oomph\+::\+Data\+::pin(), oomph\+::\+Solid\+Node\+::pin\+\_\+position(), oomph\+::\+Quad\+Tree\+Names\+::S, s, oomph\+::\+Node\+::set\+\_\+coordinates\+\_\+on\+\_\+boundary(), oomph\+::\+Macro\+Element\+Node\+Update\+Element\+Base\+::set\+\_\+node\+\_\+update\+\_\+info(), oomph\+::\+Data\+::set\+\_\+value(), oomph\+::\+Algebraic\+Element\+Base\+::setup\+\_\+algebraic\+\_\+node\+\_\+update(), oomph\+::\+Global\+\_\+string\+\_\+for\+\_\+annotation\+::string(), t, oomph\+::\+Quad\+Tree\+Names\+::W, and oomph\+::\+Node\+::x().

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a1bb8bcd4562fcdfbac80f4db0f38ed76}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a1bb8bcd4562fcdfbac80f4db0f38ed76}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!pre\_build@{pre\_build}}
\index{pre\_build@{pre\_build}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{pre\_build()}{pre\_build()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::pre\+\_\+build (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}} $\ast$\&}]{mesh\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1Node}{Node}} $\ast$ $>$ \&}]{new\+\_\+node\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Pre-\/build (search father for required nodes which may already exist) 

Check the father element for any required nodes which already exist 

Reimplemented from \mbox{\hyperlink{classoomph_1_1RefineableElement_a3968e7b77a0374cebe3be35281828676}{oomph\+::\+Refineable\+Element}}.



Definition at line 1707 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Macro\+Element\+Node\+Update\+Element\+Base\+::geom\+\_\+object\+\_\+pt(), oomph\+::\+Refineable\+Element\+::get\+\_\+interpolated\+\_\+values(), oomph\+::\+Finite\+Element\+::get\+\_\+node\+\_\+at\+\_\+local\+\_\+coordinate(), i, oomph\+::\+Finite\+Element\+::macro\+\_\+elem\+\_\+pt(), oomph\+::\+Quad\+Tree\+Names\+::\+NE, oomph\+::\+Finite\+Element\+::node\+\_\+pt(), oomph\+::\+Data\+::nvalue(), oomph\+::\+Quad\+Tree\+Names\+::\+NW, oomph\+::\+Tree\+::object\+\_\+pt(), s, oomph\+::\+Q\+Element\+Base\+::s\+\_\+macro\+\_\+ll(), oomph\+::\+Q\+Element\+Base\+::s\+\_\+macro\+\_\+ur(), oomph\+::\+Quad\+Tree\+Names\+::\+SE, oomph\+::\+Macro\+Element\+Node\+Update\+Element\+Base\+::set\+\_\+node\+\_\+update\+\_\+info(), oomph\+::\+Data\+::set\+\_\+value(), oomph\+::\+Tree\+::son\+\_\+type(), oomph\+::\+Global\+\_\+string\+\_\+for\+\_\+annotation\+::string(), oomph\+::\+Quad\+Tree\+Names\+::\+SW, t, and oomph\+::\+Data\+::time\+\_\+stepper\+\_\+pt().

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_abf33572d0ba9cd9bf06ca137256c422d}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_abf33572d0ba9cd9bf06ca137256c422d}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!quad\_hang\_helper@{quad\_hang\_helper}}
\index{quad\_hang\_helper@{quad\_hang\_helper}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{quad\_hang\_helper()}{quad\_hang\_helper()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::quad\+\_\+hang\+\_\+helper (\begin{DoxyParamCaption}\item[{const int \&}]{value\+\_\+id,  }\item[{const int \&}]{my\+\_\+edge,  }\item[{std\+::ofstream \&}]{output\+\_\+hangfile }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Set up hanging node information. Overloaded to implement the mortar method rather than constrained approximation. This enforces continuity weakly via an integral matching condition at non-\/conforming element boundaries. 

Internal function to set up the hanging nodes on a particular edge of the element. Implements the mortarting method to enforce continuity weakly across non-\/conforming element boundaries $\Gamma$ using an integral matching condition \[ \int_\Gamma (u_{\mbox{S}} - u_{\mbox{M}}) \psi \mbox{d} s = 0 \] for all polynomials $\psi$ on $\Gamma$ of degree at most p-\/2 (where p is the spectral-\/order of the dependent element) and a vertex matching condition \[ (u_{\mbox{S}} - u_{\mbox{M}})\big\vert_{\partial\Gamma} = 0.\]

The algorithm works as follows\+:
\begin{DoxyItemize}
\item First the element determines if its edge my\+\_\+edge is on the master or dependent side of the non-\/conformity. At h-\/type non-\/conformities we choose long edges to be masters, and at p-\/type nonconformities the edge with lower p-\/order is the master.
\item Mortaring is performed by the dependent side.
\item If a vertex node of the mortar is shared between master and dependent element then the vertex matching condition is enforced automatically. Otherwise it must be imposed by constraining its value to that at on the master side.
\item The integral matching condition is discretised and the mortar test functions $ \psi $ are chosen to be derivatives of Legendre polynomials of degree p-\/1.
\item The mortar mass matrix M is constructed. Its entries are the mortar test functions evaluated at the dependent nodal positions, so it is diagonal.
\item The local projection matrix is constructed for the master element by applying the discretised integral matching condition along the mortar using the appropriate quadrature order.
\item The global projection matrix is then assembled by subtracting contributions from the mortar vertex nodes.
\item The mortar system $ M\xi^s = P\hat{\xi^m} $ is constructed, where $ \xi^m $ and $ \xi^s $ are the nodal values at the master and dependent nodes respectively.
\item The conformity matrix $ C = M^{-1}P $ is computed. This is straightforward since the mass matrix is diagonal.
\item Finally, the master nodes and weights for each dependent node are read from the conformity matrix and stored in the dependents\textquotesingle{} hanging schemes.
\end{DoxyItemize}

The positions of the dependent nodes are set to be consistent with their hanging schemes. 

Reimplemented from \mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_a711171287234070046a02bbf56ed2664}{oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$}}.



Definition at line 3961 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Orthpoly\+::ddlegendre(), oomph\+::\+Orthpoly\+::dlegendre(), oomph\+::\+Quad\+Tree\+Names\+::E, e, oomph\+::\+Orthpoly\+::gll\+\_\+nodes(), i, oomph\+::\+Refineable\+Element\+::interpolating\+\_\+basis(), oomph\+::\+Refineable\+Element\+::interpolating\+\_\+node\+\_\+pt(), oomph\+::\+Quad\+Tree\+Names\+::N, n, oomph\+::\+Refineable\+Element\+::ninterpolating\+\_\+node(), oomph\+::\+Refineable\+Element\+::ninterpolating\+\_\+node\+\_\+1d(), oomph\+::\+Tree\+::nsons(), oomph\+::\+Tree\+::object\+\_\+pt(), oomph\+::oomph\+\_\+info, oomph\+::\+Quad\+Tree\+Names\+::S, s, oomph\+::\+Hang\+Info\+::set\+\_\+master\+\_\+node\+\_\+pt(), and oomph\+::\+Quad\+Tree\+Names\+::W.

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a53d48e7e3310a02a315562ed628bd4b5}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a53d48e7e3310a02a315562ed628bd4b5}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!rebuild\_from\_sons@{rebuild\_from\_sons}}
\index{rebuild\_from\_sons@{rebuild\_from\_sons}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{rebuild\_from\_sons()}{rebuild\_from\_sons()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::rebuild\+\_\+from\+\_\+sons (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}} $\ast$\&}]{mesh\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Rebuild the element. This needs to find any nodes in the sons which are still required.

Rebuild the element from nodes found in its sons Adjusts its p-\/order to be the maximum of its sons\textquotesingle{} p-\/orders 

Implements \mbox{\hyperlink{classoomph_1_1RefineableElement_a33324be27833fa4b78279d17158215fa}{oomph\+::\+Refineable\+Element}}.



Definition at line 3139 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+Mesh\+::add\+\_\+boundary\+\_\+node(), oomph\+::\+Mesh\+::add\+\_\+node\+\_\+pt(), boundaries, oomph\+::\+Mesh\+::boundary\+\_\+coordinate\+\_\+exists(), oomph\+::\+Quad\+Tree\+Names\+::E, oomph\+::\+Macro\+Element\+Node\+Update\+Element\+Base\+::geom\+\_\+object\+\_\+pt(), oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$\+::get\+\_\+bcs(), oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$\+::get\+\_\+boundaries(), oomph\+::\+Refineable\+Element\+::get\+\_\+interpolated\+\_\+values(), oomph\+::\+Finite\+Element\+::get\+\_\+x(), i, oomph\+::\+Refineable\+Q\+Element$<$ 2 $>$\+::interpolated\+\_\+zeta\+\_\+on\+\_\+edge(), oomph\+::\+Quad\+Tree\+Names\+::N, n, oomph\+::\+Node\+::ndim(), oomph\+::\+Quad\+Tree\+Names\+::\+NE, oomph\+::\+Time\+Stepper\+::ntstorage(), oomph\+::\+Data\+::nvalue(), oomph\+::\+Quad\+Tree\+Names\+::\+NW, oomph\+::\+Tree\+::\+O\+M\+E\+GA, oomph\+::\+P\+Refineable\+Element\+::p\+\_\+order(), oomph\+::\+Data\+::pin(), oomph\+::\+Solid\+Node\+::pin\+\_\+position(), oomph\+::\+Quad\+Tree\+Names\+::S, s, oomph\+::\+Quad\+Tree\+Names\+::\+SE, oomph\+::\+Node\+::set\+\_\+coordinates\+\_\+on\+\_\+boundary(), oomph\+::\+Data\+::set\+\_\+value(), oomph\+::\+Global\+\_\+string\+\_\+for\+\_\+annotation\+::string(), oomph\+::\+Quad\+Tree\+Names\+::\+SW, t, oomph\+::\+Quad\+Tree\+Names\+::W, and oomph\+::\+Node\+::x().

\mbox{\Hypertarget{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a2ec50a2b731e5e8b969f116606cab6ca}\label{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a2ec50a2b731e5e8b969f116606cab6ca}} 
\index{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}!shape@{shape}}
\index{shape@{shape}!oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$@{oomph::PRefineableQElement$<$ 2, INITIAL\_NNODE\_1D $>$}}
\doxysubsubsection{\texorpdfstring{shape()}{shape()}}
{\footnotesize\ttfamily template$<$unsigned I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D$>$ \\
void \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{oomph\+::\+P\+Refineable\+Q\+Element}}$<$ 2, I\+N\+I\+T\+I\+A\+L\+\_\+\+N\+N\+O\+D\+E\+\_\+1D $>$\+::shape (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s,  }\item[{\mbox{\hyperlink{classoomph_1_1Shape}{Shape}} \&}]{psi }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Overload the shape functions. 

\mbox{\hyperlink{classoomph_1_1Shape}{Shape}} functions for \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{P\+Refineable\+Q\+Element$<$\+D\+I\+M$>$}} 

Implements \mbox{\hyperlink{classoomph_1_1FiniteElement_a58a25b6859ddd43b7bfe64a19fee5023}{oomph\+::\+Finite\+Element}}.



Definition at line 2836 of file hp\+\_\+refineable\+\_\+elements.\+cc.



References oomph\+::\+One\+Dimensional\+Legendre\+Shape$<$ N\+N\+O\+D\+E\+\_\+1\+D $>$\+::calculate\+\_\+nodal\+\_\+positions(), i, and s.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{hp__refineable__elements_8h}{hp\+\_\+refineable\+\_\+elements.\+h}}\item 
\mbox{\hyperlink{hp__refineable__elements_8cc}{hp\+\_\+refineable\+\_\+elements.\+cc}}\end{DoxyCompactItemize}
