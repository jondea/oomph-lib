<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: young_laplace.txt File Reference</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">young_laplace.txt File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a72be276e8168a9e3345791225137a522"><td class="memItemLeft" align="right" valign="top">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p^ *=\sigma \kappa^ *,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa *<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p=\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact line the line along which the meniscus meets the solid surface We can either pin the position of the contact&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> (as in the above example)</td></tr>
<tr class="separator:a72be276e8168a9e3345791225137a522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a972796dc0dbb3f5b13cbc503572d2a26"><td class="memItemLeft" align="right" valign="top">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p^ *=\sigma \kappa^ *,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa *<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p=\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> meets the solid surface.The mathematical <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape of the required mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$ that satisfies the <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">equation:\f</a>[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacementsThe <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">cdot\delta</a> {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] which may be derived from energetic considerations. Here the symbol \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a>, respectively. \f$ dl \f$ is the length of an element of the contact <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">line\f</a> $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> is pinned, the variation of its position is zero, \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R}={\bf 0} \f$, and the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> integral vanishes.The variational formulation of the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in { R}^3\f$, where \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\partial D}=\bigg\{(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ \bigg|\(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The normal to the meniscus is then given by \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">principleare\f</a>[d s=\mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[d l=\left|\frac{d {\bf R}\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] allowing us to write the <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacements <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">as\f</a>[\int_S \left(\frac{\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \right) \mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2=\oint_{L} {\bf T}_n \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \ \left|\frac{d {\bf R}\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">xi.\f</a>]\subsection <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> The method of spinesIn the current form, the variational <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \f$ that parametrisethe same <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. To remove this ambiguity, and to allow for <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)={\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)+\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] Here the &quot;spine basis&quot; \f${\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $and the &quot;spines&quot; \f${\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ which represents the meniscus' displacement along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> corresponding to a flat meniscus. Positive values of \f$ u \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $displace the meniscus along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a>, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f${\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ isone-to-<a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>, at least for the meniscus shapesof interest. Pinned <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> and spine basisis <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> that returns the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics <a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a>, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is pinned at the edges ofthe slot, as shown in the sketch below, the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> has an obvious exact solution. The air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> must have constant mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is given <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">by\f</a>[\kappa^ *=\frac{2/a}{H/a+a/H}.\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-<a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>) is the unit square. The meniscus is pinned along the lines \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 \f$ and \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1 \f$, and symmetry(natural) <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> were applied along the lines \f$ x=0 \f$ and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $x=1;\f$ see \ref comm_ex for further details on the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(x, <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>) \f$-plane,\until bspine functionsand rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a> \f$ <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> by <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">setting\f</a>[{\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;<a class="el" href="young__laplace_8txt.html#afd7bfc074226d266df4e6c70265af3c9">Finally</a>, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> curvatures.\until end of <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>&lt; HR &gt;&lt; HR &gt;\subsection class The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> classThe <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> of the exercises in \ref comm_ex.) The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value contains the unknowninterface <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>&lt; HR &gt;&lt; HR &gt;\subsection constr The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> (1) We pass the pointer to that node and the pointer to the double that specifies the imposed displacement to the const ructor of the displacement control element. The const ructor automatically creates a \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value stores the unknown <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a></td></tr>
<tr class="separator:a972796dc0dbb3f5b13cbc503572d2a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac1b72ad803292913ca4f9bc7ac1189"><td class="memItemLeft" align="right" valign="top">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f[\Delta p^ *=\sigma \kappa^ *,\f] where f kappa *f is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and f sigma f the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f[\Delta p=\kappa.\f] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> meets the solid surface.The mathematical <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape of the required mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$ that satisfies the <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace equation:\f[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\f]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacementsThe <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\f[\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">cdot\delta</a> {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\f] which may be derived from energetic considerations. Here the symbol \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a>, respectively. \f$ dl \f$ is the length of an element of the contact line\f $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> is pinned, the variation of its position is zero, \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R}={\bf 0} \f$, and the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> integral vanishes.The variational formulation of the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in { R}^3\f$, where \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \f[{\partial D}=\bigg\{(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ \bigg|\(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \f] The normal to the meniscus is then given by \f[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \f] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational principleare\f[d s=\mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 \f] and \f[d l=\left|\frac{d {\bf R}\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\f] allowing us to write the <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacements as\f[\int_S \left(\frac{\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \right) \mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2=\oint_{L} {\bf T}_n \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \ \left|\frac{d {\bf R}\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi.\f]\subsection <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> The method of spinesIn the current form, the variational <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \f$ that parametrisethe same <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. To remove this ambiguity, and to allow for <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \f[{\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)={\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)+\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2). \f] Here the &quot;spine basis&quot; \f${\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f $and the &quot;spines&quot; \f${\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ which represents the meniscus' displacement along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> corresponding to a flat meniscus. Positive values of \f$ u \f $displace the meniscus along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a>, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f${\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ isone-to-<a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>, at least for the meniscus shapesof interest. Pinned <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \f $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> and spine basisis <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> that returns the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics <a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a>, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is pinned at the edges ofthe slot, as shown in the sketch below, the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> has an obvious exact solution. The air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> must have constant mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is given by\f[\kappa^ *=\frac{2/a}{H/a+a/H}.\f] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-<a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>) is the unit square. The meniscus is pinned along the lines \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 \f$ and \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1 \f$, and symmetry(natural) <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> were applied along the lines \f$ <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=0 \f$ and \f $<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=1;\f$ see \ref comm_ex for further details on the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>, <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>) \f$-plane,\until bspine functionsand rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a> \f$ <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> by setting\f[{\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\f]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;<a class="el" href="young__laplace_8txt.html#afd7bfc074226d266df4e6c70265af3c9">Finally</a>, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> curvatures.\until end of <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>&lt; HR &gt;&lt; HR &gt;\subsection class The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> classThe <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> of the exercises in \ref comm_ex.) The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value contains the unknowninterface <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>&lt; HR &gt;&lt; HR &gt;\subsection constr The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; f kappa f We store the pointer to this c Data object in the private member data to facilitate its output until and the prescribed <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> until we add the displacement control element to the mesh and assign the equation numbers until end of constructor&lt; HR &gt;&lt; HR &gt; subsection post Postprocessing We document the exact and computed meniscus curvatures in the trace file and output the meniscus shape skipline start_of_doc until end of doc&lt; HR &gt;&lt; HR &gt; section comm_ex Comments and Exercises We discussed earlier that the spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f$</td></tr>
<tr class="separator:a9ac1b72ad803292913ca4f9bc7ac1189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7683600545bdf8246af967af6830312e"><td class="memItemLeft" align="right" valign="top">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that are obtained if no <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a7683600545bdf8246af967af6830312e">specified</a> (by commenting out the lines in the constructor that pass the relevant function pointers to the Young Laplace elements). \n\n - As usual in any finite-element computation</td></tr>
<tr class="separator:a7683600545bdf8246af967af6830312e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4919b2fccf0613c276d0ca7bfbf41441"><td class="memItemLeft" align="right" valign="top">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that are obtained if no <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are we only enforced the essential <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> by pinning the meniscus displacement along the pinned contact lines at <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> indicating that these boundaries are controlled by natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> The variational&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> (@R[var_prin]@) shows what these are</td></tr>
<tr class="separator:a4919b2fccf0613c276d0ca7bfbf41441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeca3fbb0467bbb9f89ebed58aa1c7ffa"><td class="memItemLeft" align="right" valign="top">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> of the spines Since the spines do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the meniscus must therefore have zero slope in that <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> just what we need for our <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> n n To convince yourself that the this argument is rotate the spines in the <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> e g by changing their definition to <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\begin{array}{c} 1/2 \\ -\sin\big(\alpha(\zeta_2)\big) \\ \ \ \cos\big(\alpha(\zeta_2)\big) \\ \end{array} \right). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> condition will still force the meniscus to be normal to the spines along the free contact resulting in <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes similar to the <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> shown in the figure below I w textwidth funky_meniscus Meniscus shape created by the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> when the&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> (shown as vectors) are rotated in the <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>-direction. &quot; This demonstrates yet again that the orientation of spines must reflect the relevant features of the problem. We refer to &lt;a href</td></tr>
<tr class="separator:aeca3fbb0467bbb9f89ebed58aa1c7ffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a63e58ac8fc8170c7517d6c91561372"><td class="memItemLeft" align="right" valign="top">n n which create the c Data object that stores the prescribed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> (Note that the value of \f$ \kappa \f$ is already incremented in \c actions_before_newton_step(). With displacement control this step has no real effect as the Newton method will overwrite this assignment). Check what happens if the prescribed curvature exceeds the maximum possible curvature of the meniscus. \n\n - Note that the current implementation of the Young Laplace elements is inefficient as the elemental Jacobian matrices are computed by finite-differencing. You are invited to implement the analytical computation of the Jacobian matrix as an exercise. \n\n - We provide a number of additional demo driver codes that demonstrate the solution of other</td></tr>
<tr class="separator:a6a63e58ac8fc8170c7517d6c91561372"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8044b62475f8b6be7b371532bab17017"><td class="memItemLeft" align="right" valign="top">mainpage Example&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a></td></tr>
<tr class="separator:a8044b62475f8b6be7b371532bab17017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe7bec3a49f1760b75ce56ebe6721643"><td class="memItemLeft" align="right" valign="top">mainpage Example a nonlinear PDE that determines static the equilibrium shapes of droplets or bubbles We start by reviewing the relevant theory and then present the solution of a simple model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#afe7bec3a49f1760b75ce56ebe6721643">Acknowledgement</a></td></tr>
<tr class="separator:afe7bec3a49f1760b75ce56ebe6721643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae6b72bddd98a5f24915877f818e1f68"><td class="memItemLeft" align="right" valign="top">mainpage Example a nonlinear PDE that determines static the equilibrium shapes of droplets or bubbles We start by reviewing the relevant theory and then present the solution of a simple model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#aae6b72bddd98a5f24915877f818e1f68">Paris</a></td></tr>
<tr class="separator:aae6b72bddd98a5f24915877f818e1f68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f05f6bec57fb9eea1f1e04f934c4b5"><td class="memItemLeft" align="right" valign="top">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical f Delta p *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">f</a></td></tr>
<tr class="separator:a14f05f6bec57fb9eea1f1e04f934c4b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ea2ccd2302f3ef85d1dc917d935b659"><td class="memItemLeft" align="right" valign="top">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a></td></tr>
<tr class="separator:a5ea2ccd2302f3ef85d1dc917d935b659"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f08e15ca2e78d4f74694e3111124596"><td class="memItemLeft" align="right" valign="top">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p^ *=\sigma \kappa^ *,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa *<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p=\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a></td></tr>
<tr class="separator:a7f08e15ca2e78d4f74694e3111124596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad085028866de0dfb37173803eabff340"><td class="memItemLeft" align="right" valign="top">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p^ *=\sigma \kappa^ *,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa *<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p=\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> meets the solid surface.The mathematical <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape of the required mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$ that satisfies the <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">equation:\f</a>[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacementsThe <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">cdot\delta</a> {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] which may be derived from energetic considerations. Here the symbol \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a>, respectively. \f$ dl \f$ is the length of an element of the contact <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">line\f</a> $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> is pinned, the variation of its position is zero, \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R}={\bf 0} \f$, and the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> integral vanishes.The variational formulation of the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in { R}^3\f$, where \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\partial D}=\bigg\{(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ \bigg|\(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The normal to the meniscus is then given by \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">principleare\f</a>[d s=\mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[d l=\left|\frac{d {\bf R}\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] allowing us to write the <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacements <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">as\f</a>[\int_S \left(\frac{\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \right) \mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2=\oint_{L} {\bf T}_n \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \ \left|\frac{d {\bf R}\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">xi.\f</a>]\subsection <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> The method of spinesIn the current form, the variational <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \f$ that parametrisethe same <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. To remove this ambiguity, and to allow for <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)={\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)+\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] Here the &quot;spine basis&quot; \f${\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $and the &quot;spines&quot; \f${\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ which represents the meniscus' displacement along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> corresponding to a flat meniscus. Positive values of \f$ u \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $displace the meniscus along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a>, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f${\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ isone-to-<a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>, at least for the meniscus shapesof interest. Pinned <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> and spine basisis <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> that returns the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics <a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a>, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is pinned at the edges ofthe slot, as shown in the sketch below, the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> has an obvious exact solution. The air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> must have constant mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is given <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">by\f</a>[\kappa^ *=\frac{2/a}{H/a+a/H}.\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-<a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>) is the unit square. The meniscus is pinned along the lines \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 \f$ and \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1 \f$, and symmetry(natural) <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> were applied along the lines \f$ <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=0 \f$ and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=1;\f$ see \ref comm_ex for further details on the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>, <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>) \f$-plane,\until bspine functionsand rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a> \f$ <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> by <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">setting\f</a>[{\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;<a class="el" href="young__laplace_8txt.html#afd7bfc074226d266df4e6c70265af3c9">Finally</a>, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> curvatures.\until end of <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>&lt; HR &gt;&lt; HR &gt;\subsection class The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> classThe <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> of the exercises in \ref comm_ex.) The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value contains the unknowninterface <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>&lt; HR &gt;&lt; HR &gt;\subsection constr The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> We store the pointer to this c Data object in the private member data to facilitate its output until&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#ad085028866de0dfb37173803eabff340">Kappa_pt</a></td></tr>
<tr class="separator:ad085028866de0dfb37173803eabff340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd7bfc074226d266df4e6c70265af3c9"><td class="memItemLeft" align="right" valign="top">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p^ *=\sigma \kappa^ *,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa *<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\Delta p=\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> meets the solid surface.The mathematical <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape of the required mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$ that satisfies the <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">equation:\f</a>[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacementsThe <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">cdot\delta</a> {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] which may be derived from energetic considerations. Here the symbol \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a>, respectively. \f$ dl \f$ is the length of an element of the contact <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">line\f</a> $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> is pinned, the variation of its position is zero, \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R}={\bf 0} \f$, and the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> integral vanishes.The variational formulation of the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in { R}^3\f$, where \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\partial D}=\bigg\{(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ \bigg|\(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The normal to the meniscus is then given by \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">principleare\f</a>[d s=\mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[d l=\left|\frac{d {\bf R}\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] allowing us to write the <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacements <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">as\f</a>[\int_S \left(\frac{\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \right) \mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2=\oint_{L} {\bf T}_n \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \ \left|\frac{d {\bf R}\left(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">xi.\f</a>]\subsection <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> The method of spinesIn the current form, the variational <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \f$ that parametrisethe same <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. To remove this ambiguity, and to allow for <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)={\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)+\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] Here the &quot;spine basis&quot; \f${\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $and the &quot;spines&quot; \f${\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ which represents the meniscus' displacement along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> corresponding to a flat meniscus. Positive values of \f$ u \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $displace the meniscus along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a>, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f${\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ isone-to-<a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>, at least for the meniscus shapesof interest. Pinned <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> and spine basisis <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> that returns the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics <a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a>, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is pinned at the edges ofthe slot, as shown in the sketch below, the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> has an obvious exact solution. The air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> must have constant mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is given <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">by\f</a>[\kappa^ *=\frac{2/a}{H/a+a/H}.\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-<a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>) is the unit square. The meniscus is pinned along the lines \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 \f$ and \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1 \f$, and symmetry(natural) <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> were applied along the lines \f$ <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=0 \f$ and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> $<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=1;\f$ see \ref comm_ex for further details on the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>, <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>) \f$-plane,\until bspine functionsand rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a> \f$ <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> by <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">setting\f</a>[{\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;Finally, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> curvatures.\until end of <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>&lt; HR &gt;&lt; HR &gt;\subsection class The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> classThe <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> of the exercises in \ref comm_ex.) The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value contains the unknowninterface <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>&lt; HR &gt;&lt; HR &gt;\subsection constr The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> We store the pointer to this c Data object in the private member data to facilitate its output until and the prescribed <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> until&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#afd7bfc074226d266df4e6c70265af3c9">Finally</a></td></tr>
<tr class="separator:afd7bfc074226d266df4e6c70265af3c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89176c66757d666599a5b244526ae379"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a></td></tr>
<tr class="separator:a89176c66757d666599a5b244526ae379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc3d24c53996627ec3a5cd70d7d0eb7"><td class="memItemLeft" align="right" valign="top">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is one to&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a></td></tr>
<tr class="separator:a0cc3d24c53996627ec3a5cd70d7d0eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a236055ccdca33d638feffb2f38f635da"><td class="memItemLeft" align="right" valign="top">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a236055ccdca33d638feffb2f38f635da">specified</a></td></tr>
<tr class="separator:a236055ccdca33d638feffb2f38f635da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b792a58562211eb74439f1222d226a4"><td class="memItemLeft" align="right" valign="top">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that are obtained if no <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are we only enforced the essential <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> by pinning the meniscus displacement along the pinned contact lines at <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a></td></tr>
<tr class="separator:a1b792a58562211eb74439f1222d226a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51614c86b63eafc713e24089a1463975"><td class="memItemLeft" align="right" valign="top">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that are obtained if no <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are we only enforced the essential <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> by pinning the meniscus displacement along the pinned contact lines at <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> indicating that these boundaries are controlled by&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a51614c86b63eafc713e24089a1463975">implied</a></td></tr>
<tr class="separator:a51614c86b63eafc713e24089a1463975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab527d223c14587f4aebca609ce74db8a"><td class="memItemLeft" align="right" valign="top">_n cdot&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a></td></tr>
<tr class="separator:ab527d223c14587f4aebca609ce74db8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c89605709bfb613fd19c9f098dd6eda"><td class="memItemLeft" align="right" valign="top">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a></td></tr>
<tr class="separator:a1c89605709bfb613fd19c9f098dd6eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f31063aa2581a1197266c00f4746b2f"><td class="memItemLeft" align="right" valign="top">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> of the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> Since the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a4f31063aa2581a1197266c00f4746b2f">component</a></td></tr>
<tr class="separator:a4f31063aa2581a1197266c00f4746b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6158a81e827ec1ab33df40a25ea88b4"><td class="memItemLeft" align="right" valign="top">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> of the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> Since the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the meniscus must therefore have zero slope in that <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> just what we need for our <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> n n To convince yourself that the this argument is&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#aa6158a81e827ec1ab33df40a25ea88b4">correct</a></td></tr>
<tr class="separator:aa6158a81e827ec1ab33df40a25ea88b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed379f41acee082a02b9ce12b741bd6"><td class="memItemLeft" align="right" valign="top">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the direction of the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> Since the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the meniscus must therefore have zero slope in that direction just what we need for our <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> n n To convince yourself that the this argument is rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a></td></tr>
<tr class="separator:a1ed379f41acee082a02b9ce12b741bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc17068882c18acc92fa19f13ba24670"><td class="memItemLeft" align="right" valign="top">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> of the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> Since the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the meniscus must therefore have zero slope in that <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> just what we need for our <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> n n To convince yourself that the this argument is rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> e g by changing their definition to <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=\left(\begin{array}{c} 1/2 \\ -\sin\big(\alpha(\zeta_2)\big) \\ \ \ \cos\big(\alpha(\zeta_2)\big) \\ \end{array} \right). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> condition will still force the meniscus to be normal to the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> along the free contact&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#afc17068882c18acc92fa19f13ba24670">line</a></td></tr>
<tr class="separator:afc17068882c18acc92fa19f13ba24670"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8d86658dc1ec3aa7122edd47ef4124e"><td class="memItemLeft" align="right" valign="top">n n which create the c Data object that stores the prescribed related problems n n The code n n&lt; CENTER &gt;&lt; A HREF=&quot;../../../../demo_drivers/young_laplace/young_laplace.cc&quot;&gt; demo_drivers young_laplace young_laplace cc&lt;/A &gt;&lt;/CENTER &gt; n n and its adaptive counterpart n n&lt; CENTER &gt;&lt; A HREF=&quot;../../../../demo_drivers/young_laplace/refineable_young_laplace.cc&quot;&gt; demo_drivers young_laplace refineable_young_laplace cc&lt;/A &gt;&lt;/CENTER &gt; n n demonstrate the solution of three&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a></td></tr>
<tr class="separator:ae8d86658dc1ec3aa7122edd47ef4124e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4bbbf540e3048bad7f837fd75b71184"><td class="memItemLeft" align="right" valign="top">ii the deformation of a meniscus that is pinned at all four edges of a square&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="young__laplace_8txt.html#ab4bbbf540e3048bad7f837fd75b71184">tube</a></td></tr>
<tr class="separator:ab4bbbf540e3048bad7f837fd75b71184"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6a63e58ac8fc8170c7517d6c91561372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a63e58ac8fc8170c7517d6c91561372">&#9670;&nbsp;</a></span>curvature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">n n which create the c Data object that stores the prescribed curvature </td>
          <td>(</td>
          <td class="paramtype">Note that the value of \f$ \kappa \f$ is already incremented in \c actions_before_newton_step(). With displacement control this step has no real effect as the Newton method will overwrite this&#160;</td>
          <td class="paramname"><em>assignment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9ac1b72ad803292913ca4f9bc7ac1189"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ac1b72ad803292913ca4f9bc7ac1189">&#9670;&nbsp;</a></span>f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">now Rennes n n&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/CENTER&gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f [\Delta p^* = \sigma \kappa^*,\f] where f kappa* f is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and f sigma f the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f [\Delta p = \kappa.\f] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt;A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> meets the solid surface.The mathematical <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape of the required mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$ that satisfies the <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace equation:\f[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\f]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacementsThe <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A&gt;\f[ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \left( \int_S \mathit{\, d} s \right)= \int_S \Delta p {\bf N}\cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf N} \mathit{\, d} s + \oint_{L} \ \ {\bf T}_n \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">cdot\delta</a> {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\f] which may be derived from energetic considerations. Here the symbol \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f$S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a>, respectively. \f$ dl \f$ is the length of an element of the contact line\f$L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> is pinned, the variation of its position is zero, \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} = {\bf 0} \f$, and the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> integral vanishes.The variational formulation of the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> is particularly convenient for a finite-element-based solution; see, e.g. the&lt;a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a&gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother: The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> cannot be projected onto the \f$ (x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in { R}^3\f$, where \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \f[{\partial D} = \bigg\{ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ \bigg| \ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \f] The normal to the meniscus is then given by \f[ {\bf N} = \frac{{\bf R}_{,1} \times {\bf R}_{,2} }{\mathcal{A}^{1/2}}, \f] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}= |{\bf R}_{,1} \times {\bf R}_{,2}| \f$ is the square root of the surface metric tensor.The area and length differentials required in variational principleare\f[ d s=\mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 \f] and \f[ d l=\left| \frac{d {\bf R}\left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi,\f] allowing us to write the <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacements as\f[ \int_S \left( \frac{\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \right) \mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 =\oint_{L} {\bf T}_n \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \ \left| \frac{d {\bf R}\left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi.\f]\subsection <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> The method of spinesIn the current form, the variational <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \f$ that parametrisethe same <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. To remove this ambiguity, and to allow for <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that cannot be projected onto the\f$ (x_1,x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \f[ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) + \mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2). \f] Here the &quot;spine basis&quot; \f${\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$and the &quot;spines&quot; \f${\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ which represents the meniscus' displacement along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below: the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> corresponding to a flat meniscus. Positive values of \f$ u \f$displace the meniscus along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a>, \f$ {\bf S}(\zeta) \f$ (the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2 = u(x_1). \f$@I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f${\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ isone-to-<a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>, at least for the meniscus shapesof interest. Pinned <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> of the form\f$ \left. {\bf R}\right|_{\partial D} = {\bf R}_{\rm pinned} \f$are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D} = {\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D} = 0. \f$ The simplest possible choice for the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> and spine basisis <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> that returns the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2,0)^T \f$ and \f$ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = (0,0,1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> shown above, the computation wasstarted by computing the solution for \f$ \Delta p = \kappa = 0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$ (or equivalently, \f$ \kappa \f$)create small changes in the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>, using the displacement control method discussed in the&lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a&gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics <a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a>, we shall notdiscuss it in detail here but refer to the appropriate &lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a&gt;&lt;HR&gt;&lt;HR&gt;\section barrel An example problem: A barrel-shaped meniscusAs an example, we consider the following problem: Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is pinned at the edges ofthe slot, as shown in the sketch below, the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> has an obvious exact solution. The air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> must have constant mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the (dimensional) <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is given by\f[\kappa^* = \frac{2/a}{H/a + a/H}.\f] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, \f$ \Delta p = a \kappa^*. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^* = 1 \f$ indicates that the maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus is given by \f$ \kappa_{max}^* = 1/a. \f$ This implies that the maximum (dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^*_{max} = \sigma \kappa_{max}^* = \sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$ (and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-<a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> configurationof the meniscus (corresponding to a vanishing pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>) is the unit square. The meniscus is pinned along the lines \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 \f$ and \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1 \f$, and symmetry (natural) <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> were applied along the lines \f$ <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=0 \f$ and \f$x=1; \f$ see \ref comm_ex for further details on the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$@I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot; &lt;HR&gt; &lt;HR&gt; \section impl ImplementationWe shall now discuss the solution of the above <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> with\c oomph-lib's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa()returns the exact solution for the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2,0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$ (<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>,<a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>) \f$-plane,\until bspine functionsand rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a> \f$ <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> by setting\f[ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\f]where \f$ \alpha(\zeta_2) = \alpha_{min} + (\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are unit vectors thatform an angle \f$ \alpha \f$ (varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>-axis.\until spine function &lt;HR&gt;&lt;HR&gt;\subsection <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> object and document the initialconfiguration: a flat meniscus. \until doc_info.number()++;<a class="el" href="young__laplace_8txt.html#afd7bfc074226d266df4e6c70265af3c9">Finally</a>, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> curvatures.\until end of <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> &lt;HR&gt;&lt;HR&gt;\subsection class The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> classThe <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> class has the usual member functions. (Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> of the exercises in \ref comm_ex.) The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>'s private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value contains the unknowninterface <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> &lt;HR&gt;&lt;HR&gt;\subsection constr The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in [0,1] \times [0,1]\f$ with 8x8 elements.\until mesh_pt()Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; f kappa f We store the pointer to this c Data object in the private member data to facilitate its output until and the prescribed <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> until we add the displacement control element to the mesh and assign the equation numbers until end of constructor&lt;HR&gt;&lt;HR&gt; subsection post Postprocessing We document the exact and computed meniscus curvatures in the trace file and output the meniscus shape skipline start_of_doc until end of doc&lt;HR&gt;&lt;HR&gt; section comm_ex Comments and Exercises We discussed earlier that the spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from f </td>
          <td>(</td>
          <td class="paramtype">\&#160;</td>
          <td class="paramname"><em>zeta_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">\&#160;</td>
          <td class="paramname"><em>zeta_2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00455">455</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a72be276e8168a9e3345791225137a522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72be276e8168a9e3345791225137a522">&#9670;&nbsp;</a></span>line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">now Rennes n n&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/CENTER&gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p^* = \sigma \kappa^*,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa* <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p = \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact line the line along which the meniscus meets the solid surface We can either pin the position of the contact line </td>
          <td>(</td>
          <td class="paramtype">as in the above&#160;</td>
          <td class="paramname"><em>example</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4919b2fccf0613c276d0ca7bfbf41441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4919b2fccf0613c276d0ca7bfbf41441">&#9670;&nbsp;</a></span>principle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that are obtained if no <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are we only enforced the essential <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> by pinning the meniscus displacement along the pinned contact lines at <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> indicating that these boundaries are controlled by natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> The variational principle </td>
          <td>(</td>
          <td class="paramtype">@R@&#160;</td>
          <td class="paramname">[var_prin]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00475">475</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a7683600545bdf8246af967af6830312e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7683600545bdf8246af967af6830312e">&#9670;&nbsp;</a></span>specified()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that are obtained if no <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are specified </td>
          <td>(</td>
          <td class="paramtype">by commenting out the lines in the constructor that pass the relevant function pointers to the Young Laplace&#160;</td>
          <td class="paramname"><em>elements</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeca3fbb0467bbb9f89ebed58aa1c7ffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeca3fbb0467bbb9f89ebed58aa1c7ffa">&#9670;&nbsp;</a></span>spines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> of the spines Since the spines do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the meniscus must therefore have zero slope in that <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> just what we need for our <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> n n To convince yourself that the this argument is rotate the spines in the <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> e g by changing their definition to <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left( \begin{array}{c} 1/2 \\ -\sin\big(\alpha(\zeta_2)\big) \\ \ \ \cos\big(\alpha(\zeta_2)\big) \\ \end{array} \right). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> condition will still force the meniscus to be normal to the spines along the free contact resulting in <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes similar to the <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> shown in the figure below I w textwidth funky_meniscus Meniscus shape created by the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> when the spines </td>
          <td>(</td>
          <td class="paramtype">shown as&#160;</td>
          <td class="paramname"><em>vectors</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a972796dc0dbb3f5b13cbc503572d2a26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a972796dc0dbb3f5b13cbc503572d2a26">&#9670;&nbsp;</a></span>x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">now Rennes n n&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/CENTER&gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p^* = \sigma \kappa^*,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa* <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p = \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt;A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> meets the solid surface.The mathematical <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape of the required mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$ that satisfies the <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">equation:\f</a>[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacementsThe <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A&gt;\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \left( \int_S \mathit{\, d} s \right)= \int_S \Delta p {\bf N}\cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf N} \mathit{\, d} s + \oint_{L} \ \ {\bf T}_n \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">cdot\delta</a> {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] which may be derived from energetic considerations. Here the symbol \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f$S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a>, respectively. \f$ dl \f$ is the length of an element of the contact line\f$L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> is pinned, the variation of its position is zero, \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} = {\bf 0} \f$, and the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> integral vanishes.The variational formulation of the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> is particularly convenient for a finite-element-based solution; see, e.g. the&lt;a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a&gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother: The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> cannot be projected onto the \f$ (x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in { R}^3\f$, where \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\partial D} = \bigg\{ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ \bigg| \ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The normal to the meniscus is then given by \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ {\bf N} = \frac{{\bf R}_{,1} \times {\bf R}_{,2} }{\mathcal{A}^{1/2}}, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}= |{\bf R}_{,1} \times {\bf R}_{,2}| \f$ is the square root of the surface metric tensor.The area and length differentials required in variational <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">principleare\f</a>[ d s=\mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ d l=\left| \frac{d {\bf R}\left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] allowing us to write the <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacements <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">as\f</a>[ \int_S \left( \frac{\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \right) \mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 =\oint_{L} {\bf T}_n \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \ \left| \frac{d {\bf R}\left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">xi.\f</a>]\subsection <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> The method of spinesIn the current form, the variational <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \f$ that parametrisethe same <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. To remove this ambiguity, and to allow for <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that cannot be projected onto the\f$ (x_1,x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) + \mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] Here the &quot;spine basis&quot; \f${\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$and the &quot;spines&quot; \f${\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ which represents the meniscus' displacement along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below: the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> corresponding to a flat meniscus. Positive values of \f$ u \f$displace the meniscus along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a>, \f$ {\bf S}(\zeta) \f$ (the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2 = u(x_1). \f$@I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f${\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ isone-to-<a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>, at least for the meniscus shapesof interest. Pinned <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> of the form\f$ \left. {\bf R}\right|_{\partial D} = {\bf R}_{\rm pinned} \f$are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D} = {\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D} = 0. \f$ The simplest possible choice for the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> and spine basisis <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> that returns the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2,0)^T \f$ and \f$ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = (0,0,1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> shown above, the computation wasstarted by computing the solution for \f$ \Delta p = \kappa = 0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$ (or equivalently, \f$ \kappa \f$)create small changes in the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>, using the displacement control method discussed in the&lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a&gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics <a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a>, we shall notdiscuss it in detail here but refer to the appropriate &lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a&gt;&lt;HR&gt;&lt;HR&gt;\section barrel An example problem: A barrel-shaped meniscusAs an example, we consider the following problem: Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is pinned at the edges ofthe slot, as shown in the sketch below, the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> has an obvious exact solution. The air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> must have constant mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the (dimensional) <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is given <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">by\f</a>[\kappa^* = \frac{2/a}{H/a + a/H}.\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, \f$ \Delta p = a \kappa^*. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^* = 1 \f$ indicates that the maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus is given by \f$ \kappa_{max}^* = 1/a. \f$ This implies that the maximum (dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^*_{max} = \sigma \kappa_{max}^* = \sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$ (and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-<a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> configurationof the meniscus (corresponding to a vanishing pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>) is the unit square. The meniscus is pinned along the lines \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 \f$ and \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1 \f$, and symmetry (natural) <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> were applied along the lines \f$ x=0 \f$ and \f$x=1; \f$ see \ref comm_ex for further details on the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$@I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot; &lt;HR&gt; &lt;HR&gt; \section impl ImplementationWe shall now discuss the solution of the above <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> with\c oomph-lib's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa()returns the exact solution for the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2,0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$ (x,<a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>) \f$-plane,\until bspine functionsand rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a> \f$ <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> by <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">setting\f</a>[ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \alpha(\zeta_2) = \alpha_{min} + (\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are unit vectors thatform an angle \f$ \alpha \f$ (varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>-axis.\until spine function &lt;HR&gt;&lt;HR&gt;\subsection <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> object and document the initialconfiguration: a flat meniscus. \until doc_info.number()++;<a class="el" href="young__laplace_8txt.html#afd7bfc074226d266df4e6c70265af3c9">Finally</a>, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> curvatures.\until end of <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> &lt;HR&gt;&lt;HR&gt;\subsection class The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> classThe <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> class has the usual member functions. (Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> of the exercises in \ref comm_ex.) The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>'s private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value contains the unknowninterface <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> &lt;HR&gt;&lt;HR&gt;\subsection constr The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in [0,1] \times [0,1]\f$ with 8x8 elements.\until mesh_pt()Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; x </td>
          <td>(</td>
          <td class="paramtype">1&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="barrel_8cc_source.html#l00076">GlobalParameters::spine_base_function()</a>, and <a class="el" href="barrel_8cc_source.html#l00108">GlobalParameters::spine_function()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="afe7bec3a49f1760b75ce56ebe6721643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe7bec3a49f1760b75ce56ebe6721643">&#9670;&nbsp;</a></span>Acknowledgement</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mainpage Example a nonlinear PDE that determines static the equilibrium shapes of droplets or bubbles We start by reviewing the relevant theory and then present the solution of a simple model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>&lt;CENTER&gt;&lt;TABLE BORDER=1, WIDTH=500px&gt;&lt;TR&gt;&lt;TD bgcolor=&quot;cornsilk&quot;&gt;&lt;CENTER&gt;&lt;B&gt; Acknowledgement</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00020">20</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a1c89605709bfb613fd19c9f098dd6eda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c89605709bfb613fd19c9f098dd6eda">&#9670;&nbsp;</a></span>boundary</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus boundary</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00481">481</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a4f31063aa2581a1197266c00f4746b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f31063aa2581a1197266c00f4746b2f">&#9670;&nbsp;</a></span>component</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> of the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> Since the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> component</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00484">484</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a7f08e15ca2e78d4f74694e3111124596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f08e15ca2e78d4f74694e3111124596">&#9670;&nbsp;</a></span>conditions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">now Rennes n n&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/CENTER&gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p^* = \sigma \kappa^*,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa* <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p = \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00053">53</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="aa6158a81e827ec1ab33df40a25ea88b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6158a81e827ec1ab33df40a25ea88b4">&#9670;&nbsp;</a></span>correct</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> of the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> Since the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the meniscus must therefore have zero slope in that <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> just what we need for our <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> n n To convince yourself that the this argument is correct</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00487">487</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="ab527d223c14587f4aebca609ce74db8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab527d223c14587f4aebca609ce74db8a">&#9670;&nbsp;</a></span>delta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_n cdot delta</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{\bf R} = <a class="code" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">\delta</a> u \ {\bf T}_n \cdot</div>
<div class="line">   {\bf S} = 0</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00479">479</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a1ed379f41acee082a02b9ce12b741bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed379f41acee082a02b9ce12b741bd6">&#9670;&nbsp;</a></span>direction</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the direction of the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> Since the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the meniscus must therefore have zero slope in that direction just what we need for our <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> n n To convince yourself that the this argument is rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> direction</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00488">488</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a14f05f6bec57fb9eea1f1e04f934c4b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f05f6bec57fb9eea1f1e04f934c4b5">&#9670;&nbsp;</a></span>f</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_n cdot f implying that outer unit normal to the meniscus f</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{\cal L} <a class="code" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">\f</a>$ (e.g. the radius of the cylindrical <a class="code" href="young__laplace_8txt.html#ab4bbbf540e3048bad7f837fd75b71184">tube</a>) and </div>
<div class="line">scaling the pressure on the associated capillary scale</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00042">42</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="afd7bfc074226d266df4e6c70265af3c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd7bfc074226d266df4e6c70265af3c9">&#9670;&nbsp;</a></span>Finally</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">now Rennes n n&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/CENTER&gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p^* = \sigma \kappa^*,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa* <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p = \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt;A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> meets the solid surface.The mathematical <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape of the required mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$ that satisfies the <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">equation:\f</a>[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacementsThe <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A&gt;\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \left( \int_S \mathit{\, d} s \right)= \int_S \Delta p {\bf N}\cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf N} \mathit{\, d} s + \oint_{L} \ \ {\bf T}_n \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">cdot\delta</a> {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] which may be derived from energetic considerations. Here the symbol \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f$S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a>, respectively. \f$ dl \f$ is the length of an element of the contact line\f$L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> is pinned, the variation of its position is zero, \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} = {\bf 0} \f$, and the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> integral vanishes.The variational formulation of the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> is particularly convenient for a finite-element-based solution; see, e.g. the&lt;a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a&gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother: The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> cannot be projected onto the \f$ (x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in { R}^3\f$, where \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\partial D} = \bigg\{ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ \bigg| \ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The normal to the meniscus is then given by \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ {\bf N} = \frac{{\bf R}_{,1} \times {\bf R}_{,2} }{\mathcal{A}^{1/2}}, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}= |{\bf R}_{,1} \times {\bf R}_{,2}| \f$ is the square root of the surface metric tensor.The area and length differentials required in variational <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">principleare\f</a>[ d s=\mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ d l=\left| \frac{d {\bf R}\left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] allowing us to write the <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacements <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">as\f</a>[ \int_S \left( \frac{\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \right) \mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 =\oint_{L} {\bf T}_n \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \ \left| \frac{d {\bf R}\left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">xi.\f</a>]\subsection <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> The method of spinesIn the current form, the variational <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \f$ that parametrisethe same <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. To remove this ambiguity, and to allow for <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that cannot be projected onto the\f$ (x_1,x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) + \mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] Here the &quot;spine basis&quot; \f${\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$and the &quot;spines&quot; \f${\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ which represents the meniscus' displacement along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below: the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> corresponding to a flat meniscus. Positive values of \f$ u \f$displace the meniscus along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a>, \f$ {\bf S}(\zeta) \f$ (the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2 = u(x_1). \f$@I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f${\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ isone-to-<a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>, at least for the meniscus shapesof interest. Pinned <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> of the form\f$ \left. {\bf R}\right|_{\partial D} = {\bf R}_{\rm pinned} \f$are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D} = {\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D} = 0. \f$ The simplest possible choice for the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> and spine basisis <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> that returns the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2,0)^T \f$ and \f$ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = (0,0,1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> shown above, the computation wasstarted by computing the solution for \f$ \Delta p = \kappa = 0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$ (or equivalently, \f$ \kappa \f$)create small changes in the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>, using the displacement control method discussed in the&lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a&gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics <a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a>, we shall notdiscuss it in detail here but refer to the appropriate &lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a&gt;&lt;HR&gt;&lt;HR&gt;\section barrel An example problem: A barrel-shaped meniscusAs an example, we consider the following problem: Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is pinned at the edges ofthe slot, as shown in the sketch below, the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> has an obvious exact solution. The air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> must have constant mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the (dimensional) <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is given <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">by\f</a>[\kappa^* = \frac{2/a}{H/a + a/H}.\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, \f$ \Delta p = a \kappa^*. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^* = 1 \f$ indicates that the maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus is given by \f$ \kappa_{max}^* = 1/a. \f$ This implies that the maximum (dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^*_{max} = \sigma \kappa_{max}^* = \sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$ (and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-<a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> configurationof the meniscus (corresponding to a vanishing pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>) is the unit square. The meniscus is pinned along the lines \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 \f$ and \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1 \f$, and symmetry (natural) <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> were applied along the lines \f$ <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=0 \f$ and \f$x=1; \f$ see \ref comm_ex for further details on the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$@I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot; &lt;HR&gt; &lt;HR&gt; \section impl ImplementationWe shall now discuss the solution of the above <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> with\c oomph-lib's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa()returns the exact solution for the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2,0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$ (<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>,<a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>) \f$-plane,\until bspine functionsand rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a> \f$ <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> by <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">setting\f</a>[ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \alpha(\zeta_2) = \alpha_{min} + (\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are unit vectors thatform an angle \f$ \alpha \f$ (varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>-axis.\until spine function &lt;HR&gt;&lt;HR&gt;\subsection <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> object and document the initialconfiguration: a flat meniscus. \until doc_info.number()++;Finally, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> curvatures.\until end of <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> &lt;HR&gt;&lt;HR&gt;\subsection class The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> classThe <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> class has the usual member functions. (Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> of the exercises in \ref comm_ex.) The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>'s private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value contains the unknowninterface <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> &lt;HR&gt;&lt;HR&gt;\subsection constr The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in [0,1] \times [0,1]\f$ with 8x8 elements.\until mesh_pt()Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> We store the pointer to this c Data object in the private member data to facilitate its output until and the prescribed <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> until Finally</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00431">431</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a51614c86b63eafc713e24089a1463975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51614c86b63eafc713e24089a1463975">&#9670;&nbsp;</a></span>implied</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that are obtained if no <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are we only enforced the essential <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> by pinning the meniscus displacement along the pinned contact lines at <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> indicating that these boundaries are controlled by implied</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00474">474</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a5ea2ccd2302f3ef85d1dc917d935b659"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ea2ccd2302f3ef85d1dc917d935b659">&#9670;&nbsp;</a></span>interface</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">now Rennes n n&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/CENTER&gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid interface</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00043">43</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="ad085028866de0dfb37173803eabff340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad085028866de0dfb37173803eabff340">&#9670;&nbsp;</a></span>Kappa_pt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">now Rennes n n&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/CENTER&gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p and the surface tension forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p^* = \sigma \kappa^*,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa* <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> sigma <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the surface tension Non dimensionalising all lengths on some <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> specific lengthscale <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> Delta p yields the non dimensional form of the Young Laplace equation <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [\Delta p = \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">kappa.\f</a>] This must be augmented by suitable <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> to be applied at the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt;A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> meets the solid surface.The mathematical <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape of the required mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$ that satisfies the <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">equation:\f</a>[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacementsThe <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A&gt;\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \left( \int_S \mathit{\, d} s \right)= \int_S \Delta p {\bf N}\cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf N} \mathit{\, d} s + \oint_{L} \ \ {\bf T}_n \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">cdot\delta</a> {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] which may be derived from energetic considerations. Here the symbol \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f$S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a>, respectively. \f$ dl \f$ is the length of an element of the contact line\f$L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> is pinned, the variation of its position is zero, \f$ \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} = {\bf 0} \f$, and the <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> integral vanishes.The variational formulation of the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> is particularly convenient for a finite-element-based solution; see, e.g. the&lt;a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a&gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother: The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> cannot be projected onto the \f$ (x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in { R}^3\f$, where \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a>, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[{\partial D} = \bigg\{ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ \bigg| \ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The normal to the meniscus is then given by \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ {\bf N} = \frac{{\bf R}_{,1} \times {\bf R}_{,2} }{\mathcal{A}^{1/2}}, \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}= |{\bf R}_{,1} \times {\bf R}_{,2}| \f$ is the square root of the surface metric tensor.The area and length differentials required in variational <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">principleare\f</a>[ d s=\mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] and \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ d l=\left| \frac{d {\bf R}\left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi,\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] allowing us to write the <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> of virtual displacements <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">as\f</a>[ \int_S \left( \frac{\<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \right) \mathcal{A}^{1/2} d \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a> d \zeta_2 =\oint_{L} {\bf T}_n \cdot \<a class="el" href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a> {\bf R} \ \left| \frac{d {\bf R}\left( \<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">xi.\f</a>]\subsection <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> The method of spinesIn the current form, the variational <a class="el" href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a> cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \f$ that parametrisethe same <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. To remove this ambiguity, and to allow for <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that cannot be projected onto the\f$ (x_1,x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>[ {\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) + \mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] Here the &quot;spine basis&quot; \f${\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$and the &quot;spines&quot; \f${\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ which represents the meniscus' displacement along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below: the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight <a class="el" href="young__laplace_8txt.html#a72be276e8168a9e3345791225137a522">line</a> corresponding to a flat meniscus. Positive values of \f$ u \f$displace the meniscus along the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a>, \f$ {\bf S}(\zeta) \f$ (the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2 = u(x_1). \f$@I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> themselves must be chosen such that the mapping from \f$(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ to \f${\bf R}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)\f$ isone-to-<a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>, at least for the meniscus shapesof interest. Pinned <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> of the form\f$ \left. {\bf R}\right|_{\partial D} = {\bf R}_{\rm pinned} \f$are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D} = {\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D} = 0. \f$ The simplest possible choice for the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> and spine basisis <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> that returns the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2,0)^T \f$ and \f$ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = (0,0,1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> shown above, the computation wasstarted by computing the solution for \f$ \Delta p = \kappa = 0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$ (or equivalently, \f$ \kappa \f$)create small changes in the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>, using the displacement control method discussed in the&lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a&gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics <a class="el" href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a>, we shall notdiscuss it in detail here but refer to the appropriate &lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a&gt;&lt;HR&gt;&lt;HR&gt;\section barrel An example problem: A barrel-shaped meniscusAs an example, we consider the following problem: Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is pinned at the edges ofthe slot, as shown in the sketch below, the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> has an obvious exact solution. The air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> must have constant mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the (dimensional) <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> is given <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">by\f</a>[\kappa^* = \frac{2/a}{H/a + a/H}.\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>, \f$ \Delta p = a \kappa^*. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^* = 1 \f$ indicates that the maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus is given by \f$ \kappa_{max}^* = 1/a. \f$ This implies that the maximum (dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^*_{max} = \sigma \kappa_{max}^* = \sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$ (and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-<a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> configurationof the meniscus (corresponding to a vanishing pressure drop across the air-liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a>) is the unit square. The meniscus is pinned along the lines \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 \f$ and \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1 \f$, and symmetry (natural) <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> were applied along the lines \f$ <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=0 \f$ and \f$x=1; \f$ see \ref comm_ex for further details on the natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$@I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=0 and <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. &quot; &lt;HR&gt; &lt;HR&gt; \section impl ImplementationWe shall now discuss the solution of the above <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> with\c oomph-lib's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa()returns the exact solution for the mean <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2)=(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2,0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$ (<a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>,<a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>) \f$-plane,\until bspine functionsand rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the \f$ <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a> \f$ <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> by <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">setting\f</a>[ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>]where \f$ \alpha(\zeta_2) = \alpha_{min} + (\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are unit vectors thatform an angle \f$ \alpha \f$ (varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the <a class="el" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>-axis.\until spine function &lt;HR&gt;&lt;HR&gt;\subsection <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a> \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> object and document the initialconfiguration: a flat meniscus. \until doc_info.number()++;<a class="el" href="young__laplace_8txt.html#afd7bfc074226d266df4e6c70265af3c9">Finally</a>, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> curvatures.\until end of <a class="el" href="young__laplace_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> &lt;HR&gt;&lt;HR&gt;\subsection class The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> classThe <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> class has the usual member functions. (Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> of the exercises in \ref comm_ex.) The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>'s private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a>-and-only value contains the unknowninterface <a class="el" href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a>, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> &lt;HR&gt;&lt;HR&gt;\subsection constr The <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$ (\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) \in [0,1] \times [0,1]\f$ with 8x8 elements.\until mesh_pt()Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> kappa <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> We store the pointer to this c Data object in the private member data to facilitate its output until Kappa_pt</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line"> </div>
<div class="line">The meniscus is pinned along mesh boundaries 0 and 2:</div>
<div class="line"> </div>
<div class="line">\skipline Boundary conditions</div>
<div class="line">\until end bc</div>
<div class="line"> </div>
<div class="line">We complete the build of the Young Laplace elements by passing the</div>
<div class="line">pointer to the spine functions</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00419">419</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

<p class="reference">Referenced by <a class="el" href="barrel_8cc_source.html#l00155">YoungLaplaceProblem&lt; ELEMENT &gt;::actions_before_newton_solve()</a>, <a class="el" href="barrel_8cc_source.html#l00295">YoungLaplaceProblem&lt; ELEMENT &gt;::doc_solution()</a>, <a class="el" href="refineable__t__junction_8cc_source.html#l00434">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;::doc_solution()</a>, <a class="el" href="refineable__t__junction_8cc_source.html#l00230">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;::RefineableYoungLaplaceProblem()</a>, and <a class="el" href="barrel_8cc_source.html#l00184">YoungLaplaceProblem&lt; ELEMENT &gt;::YoungLaplaceProblem()</a>.</p>

</div>
</div>
<a id="afc17068882c18acc92fa19f13ba24670"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc17068882c18acc92fa19f13ba24670">&#9670;&nbsp;</a></span>line</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_n cdot <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> implying that outer unit normal to the meniscus <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> must be orthogonal to the <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> of the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> Since the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> do not have an <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> the meniscus must therefore have zero slope in that <a class="el" href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a> just what we need for our <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a> n n To convince yourself that the this argument is rotate the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> in the <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> <a class="el" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a> <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> e g by changing their definition to <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> [ {\bf S}(\<a class="el" href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a>,\zeta_2) = \left( \begin{array}{c} 1/2 \\ -\sin\big(\alpha(\zeta_2)\big) \\ \ \ \cos\big(\alpha(\zeta_2)\big) \\ \end{array} \right). \<a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a>] The natural <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> condition will still force the meniscus to be normal to the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> along the free contact line</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00501">501</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a0cc3d24c53996627ec3a5cd70d7d0eb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc3d24c53996627ec3a5cd70d7d0eb7">&#9670;&nbsp;</a></span>one</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is one to one</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00456">456</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="aae6b72bddd98a5f24915877f818e1f68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae6b72bddd98a5f24915877f818e1f68">&#9670;&nbsp;</a></span>Paris</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mainpage Example a nonlinear PDE that determines static the equilibrium shapes of droplets or bubbles We start by reviewing the relevant theory and then present the solution of a simple model <a class="el" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>&lt;CENTER&gt;&lt;TABLE BORDER=1, WIDTH=500px&gt;&lt;TR&gt;&lt;TD bgcolor=&quot;cornsilk&quot;&gt;&lt;CENTER&gt;&lt;B&gt; Paris</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00020">20</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a8044b62475f8b6be7b371532bab17017"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8044b62475f8b6be7b371532bab17017">&#9670;&nbsp;</a></span>problem</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> I w textwidth spherical_cap A typical problem</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00006">6</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

<p class="reference">Referenced by <a class="el" href="barrel_8cc_source.html#l00325">main()</a>, and <a class="el" href="refineable__young__laplace_8cc_source.html#l00545">run_it()</a>.</p>

</div>
</div>
<a id="ae8d86658dc1ec3aa7122edd47ef4124e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8d86658dc1ec3aa7122edd47ef4124e">&#9670;&nbsp;</a></span>problems</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">n n which create the c Data object that stores the prescribed related problems n n The code n n&lt;CENTER&gt;&lt;A HREF=&quot;../../../../demo_drivers/young_laplace/young_laplace.cc&quot;&gt; demo_drivers young_laplace young_laplace cc&lt;/A&gt;&lt;/CENTER&gt; n n and its adaptive counterpart n n&lt;CENTER&gt;&lt;A HREF=&quot;../../../../demo_drivers/young_laplace/refineable_young_laplace.cc&quot;&gt; demo_drivers young_laplace refineable_young_laplace cc&lt;/A&gt;&lt;/CENTER&gt; n n demonstrate the solution of three problems</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00555">555</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a236055ccdca33d638feffb2f38f635da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a236055ccdca33d638feffb2f38f635da">&#9670;&nbsp;</a></span>specified</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not specified</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00461">461</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="ab4bbbf540e3048bad7f837fd75b71184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4bbbf540e3048bad7f837fd75b71184">&#9670;&nbsp;</a></span>tube</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ii the deformation of a meniscus that is pinned at all four edges of a square tube</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00556">556</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a1b792a58562211eb74439f1222d226a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b792a58562211eb74439f1222d226a4">&#9670;&nbsp;</a></span>y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeta_2 <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> is <a class="el" href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a> to at least for the meniscus shapes of interest This requires some prior knowledge of the expected <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes n n The spine basis and the <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the <a class="el" href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a> shapes that are obtained if no <a class="el" href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a> are we only enforced the essential <a class="el" href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a> <a class="el" href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a> by pinning the meniscus displacement along the pinned contact lines at <a class="el" href="young__laplace_8txt.html#a9ac1b72ad803292913ca4f9bc7ac1189">f</a> y</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=0 <a class="code" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">\f</a>$ <a class="code" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">and  \f</a>$ <a class="code" href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a>=1. <a class="code" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">\f</a>$</div>
<div class="line">   No constraints were applied along the two other domain boundaries</div>
<div class="line">   (at \<a class="code" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">f</a>$ <a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=0 \<a class="code" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">f</a>$ and  \<a class="code" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">f</a>$ <a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>=1 \<a class="code" href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">f</a>$)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00471">471</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
<a id="a89176c66757d666599a5b244526ae379"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89176c66757d666599a5b244526ae379">&#9670;&nbsp;</a></span>zeta_1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">zeta_1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="young__laplace_8txt_source.html#l00456">456</a> of file <a class="el" href="young__laplace_8txt_source.html">young_laplace.txt</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="ayoung__laplace_8txt_html_a1b792a58562211eb74439f1222d226a4"><div class="ttname"><a href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a></div><div class="ttdeci">zeta_2 f is one to at least for the meniscus shapes of interest This requires some prior knowledge of the expected interface shapes n n The spine basis and the spines must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the interface shapes that are obtained if no spines are we only enforced the essential boundary conditions by pinning the meniscus displacement along the pinned contact lines at f y</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00471">young_laplace.txt:471</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a972796dc0dbb3f5b13cbc503572d2a26"><div class="ttname"><a href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f[\Delta p^ *=\sigma \kappa^ *,\f] where f kappa *f is the mean curvature and f sigma f the surface tension Non dimensionalising all lengths on some problem specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f[\Delta p=\kappa.\f] This must be augmented by suitable boundary to be applied at the contact line the line along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid interface meets the solid surface.The mathematical problem may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an interface shape of the required mean curvature \f$ \kappa \f$ that satisfies the boundary conditions along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the interface above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace equation:\f[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\f]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the interface, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the interface can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The principle of virtual displacementsThe interface shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\f[\delta \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \delta {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \cdot\delta {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\f] which may be derived from energetic considerations. Here the symbol \f$ \delta \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the interface, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact line, respectively. \f$ dl \f$ is the length of an element of the contact line\f $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact line is pinned, the variation of its position is zero, \f$ \delta {\bf R}={\bf 0} \f$, and the line integral vanishes.The variational formulation of the problem is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the interface cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\zeta_1,\zeta_2) \in { R}^3\f$, where \f$(\zeta_1,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain boundary, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \f[{\partial D}=\bigg\{(\zeta_1,\zeta_2) \ \bigg|\(\zeta_1,\zeta_2)=\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \f] The normal to the meniscus is then given by \f[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \f] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational principleare\f[d s=\mathcal{A}^{1/2} d \zeta_1 d \zeta_2 \f] and \f[d l=\left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\f] allowing us to write the principle of virtual displacements as\f[\int_S \left(\frac{\delta \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \delta {\bf R} \right) \mathcal{A}^{1/2} d \zeta_1 d \zeta_2=\oint_{L} {\bf T}_n \cdot \delta {\bf R} \ \left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi.\f]\subsection spines The method of spinesIn the current form, the variational principle cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\zeta_1,\zeta_2) \f$ that parametrisethe same interface shape. To remove this ambiguity, and to allow for interface shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \f[{\bf R}(\zeta_1,\zeta_2)={\bf B}(\zeta_1,\zeta_2)+\mathit{u}(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2). \f] Here the &quot;spine basis&quot; \f${\bf B}(\zeta_1,\zeta_2)\f $and the &quot;spines&quot; \f${\bf S}(\zeta_1,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\zeta_1,\zeta_2)\f$ which represents the meniscus' displacement along the spines \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight line corresponding to a flat meniscus. Positive values of \f$ u \f $displace the meniscus along the spines, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the spines themselves must be chosen such that the mapping from \f$(\zeta_1,\zeta_2)\f$ to \f${\bf R}(\zeta_1,\zeta_2)\f$ isone-to-one, at least for the meniscus shapesof interest. Pinned boundary conditions of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \f $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the spines and spine basisis one that returns the problem to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\zeta_1,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model problem shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the interface shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the problem, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics problems, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid interface is pinned at the edges ofthe slot, as shown in the sketch below, the problem has an obvious exact solution. The air-liquid interface must have constant mean curvature, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) curvature of the air-liquid interface is given by\f[\kappa^ *=\frac{2/a}{H/a+a/H}.\f] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid interface, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum curvature of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-curvature configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid interface) is the unit square. The meniscus is pinned along the lines \f$ y=0 \f$ and \f$ y=1 \f$, and symmetry(natural) boundary conditions were applied along the lines \f$ x=0 \f$ and \f $x=1;\f$ see \ref comm_ex for further details on the natural boundary conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum curvature when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines y=0 and y=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above problem with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the problem parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean curvature of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(x, y) \f$-plane,\until bspine functionsand rotate the spines in the \f$ y \f$ direction by setting\f[{\bf S}(\zeta_1,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\f]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the spines are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the y-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection main The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the interface curvature \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the problem object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;Finally, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated interface curvatures.\until end of main&lt; HR &gt;&lt; HR &gt;\subsection class The problem classThe problem class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in one of the exercises in \ref comm_ex.) The problem 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose one-and-only value contains the unknowninterface curvature, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of problem&lt; HR &gt;&lt; HR &gt;\subsection constr The problem constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\zeta_1,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; x(1) We pass the pointer to that node and the pointer to the double that specifies the imposed displacement to the const ructor of the displacement control element. The const ructor automatically creates a \c Data object whose one-and-only value stores the unknown curvature</div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a14f05f6bec57fb9eea1f1e04f934c4b5"><div class="ttname"><a href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">f</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p * f</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00042">young_laplace.txt:42</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_ab527d223c14587f4aebca609ce74db8a"><div class="ttname"><a href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a></div><div class="ttdeci">_n cdot delta</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00479">young_laplace.txt:479</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_ab4bbbf540e3048bad7f837fd75b71184"><div class="ttname"><a href="young__laplace_8txt.html#ab4bbbf540e3048bad7f837fd75b71184">tube</a></div><div class="ttdeci">ii the deformation of a meniscus that is pinned at all four edges of a square tube</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00556">young_laplace.txt:556</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Tue Jul 6 2021 23:30:04
        </div>
      </div>
    </footer>
</body>
</html>
